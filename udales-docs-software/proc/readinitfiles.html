<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>readinitfiles &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>readinitfiles
      <small>Subroutine</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 4.7% of total for procedures.">607 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modstartup.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
     <li><a href='../sourcefile/modstartup.f90.html'>modstartup.f90</a></li>
    
     <li><a href='../module/modstartup.html'>modstartup</a></li>
    
  
     <li class="active">readinitfiles</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/readinitfiles.html#src">readinitfiles</a>
  </div>
</div>



</div>

    </div>
    
    <div class="col-md-9" id='text'>
    <h2>
public subroutine readinitfiles()
    
    
   
</h2>
    
  
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Uses</h3>
      </div>
      <ul class="list-group">
      
      <li class="list-group-item">
  <ul class="list-inline">
    
    <li><a href='../module/modfields.html'>modfields</a></li>
    
    <li><a href='../module/modglobal.html'>modglobal</a></li>
    
    <li><a href='../module/modsubgriddata.html'>modsubgriddata</a></li>
    
    <li><a href='../module/modsurfdata.html'>modsurfdata</a></li>
    
    <li><a href='../module/modboundary.html'>modboundary</a></li>
    
    <li><a href='../module/modmpi.html'>modmpi</a></li>
    
    <li><a href='../module/modthermodynamics.html'>modthermodynamics</a></li>
    
    <li><a href='../module/modinletdata.html'>modinletdata</a></li>
    
    <li><a href='../module/modinlet.html'>modinlet</a></li>
    
    <li><a href='../module/moddriver.html'>moddriver</a></li>
    
  </ul>
      </li>
      
      
      
      <li class="list-group-item">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~readinitfiles~~UsesGraph Pages: 1 -->
<svg id="procreadinitfilesUsesGraph" width="367pt" height="406pt"
 viewBox="0.00 0.00 367.00 406.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~readinitfiles~~UsesGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 402)">
<title>proc~~readinitfiles~~UsesGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-402 363,-402 363,4 -4,4"/>
<!-- proc~readinitfiles -->
<g id="proc~~readinitfiles~~UsesGraph_node1" class="node">
<title>proc~readinitfiles</title>
<polygon fill="none" stroke="#000000" points="359,-213 283,-213 283,-189 359,-189 359,-213"/>
<text text-anchor="middle" x="321" y="-198.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">readinitfiles</text>
</g>
<!-- module~modthermodynamics -->
<g id="proc~~readinitfiles~~UsesGraph_node2" class="node">
<title>module~modthermodynamics</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node2"><a xlink:href=".././module/modthermodynamics.html" xlink:title="modthermodynamics">
<polygon fill="#337ab7" stroke="#337ab7" points="247,-398 120,-398 120,-374 247,-374 247,-398"/>
<text text-anchor="middle" x="183.5" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modthermodynamics -->
<g id="proc~~readinitfiles~~UsesGraph_edge1" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modthermodynamics</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M318.9416,-213.2724C313.2266,-243.5342 294.3499,-322.3557 247,-365 245.6653,-366.202 244.2601,-367.3355 242.7977,-368.4042"/>
<polygon fill="#ff0000" stroke="#ff0000" points="240.6,-365.6453 233.8906,-373.845 244.249,-371.619 240.6,-365.6453"/>
</g>
<!-- module~modinlet -->
<g id="proc~~readinitfiles~~UsesGraph_node3" class="node">
<title>module~modinlet</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node3"><a xlink:href=".././module/modinlet.html" xlink:title="modinlet">
<polygon fill="#337ab7" stroke="#337ab7" points="213.5,-356 153.5,-356 153.5,-332 213.5,-332 213.5,-356"/>
<text text-anchor="middle" x="183.5" y="-341.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modinlet -->
<g id="proc~~readinitfiles~~UsesGraph_edge2" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modinlet</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M316.8343,-213.3541C307.9447,-237.8734 284.7888,-292.9089 247,-323 240.1448,-328.4587 231.8129,-332.5241 223.4706,-335.5431"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.2318,-332.2642 213.7606,-338.6274 224.351,-338.9357 222.2318,-332.2642"/>
</g>
<!-- module~modboundary -->
<g id="proc~~readinitfiles~~UsesGraph_node4" class="node">
<title>module~modboundary</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node4"><a xlink:href=".././module/modboundary.html" xlink:title="modboundary">
<polygon fill="#337ab7" stroke="#337ab7" points="227.5,-314 139.5,-314 139.5,-290 227.5,-290 227.5,-314"/>
<text text-anchor="middle" x="183.5" y="-299.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modboundary -->
<g id="proc~~readinitfiles~~UsesGraph_edge3" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modboundary</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311.6722,-213.1447C298.6919,-229.3501 273.7445,-258.0788 247,-276 241.6096,-279.612 235.6384,-282.864 229.5775,-285.7457"/>
<polygon fill="#ff0000" stroke="#ff0000" points="227.7745,-282.7163 220.05,-289.9677 230.6106,-289.1161 227.7745,-282.7163"/>
</g>
<!-- module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_node5" class="node">
<title>module~modinletdata</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node5"><a xlink:href=".././module/modinletdata.html" xlink:title="modinletdata">
<polygon fill="#337ab7" stroke="#337ab7" points="84,-274 0,-274 0,-250 84,-250 84,-274"/>
<text text-anchor="middle" x="42" y="-259.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinletdata</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge4" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modinletdata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M304.6056,-213.0274C290.2029,-222.9046 268.2811,-236.316 247,-243 196.7528,-258.7817 136.4322,-262.6906 94.2813,-263.1659"/>
<polygon fill="#ff0000" stroke="#ff0000" points="94.223,-259.6661 84.2414,-263.2182 94.2595,-266.666 94.223,-259.6661"/>
</g>
<!-- module~modglobal -->
<g id="proc~~readinitfiles~~UsesGraph_node6" class="node">
<title>module~modglobal</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node6"><a xlink:href=".././module/modglobal.html" xlink:title="modglobal">
<polygon fill="#337ab7" stroke="#337ab7" points="218.5,-234 148.5,-234 148.5,-210 218.5,-210 218.5,-234"/>
<text text-anchor="middle" x="183.5" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modglobal -->
<g id="proc~~readinitfiles~~UsesGraph_edge5" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modglobal</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M282.6986,-206.8497C265.9592,-209.4062 246.2018,-212.4237 228.7435,-215.0901"/>
<polygon fill="#ff0000" stroke="#ff0000" points="228.1271,-211.6436 218.7701,-216.6133 229.184,-218.5633 228.1271,-211.6436"/>
</g>
<!-- module~modfields -->
<g id="proc~~readinitfiles~~UsesGraph_node7" class="node">
<title>module~modfields</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node7"><a xlink:href=".././module/modfields.html" xlink:title="modfields">
<polygon fill="#337ab7" stroke="#337ab7" points="216,-192 151,-192 151,-168 216,-168 216,-192"/>
<text text-anchor="middle" x="183.5" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modfields -->
<g id="proc~~readinitfiles~~UsesGraph_edge6" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modfields</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M282.6986,-195.1503C265.0801,-192.4595 244.1183,-189.2581 226.0128,-186.4929"/>
<polygon fill="#ff0000" stroke="#ff0000" points="226.4232,-183.015 216.0094,-184.9651 225.3663,-189.9348 226.4232,-183.015"/>
</g>
<!-- module~modsubgriddata -->
<g id="proc~~readinitfiles~~UsesGraph_node8" class="node">
<title>module~modsubgriddata</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node8"><a xlink:href=".././module/modsubgriddata.html" xlink:title="modsubgriddata">
<polygon fill="#337ab7" stroke="#337ab7" points="233.5,-150 133.5,-150 133.5,-126 233.5,-126 233.5,-150"/>
<text text-anchor="middle" x="183.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgriddata</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modsubgriddata -->
<g id="proc~~readinitfiles~~UsesGraph_edge7" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modsubgriddata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M302.0655,-188.8733C287.426,-179.8415 266.4422,-167.6313 247,-159 242.6521,-157.0698 238.0695,-155.2195 233.4388,-153.4731"/>
<polygon fill="#ff0000" stroke="#ff0000" points="234.5199,-150.1424 223.9255,-150.0417 232.1448,-156.7271 234.5199,-150.1424"/>
</g>
<!-- module~modsurfdata -->
<g id="proc~~readinitfiles~~UsesGraph_node9" class="node">
<title>module~modsurfdata</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node9"><a xlink:href=".././module/modsurfdata.html" xlink:title="modsurfdata">
<polygon fill="#337ab7" stroke="#337ab7" points="224,-108 143,-108 143,-84 224,-84 224,-108"/>
<text text-anchor="middle" x="183.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsurfdata</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modsurfdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge8" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modsurfdata</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M313.4222,-188.8901C301.4622,-170.7313 276.5096,-136.5027 247,-117 242.9163,-114.3011 238.4556,-111.9216 233.8528,-109.8295"/>
<polygon fill="#ff0000" stroke="#ff0000" points="234.8621,-106.4614 224.2806,-105.9286 232.2203,-112.9438 234.8621,-106.4614"/>
</g>
<!-- module~modmpi -->
<g id="proc~~readinitfiles~~UsesGraph_node10" class="node">
<title>module~modmpi</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node10"><a xlink:href=".././module/modmpi.html" xlink:title="modmpi">
<polygon fill="#337ab7" stroke="#337ab7" points="212,-24 155,-24 155,0 212,0 212,-24"/>
<text text-anchor="middle" x="183.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~modmpi -->
<g id="proc~~readinitfiles~~UsesGraph_edge9" class="edge">
<title>proc~readinitfiles&#45;&gt;module~modmpi</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M319.1164,-188.8856C313.7177,-158.2377 295.3518,-76.9406 247,-33 239.9321,-26.5769 230.851,-22.1134 221.7799,-19.0133"/>
<polygon fill="#ff0000" stroke="#ff0000" points="222.6173,-15.6115 212.0365,-16.1563 220.6476,-22.3287 222.6173,-15.6115"/>
</g>
<!-- module~moddriver -->
<g id="proc~~readinitfiles~~UsesGraph_node11" class="node">
<title>module~moddriver</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node11"><a xlink:href=".././module/moddriver.html" xlink:title="moddriver">
<polygon fill="#337ab7" stroke="#337ab7" points="217.5,-66 149.5,-66 149.5,-42 217.5,-42 217.5,-66"/>
<text text-anchor="middle" x="183.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;module~moddriver -->
<g id="proc~~readinitfiles~~UsesGraph_edge10" class="edge">
<title>proc~readinitfiles&#45;&gt;module~moddriver</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M317.0842,-188.6299C308.5069,-163.5067 285.6761,-106.2488 247,-75 241.2252,-70.3342 234.374,-66.6891 227.3443,-63.8459"/>
<polygon fill="#ff0000" stroke="#ff0000" points="228.3267,-60.4809 217.732,-60.4452 225.992,-67.0801 228.3267,-60.4809"/>
</g>
<!-- module~modinlet&#45;&gt;module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge11" class="edge">
<title>module~modinlet&#45;&gt;module~modinletdata</title>
<path fill="none" stroke="#ff9900" stroke-dasharray="5,2" d="M153.2239,-336.3146C142.4041,-332.9716 130.3391,-328.5353 120,-323 98.6447,-311.567 77.1673,-294.2394 62.172,-280.9699"/>
<polygon fill="#ff9900" stroke="#ff9900" points="64.3151,-278.1891 54.5501,-274.0786 59.6205,-283.3814 64.3151,-278.1891"/>
</g>
<!-- mpi -->
<g id="proc~~readinitfiles~~UsesGraph_node12" class="node">
<title>mpi</title>
<g id="a_proc~~readinitfiles~~UsesGraph_node12"><a xlink:href="http://www.mpi-forum.org/docs/mpi-3.1/mpi31-report/node410.htm" xlink:title="mpi">
<polygon fill="#337ab7" stroke="#337ab7" points="69,-24 15,-24 15,0 69,0 69,-24"/>
<text text-anchor="middle" x="42" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi</text>
</a>
</g>
</g>
<!-- module~modmpi&#45;&gt;mpi -->
<g id="proc~~readinitfiles~~UsesGraph_edge12" class="edge">
<title>module~modmpi&#45;&gt;mpi</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M154.8654,-12C133.0583,-12 102.8582,-12 79.1845,-12"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="79.1518,-8.5001 69.1518,-12 79.1518,-15.5001 79.1518,-8.5001"/>
</g>
<!-- module~moddriver&#45;&gt;module~modinletdata -->
<g id="proc~~readinitfiles~~UsesGraph_edge13" class="edge">
<title>module~moddriver&#45;&gt;module~modinletdata</title>
<path fill="none" stroke="#ff0098" stroke-dasharray="5,2" d="M149.343,-59.5725C138.9203,-62.6758 128.0899,-67.501 120,-75 71.1615,-120.2708 51.9,-200.8493 45.179,-239.7584"/>
<polygon fill="#ff0098" stroke="#ff0098" points="41.6661,-239.5607 43.5388,-249.9886 48.5778,-240.6688 41.6661,-239.5607"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="517pt" height="32pt"
 viewBox="0.00 0.00 517.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 513,-28 513,4 -4,4"/>
<!-- Module -->
<g id="node1" class="node">
<title>Module</title>
<polygon fill="#337ab7" stroke="#337ab7" points="54,-24 0,-24 0,0 54,0 54,-24"/>
<text text-anchor="middle" x="27" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Module</text>
</g>
<!-- Submodule -->
<g id="node2" class="node">
<title>Submodule</title>
<polygon fill="#5bc0de" stroke="#5bc0de" points="145.5,-24 72.5,-24 72.5,0 145.5,0 145.5,-24"/>
<text text-anchor="middle" x="109" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Submodule</text>
</g>
<!-- Subroutine -->
<g id="node3" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="234.5,-24 163.5,-24 163.5,0 234.5,0 234.5,-24"/>
<text text-anchor="middle" x="199" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node4" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="311,-24 253,-24 253,0 311,0 311,-24"/>
<text text-anchor="middle" x="282" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="387,-24 329,-24 329,0 387,0 387,-24"/>
<text text-anchor="middle" x="358" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="509,-24 405,-24 405,0 509,0 509,-24"/>
<text text-anchor="middle" x="457" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a submodule to the (sub)module which it is
    descended from. Dashed arrows point from a module or program unit to 
    modules which it uses. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </li>
      
      </ul>
    </div>
    


    

    <h3>Arguments</h3>
    
    <em>None</em>
    <br>
    
    
    
    <br>
    
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Calls</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~readinitfiles~~CallsGraph Pages: 1 -->
<svg id="procreadinitfilesCallsGraph" width="641pt" height="1074pt"
 viewBox="0.00 0.00 641.00 1074.33" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~readinitfiles~~CallsGraph" class="graph" transform="scale(.8176 .8176) rotate(0) translate(4 1310)">
<title>proc~~readinitfiles~~CallsGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1310 780,-1310 780,4 -4,4"/>
<!-- proc~readinitfiles -->
<g id="proc~~readinitfiles~~CallsGraph_node1" class="node">
<title>proc~readinitfiles</title>
<polygon fill="none" stroke="#000000" points="76,-298 0,-298 0,-274 76,-274 76,-298"/>
<text text-anchor="middle" x="38" y="-283.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">readinitfiles</text>
</g>
<!-- proc~drivergen -->
<g id="proc~~readinitfiles~~CallsGraph_node2" class="node">
<title>proc~drivergen</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node2"><a xlink:href=".././proc/drivergen.html" xlink:title="drivergen">
<polygon fill="#d9534f" stroke="#d9534f" points="332,-1306 268,-1306 268,-1282 332,-1282 332,-1306"/>
<text text-anchor="middle" x="300" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">drivergen</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~drivergen -->
<g id="proc~~readinitfiles~~CallsGraph_edge1" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~drivergen</title>
<path fill="none" stroke="#ff0000" d="M38.5908,-298.3183C41.7454,-359.8103 58.5151,-639.3914 112,-861 154.7792,-1038.2505 151.6938,-1094.0749 251,-1247 257.7829,-1257.4453 267.3135,-1267.2745 276.1683,-1275.2169"/>
<polygon fill="#ff0000" stroke="#ff0000" points="274.1429,-1278.0907 284.0121,-1281.9441 278.7,-1272.7772 274.1429,-1278.0907"/>
</g>
<!-- proc~readdriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_node3" class="node">
<title>proc~readdriverfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node3"><a xlink:href=".././proc/readdriverfile.html" xlink:title="readdriverfile">
<polygon fill="#d9534f" stroke="#d9534f" points="206,-318 121,-318 121,-294 206,-294 206,-318"/>
<text text-anchor="middle" x="163.5" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">readdriverfile</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~readdriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge2" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~readdriverfile</title>
<path fill="none" stroke="#ff0000" d="M76.3361,-292.1093C87.1521,-293.833 99.1147,-295.7394 110.6228,-297.5734"/>
<polygon fill="#ff0000" stroke="#ff0000" points="110.1526,-301.0425 120.5788,-299.16 111.2543,-294.1297 110.1526,-301.0425"/>
</g>
<!-- proc~thermodynamics -->
<g id="proc~~readinitfiles~~CallsGraph_node4" class="node">
<title>proc~thermodynamics</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node4"><a xlink:href=".././proc/thermodynamics.html" xlink:title="thermodynamics">
<polygon fill="#d9534f" stroke="#d9534f" points="215,-238 112,-238 112,-214 215,-214 215,-238"/>
<text text-anchor="middle" x="163.5" y="-223.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">thermodynamics</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~thermodynamics -->
<g id="proc~~readinitfiles~~CallsGraph_edge3" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~thermodynamics</title>
<path fill="none" stroke="#ff0000" d="M63.3968,-273.8581C82.2787,-264.8309 108.2551,-252.4119 129.0143,-242.4872"/>
<polygon fill="#ff0000" stroke="#ff0000" points="130.6287,-245.5949 138.141,-238.1238 127.6093,-239.2795 130.6287,-245.5949"/>
</g>
<!-- proc~boundary -->
<g id="proc~~readinitfiles~~CallsGraph_node5" class="node">
<title>proc~boundary</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node5"><a xlink:href=".././proc/boundary.html" xlink:title="boundary">
<polygon fill="#d9534f" stroke="#d9534f" points="195.5,-852 131.5,-852 131.5,-828 195.5,-828 195.5,-852"/>
<text text-anchor="middle" x="163.5" y="-837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">boundary</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~boundary -->
<g id="proc~~readinitfiles~~CallsGraph_edge4" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~boundary</title>
<path fill="none" stroke="#ff0000" d="M38.7154,-298.0627C42.1097,-350.8661 58.7103,-566.477 112,-734 121.7981,-764.8016 139.1157,-797.9548 150.9407,-818.8271"/>
<polygon fill="#ff0000" stroke="#ff0000" points="148.0658,-820.8479 156.094,-827.7616 154.1295,-817.3505 148.0658,-820.8479"/>
</g>
<!-- proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_node6" class="node">
<title>proc~slabsum</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node6"><a xlink:href=".././proc/slabsum.html" xlink:title="slabsum">
<polygon fill="#d9534f" stroke="#d9534f" points="485.5,-276 428.5,-276 428.5,-252 485.5,-252 485.5,-276"/>
<text text-anchor="middle" x="457" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">slabsum</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge7" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#ff0000" d="M54.0141,-298.0354C68.3506,-308.006 90.3858,-321.4124 112,-327 213.9808,-353.3634 253.3033,-371.0143 349,-327 371.3362,-316.7268 364.3411,-298.3288 385,-285 395.0702,-278.5029 407.2061,-273.9631 418.6207,-270.813"/>
<polygon fill="#ff0000" stroke="#ff0000" points="419.5327,-274.1929 428.3959,-268.3882 417.8474,-267.3988 419.5327,-274.1929"/>
</g>
<!-- proc~readrestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_node7" class="node">
<title>proc~readrestartfiles</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node7"><a xlink:href=".././proc/readrestartfiles.html" xlink:title="readrestartfiles">
<polygon fill="#d9534f" stroke="#d9534f" points="210.5,-150 116.5,-150 116.5,-126 210.5,-126 210.5,-150"/>
<text text-anchor="middle" x="163.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">readrestartfiles</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~readrestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_edge6" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~readrestartfiles</title>
<path fill="none" stroke="#ff0000" d="M48.2702,-273.8885C69.8733,-248.4124 120.195,-189.0688 146.6152,-157.912"/>
<polygon fill="#ff0000" stroke="#ff0000" points="149.2898,-160.1695 153.0879,-150.2788 143.9509,-155.6422 149.2898,-160.1695"/>
</g>
<!-- proc~calc_halflev -->
<g id="proc~~readinitfiles~~CallsGraph_node8" class="node">
<title>proc~calc_halflev</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node8"><a xlink:href=".././proc/calc_halflev.html" xlink:title="calc_halflev">
<polygon fill="#d9534f" stroke="#d9534f" points="338,-318 262,-318 262,-294 338,-294 338,-318"/>
<text text-anchor="middle" x="300" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calc_halflev</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~calc_halflev -->
<g id="proc~~readinitfiles~~CallsGraph_edge5" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~calc_halflev</title>
<path fill="none" stroke="#ff0000" d="M76.0251,-285.3877C87.5781,-285.2282 100.3082,-285.079 112,-285 157.7767,-284.6907 169.5575,-279.4697 215,-285 227.1422,-286.4777 240.0494,-289.1013 252.0409,-292.0044"/>
<polygon fill="#ff0000" stroke="#ff0000" points="251.3085,-295.4294 261.8616,-294.4898 253.026,-288.6433 251.3085,-295.4294"/>
</g>
<!-- proc~randomnize -->
<g id="proc~~readinitfiles~~CallsGraph_node9" class="node">
<title>proc~randomnize</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node9"><a xlink:href=".././proc/randomnize.html" xlink:title="randomnize">
<polygon fill="#d9534f" stroke="#d9534f" points="201.5,-108 125.5,-108 125.5,-84 201.5,-84 201.5,-108"/>
<text text-anchor="middle" x="163.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">randomnize</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~randomnize -->
<g id="proc~~readinitfiles~~CallsGraph_edge8" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~randomnize</title>
<path fill="none" stroke="#ff0000" d="M40.1278,-273.5595C46.0013,-242.8454 65.211,-162.6091 112,-117 113.452,-115.5846 115.0123,-114.2601 116.6534,-113.0212"/>
<polygon fill="#ff0000" stroke="#ff0000" points="118.8053,-115.8024 125.4047,-107.514 115.077,-109.8779 118.8053,-115.8024"/>
</g>
<!-- proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_node10" class="node">
<title>proc~readinletfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node10"><a xlink:href=".././proc/readinletfile.html" xlink:title="readinletfile">
<polygon fill="#d9534f" stroke="#d9534f" points="495.5,-940 418.5,-940 418.5,-916 495.5,-916 495.5,-940"/>
<text text-anchor="middle" x="457" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">readinletfile</text>
</a>
</g>
</g>
<!-- proc~readinitfiles&#45;&gt;proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge9" class="edge">
<title>proc~readinitfiles&#45;&gt;proc~readinletfile</title>
<path fill="none" stroke="#ff0000" d="M41.3795,-298.0417C56.8911,-351.4638 125.9224,-570.1696 251,-701 285.666,-737.2604 318.5741,-717.1151 349,-757 387.9664,-808.0805 343.2215,-848.1926 385,-897 391.437,-904.5199 400.0283,-910.2692 409.0302,-914.6469"/>
<polygon fill="#ff0000" stroke="#ff0000" points="407.9184,-917.9791 418.4866,-918.7292 410.6928,-911.5524 407.9184,-917.9791"/>
</g>
<!-- mpi_bcast -->
<g id="proc~~readinitfiles~~CallsGraph_node11" class="node">
<title>mpi_bcast</title>
<polygon fill="#777777" stroke="#777777" points="197,-66 130,-66 130,-42 197,-42 197,-66"/>
<text text-anchor="middle" x="163.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_bcast</text>
</g>
<!-- proc~readinitfiles&#45;&gt;mpi_bcast -->
<g id="proc~~readinitfiles~~CallsGraph_edge10" class="edge">
<title>proc~readinitfiles&#45;&gt;mpi_bcast</title>
<path fill="none" stroke="#ff0000" d="M38.8443,-273.9839C41.9462,-238.7067 55.6776,-134.204 112,-75 114.6163,-72.2498 117.6436,-69.849 120.8939,-67.7552"/>
<polygon fill="#ff0000" stroke="#ff0000" points="122.7513,-70.7301 129.8894,-62.9007 119.4269,-64.5698 122.7513,-70.7301"/>
</g>
<!-- proc~writedriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_node26" class="node">
<title>proc~writedriverfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node26"><a xlink:href=".././proc/writedriverfile.html" xlink:title="writedriverfile">
<polygon fill="#d9534f" stroke="#d9534f" points="500.5,-1306 413.5,-1306 413.5,-1282 500.5,-1282 500.5,-1306"/>
<text text-anchor="middle" x="457" y="-1291.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">writedriverfile</text>
</a>
</g>
</g>
<!-- proc~drivergen&#45;&gt;proc~writedriverfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge11" class="edge">
<title>proc~drivergen&#45;&gt;proc~writedriverfile</title>
<path fill="none" stroke="#ff0000" d="M332.1501,-1294C352.5466,-1294 379.4472,-1294 403.0536,-1294"/>
<polygon fill="#ff0000" stroke="#ff0000" points="403.2855,-1297.5001 413.2855,-1294 403.2855,-1290.5001 403.2855,-1297.5001"/>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~calc_halflev -->
<g id="proc~~readinitfiles~~CallsGraph_edge12" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~calc_halflev</title>
<path fill="none" stroke="#cbff00" d="M190.7596,-238.0217C198.8272,-242.0349 207.502,-246.8181 215,-252 232.8558,-264.3403 232.7666,-273.2248 251,-285 253.4054,-286.5534 255.945,-288.038 258.5513,-289.4478"/>
<polygon fill="#cbff00" stroke="#cbff00" points="257.06,-292.6152 267.5712,-293.944 260.1829,-286.3504 257.06,-292.6152"/>
</g>
<!-- proc~calthv -->
<g id="proc~~readinitfiles~~CallsGraph_node20" class="node">
<title>proc~calthv</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node20"><a xlink:href=".././proc/calthv.html" xlink:title="calthv">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-276 273,-276 273,-252 327,-252 327,-276"/>
<text text-anchor="middle" x="300" y="-261.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">calthv</text>
</a>
</g>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~calthv -->
<g id="proc~~readinitfiles~~CallsGraph_edge14" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~calthv</title>
<path fill="none" stroke="#cbff00" d="M206.6895,-238.0234C224.8405,-243.0765 245.7378,-248.894 263.149,-253.7411"/>
<polygon fill="#cbff00" stroke="#cbff00" points="262.3781,-257.1595 272.9504,-256.4697 264.2555,-250.416 262.3781,-257.1595"/>
</g>
<!-- proc~diagfld -->
<g id="proc~~readinitfiles~~CallsGraph_node35" class="node">
<title>proc~diagfld</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node35"><a xlink:href=".././proc/diagfld.html" xlink:title="diagfld">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-234 273,-234 273,-210 327,-210 327,-234"/>
<text text-anchor="middle" x="300" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">diagfld</text>
</a>
</g>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~diagfld -->
<g id="proc~~readinitfiles~~CallsGraph_edge13" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~diagfld</title>
<path fill="none" stroke="#cbff00" d="M215.1048,-224.4878C230.9002,-224.0249 247.9623,-223.5249 262.6184,-223.0954"/>
<polygon fill="#cbff00" stroke="#cbff00" points="262.9195,-226.5882 272.8126,-222.7967 262.7144,-219.5912 262.9195,-226.5882"/>
</g>
<!-- proc~thermo -->
<g id="proc~~readinitfiles~~CallsGraph_node40" class="node">
<title>proc~thermo</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node40"><a xlink:href=".././proc/thermo.html" xlink:title="thermo">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-192 273,-192 273,-168 327,-168 327,-192"/>
<text text-anchor="middle" x="300" y="-177.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">thermo</text>
</a>
</g>
</g>
<!-- proc~thermodynamics&#45;&gt;proc~thermo -->
<g id="proc~~readinitfiles~~CallsGraph_edge15" class="edge">
<title>proc~thermodynamics&#45;&gt;proc~thermo</title>
<path fill="none" stroke="#cbff00" d="M199.3638,-213.914C218.9599,-207.3102 243.1933,-199.1437 262.9692,-192.4793"/>
<polygon fill="#cbff00" stroke="#cbff00" points="264.2084,-195.7551 272.567,-189.2448 261.9729,-189.1217 264.2084,-195.7551"/>
</g>
<!-- proc~boundary&#45;&gt;proc~drivergen -->
<g id="proc~~readinitfiles~~CallsGraph_edge16" class="edge">
<title>proc~boundary&#45;&gt;proc~drivergen</title>
<path fill="none" stroke="#33ff00" d="M166.3305,-852.0964C174.3566,-886.5425 197.7945,-988.1428 215,-1073 232.513,-1159.3736 198.8816,-1196.9311 251,-1268 253.367,-1271.2277 256.257,-1274.0927 259.4378,-1276.6276"/>
<polygon fill="#33ff00" stroke="#33ff00" points="257.5618,-1279.5839 267.8112,-1282.2676 261.4725,-1273.7781 257.5618,-1279.5839"/>
</g>
<!-- proc~fluxtopscal -->
<g id="proc~~readinitfiles~~CallsGraph_node12" class="node">
<title>proc~fluxtopscal</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node12"><a xlink:href=".././proc/fluxtopscal.html" xlink:title="fluxtopscal">
<polygon fill="#d9534f" stroke="#d9534f" points="335,-608 265,-608 265,-584 335,-584 335,-608"/>
<text text-anchor="middle" x="300" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fluxtopscal</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~fluxtopscal -->
<g id="proc~~readinitfiles~~CallsGraph_edge19" class="edge">
<title>proc~boundary&#45;&gt;proc~fluxtopscal</title>
<path fill="none" stroke="#33ff00" d="M164.9625,-827.8527C169.9901,-791.1665 189.7732,-680.1533 251,-617 252.5965,-615.3533 254.3431,-613.8286 256.1957,-612.4177"/>
<polygon fill="#33ff00" stroke="#33ff00" points="258.2814,-615.2398 264.8609,-606.9355 254.5389,-609.3243 258.2814,-615.2398"/>
</g>
<!-- proc~inletgennotemp -->
<g id="proc~~readinitfiles~~CallsGraph_node13" class="node">
<title>proc~inletgennotemp</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node13"><a xlink:href=".././proc/inletgennotemp.html" xlink:title="inletgennotemp">
<polygon fill="#d9534f" stroke="#d9534f" points="348.5,-692 251.5,-692 251.5,-668 348.5,-668 348.5,-692"/>
<text text-anchor="middle" x="300" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inletgennotemp</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~inletgennotemp -->
<g id="proc~~readinitfiles~~CallsGraph_edge17" class="edge">
<title>proc~boundary&#45;&gt;proc~inletgennotemp</title>
<path fill="none" stroke="#33ff00" d="M173.7597,-827.974C197.0799,-800.6389 254.2647,-733.6092 282.9738,-699.9575"/>
<polygon fill="#33ff00" stroke="#33ff00" points="285.7936,-702.0448 289.6213,-692.1656 280.4683,-697.5016 285.7936,-702.0448"/>
</g>
<!-- proc~cyclichj -->
<g id="proc~~readinitfiles~~CallsGraph_node14" class="node">
<title>proc~cyclichj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node14"><a xlink:href=".././proc/cyclichj.html" xlink:title="cyclichj">
<polygon fill="#d9534f" stroke="#d9534f" points="484,-1239 430,-1239 430,-1215 484,-1215 484,-1239"/>
<text text-anchor="middle" x="457" y="-1224.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclichj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclichj -->
<g id="proc~~readinitfiles~~CallsGraph_edge18" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclichj</title>
<path fill="none" stroke="#33ff00" d="M166.1836,-852.0743C180.491,-916.3918 247.2852,-1215.9256 251,-1219 298.2945,-1258.142 374.693,-1248.423 419.9621,-1237.7472"/>
<polygon fill="#33ff00" stroke="#33ff00" points="420.815,-1241.1417 429.673,-1235.3292 419.1236,-1234.3491 420.815,-1241.1417"/>
</g>
<!-- proc~cyclicmi -->
<g id="proc~~readinitfiles~~CallsGraph_node15" class="node">
<title>proc~cyclicmi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node15"><a xlink:href=".././proc/cyclicmi.html" xlink:title="cyclicmi">
<polygon fill="#d9534f" stroke="#d9534f" points="328,-440 272,-440 272,-416 328,-416 328,-440"/>
<text text-anchor="middle" x="300" y="-425.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicmi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicmi -->
<g id="proc~~readinitfiles~~CallsGraph_edge20" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicmi</title>
<path fill="none" stroke="#33ff00" d="M164.7543,-827.6411C171.0364,-767.9018 200.7822,-509.471 251,-449 254.1948,-445.1529 258.2238,-441.9942 262.5926,-439.4048"/>
<polygon fill="#33ff00" stroke="#33ff00" points="264.4412,-442.3965 271.8787,-434.8509 261.3591,-436.1115 264.4412,-442.3965"/>
</g>
<!-- proc~valuetop -->
<g id="proc~~readinitfiles~~CallsGraph_node17" class="node">
<title>proc~valuetop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node17"><a xlink:href=".././proc/valuetop.html" xlink:title="valuetop">
<polygon fill="#d9534f" stroke="#d9534f" points="329.5,-1188 270.5,-1188 270.5,-1164 329.5,-1164 329.5,-1188"/>
<text text-anchor="middle" x="300" y="-1173.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">valuetop</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~valuetop -->
<g id="proc~~readinitfiles~~CallsGraph_edge21" class="edge">
<title>proc~boundary&#45;&gt;proc~valuetop</title>
<path fill="none" stroke="#33ff00" d="M166.196,-852.0448C178.5485,-906.8484 230.0327,-1131.0178 251,-1155 253.8784,-1158.2923 257.3635,-1161.0846 261.1333,-1163.4494"/>
<polygon fill="#33ff00" stroke="#33ff00" points="259.8093,-1166.7062 270.2946,-1168.2255 263.0453,-1160.4991 259.8093,-1166.7062"/>
</g>
<!-- proc~cyclichi -->
<g id="proc~~readinitfiles~~CallsGraph_node18" class="node">
<title>proc~cyclichi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node18"><a xlink:href=".././proc/cyclichi.html" xlink:title="cyclichi">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-1146 273,-1146 273,-1122 327,-1122 327,-1146"/>
<text text-anchor="middle" x="300" y="-1131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclichi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclichi -->
<g id="proc~~readinitfiles~~CallsGraph_edge22" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclichi</title>
<path fill="none" stroke="#33ff00" d="M163.9433,-852.0873C166.1034,-893.794 178.6668,-1033.4688 251,-1113 254.5291,-1116.8803 258.8971,-1120.0718 263.5595,-1122.6892"/>
<polygon fill="#33ff00" stroke="#33ff00" points="262.2101,-1125.9228 272.7453,-1127.0453 265.2095,-1119.598 262.2101,-1125.9228"/>
</g>
<!-- proc~ioqi -->
<g id="proc~~readinitfiles~~CallsGraph_node22" class="node">
<title>proc~ioqi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node22"><a xlink:href=".././proc/ioqi.html" xlink:title="ioqi">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-1104 273,-1104 273,-1080 327,-1080 327,-1104"/>
<text text-anchor="middle" x="300" y="-1089.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ioqi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~ioqi -->
<g id="proc~~readinitfiles~~CallsGraph_edge23" class="edge">
<title>proc~boundary&#45;&gt;proc~ioqi</title>
<path fill="none" stroke="#33ff00" d="M164.7597,-852.0427C169.2844,-889.4714 187.9549,-1005.1969 251,-1071 254.6287,-1074.7874 259.0521,-1077.9271 263.7405,-1080.5202"/>
<polygon fill="#33ff00" stroke="#33ff00" points="262.4063,-1083.7606 272.9439,-1084.8598 265.3917,-1077.4291 262.4063,-1083.7606"/>
</g>
<!-- proc~scalrec -->
<g id="proc~~readinitfiles~~CallsGraph_node23" class="node">
<title>proc~scalrec</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node23"><a xlink:href=".././proc/scalrec.html" xlink:title="scalrec">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-1062 273,-1062 273,-1038 327,-1038 327,-1062"/>
<text text-anchor="middle" x="300" y="-1047.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalrec</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~scalrec -->
<g id="proc~~readinitfiles~~CallsGraph_edge24" class="edge">
<title>proc~boundary&#45;&gt;proc~scalrec</title>
<path fill="none" stroke="#33ff00" d="M165.99,-852.3892C173.2414,-885.4595 197.3209,-976.8393 251,-1029 254.7212,-1032.616 259.1626,-1035.6553 263.8302,-1038.1972"/>
<polygon fill="#33ff00" stroke="#33ff00" points="262.4168,-1041.4002 272.9551,-1042.493 265.3983,-1035.0669 262.4168,-1041.4002"/>
</g>
<!-- proc~iolet -->
<g id="proc~~readinitfiles~~CallsGraph_node24" class="node">
<title>proc~iolet</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node24"><a xlink:href=".././proc/iolet.html" xlink:title="iolet">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-398 273,-398 273,-374 327,-374 327,-398"/>
<text text-anchor="middle" x="300" y="-383.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iolet</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~iolet -->
<g id="proc~~readinitfiles~~CallsGraph_edge25" class="edge">
<title>proc~boundary&#45;&gt;proc~iolet</title>
<path fill="none" stroke="#33ff00" d="M164.4657,-827.612C169.6442,-764.0277 195.9656,-474.6887 251,-407 254.3801,-402.8428 258.7371,-399.4918 263.4565,-396.7951"/>
<polygon fill="#33ff00" stroke="#33ff00" points="265.2685,-399.8102 272.8169,-392.3756 262.2798,-393.4802 265.2685,-399.8102"/>
</g>
<!-- proc~cyclicmj -->
<g id="proc~~readinitfiles~~CallsGraph_node25" class="node">
<title>proc~cyclicmj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node25"><a xlink:href=".././proc/cyclicmj.html" xlink:title="cyclicmj">
<polygon fill="#d9534f" stroke="#d9534f" points="485,-1148 429,-1148 429,-1124 485,-1124 485,-1148"/>
<text text-anchor="middle" x="457" y="-1133.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicmj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicmj -->
<g id="proc~~readinitfiles~~CallsGraph_edge26" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicmj</title>
<path fill="none" stroke="#33ff00" d="M166.2465,-852.0805C180.3084,-913.8167 243.8611,-1191.3996 251,-1197 307.0276,-1240.9537 394.0615,-1185.4202 434.692,-1154.3442"/>
<polygon fill="#33ff00" stroke="#33ff00" points="436.9141,-1157.0496 442.6299,-1148.1288 432.5986,-1151.5381 436.9141,-1157.0496"/>
</g>
<!-- proc~inlettop -->
<g id="proc~~readinitfiles~~CallsGraph_node27" class="node">
<title>proc~inlettop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node27"><a xlink:href=".././proc/inlettop.html" xlink:title="inlettop">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-482 273,-482 273,-458 327,-458 327,-482"/>
<text text-anchor="middle" x="300" y="-467.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inlettop</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~inlettop -->
<g id="proc~~readinitfiles~~CallsGraph_edge27" class="edge">
<title>proc~boundary&#45;&gt;proc~inlettop</title>
<path fill="none" stroke="#33ff00" d="M165.0826,-827.8722C172.516,-772.5306 205.5199,-544.367 251,-491 254.4387,-486.965 258.7918,-483.6843 263.478,-481.0223"/>
<polygon fill="#33ff00" stroke="#33ff00" points="265.209,-484.0752 272.7471,-476.6303 262.2116,-477.7494 265.209,-484.0752"/>
</g>
<!-- proc~cyclicqj -->
<g id="proc~~readinitfiles~~CallsGraph_node28" class="node">
<title>proc~cyclicqj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node28"><a xlink:href=".././proc/cyclicqj.html" xlink:title="cyclicqj">
<polygon fill="#d9534f" stroke="#d9534f" points="484,-1007 430,-1007 430,-983 484,-983 484,-1007"/>
<text text-anchor="middle" x="457" y="-992.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicqj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicqj -->
<g id="proc~~readinitfiles~~CallsGraph_edge28" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicqj</title>
<path fill="none" stroke="#33ff00" d="M175.1401,-827.827C190.719,-812.5096 220.0018,-786.9984 251,-777 292.4526,-763.6296 315.1937,-749.5369 349,-777 409.6192,-826.245 340.6243,-884.7307 385,-949 393.9022,-961.893 407.7153,-971.9776 420.8715,-979.3765"/>
<polygon fill="#33ff00" stroke="#33ff00" points="419.3259,-982.5181 429.8063,-984.0712 422.5819,-976.3214 419.3259,-982.5181"/>
</g>
<!-- proc~valuetopscal -->
<g id="proc~~readinitfiles~~CallsGraph_node30" class="node">
<title>proc~valuetopscal</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node30"><a xlink:href=".././proc/valuetopscal.html" xlink:title="valuetopscal">
<polygon fill="#d9534f" stroke="#d9534f" points="340,-1020 260,-1020 260,-996 340,-996 340,-1020"/>
<text text-anchor="middle" x="300" y="-1005.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">valuetopscal</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~valuetopscal -->
<g id="proc~~readinitfiles~~CallsGraph_edge29" class="edge">
<title>proc~boundary&#45;&gt;proc~valuetopscal</title>
<path fill="none" stroke="#33ff00" d="M167.8151,-852.4064C178.0463,-880.1546 206.3191,-947.8601 251,-987 252.4881,-988.3036 254.0693,-989.5358 255.7177,-990.6997"/>
<polygon fill="#33ff00" stroke="#33ff00" points="254.0335,-993.7715 264.3995,-995.9612 257.6615,-987.785 254.0335,-993.7715"/>
</g>
<!-- proc~cyclicsi -->
<g id="proc~~readinitfiles~~CallsGraph_node32" class="node">
<title>proc~cyclicsi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node32"><a xlink:href=".././proc/cyclicsi.html" xlink:title="cyclicsi">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-978 273,-978 273,-954 327,-954 327,-978"/>
<text text-anchor="middle" x="300" y="-963.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicsi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicsi -->
<g id="proc~~readinitfiles~~CallsGraph_edge30" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicsi</title>
<path fill="none" stroke="#33ff00" d="M170.9538,-852.3047C184.4847,-873.7406 215.0404,-918.1999 251,-945 254.8775,-947.8898 259.2134,-950.4748 263.659,-952.759"/>
<polygon fill="#33ff00" stroke="#33ff00" points="262.2838,-955.9794 272.8268,-957.0265 265.2379,-949.6333 262.2838,-955.9794"/>
</g>
<!-- proc~iohi -->
<g id="proc~~readinitfiles~~CallsGraph_node33" class="node">
<title>proc~iohi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node33"><a xlink:href=".././proc/iohi.html" xlink:title="iohi">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-936 273,-936 273,-912 327,-912 327,-936"/>
<text text-anchor="middle" x="300" y="-921.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iohi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~iohi -->
<g id="proc~~readinitfiles~~CallsGraph_edge31" class="edge">
<title>proc~boundary&#45;&gt;proc~iohi</title>
<path fill="none" stroke="#33ff00" d="M178.3097,-852.2154C195.1884,-865.7595 223.9489,-887.71 251,-903 254.9594,-905.238 259.2042,-907.3905 263.479,-909.408"/>
<polygon fill="#33ff00" stroke="#33ff00" points="262.2299,-912.6838 272.786,-913.5896 265.0988,-906.2987 262.2299,-912.6838"/>
</g>
<!-- proc~scalsirane -->
<g id="proc~~readinitfiles~~CallsGraph_node34" class="node">
<title>proc~scalsirane</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node34"><a xlink:href=".././proc/scalsirane.html" xlink:title="scalSIRANE">
<polygon fill="#d9534f" stroke="#d9534f" points="336,-894 264,-894 264,-870 336,-870 336,-894"/>
<text text-anchor="middle" x="300" y="-879.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalSIRANE</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~scalsirane -->
<g id="proc~~readinitfiles~~CallsGraph_edge32" class="edge">
<title>proc~boundary&#45;&gt;proc~scalsirane</title>
<path fill="none" stroke="#33ff00" d="M195.5032,-849.8471C212.9499,-855.2153 234.8483,-861.9533 254.0858,-867.8725"/>
<polygon fill="#33ff00" stroke="#33ff00" points="253.2784,-871.286 263.8655,-870.8817 255.337,-864.5955 253.2784,-871.286"/>
</g>
<!-- proc~cyclicqi -->
<g id="proc~~readinitfiles~~CallsGraph_node36" class="node">
<title>proc~cyclicqi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node36"><a xlink:href=".././proc/cyclicqi.html" xlink:title="cyclicqi">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-852 273,-852 273,-828 327,-828 327,-852"/>
<text text-anchor="middle" x="300" y="-837.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicqi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicqi -->
<g id="proc~~readinitfiles~~CallsGraph_edge33" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicqi</title>
<path fill="none" stroke="#33ff00" d="M195.5032,-840C215.5915,-840 241.5817,-840 262.6164,-840"/>
<polygon fill="#33ff00" stroke="#33ff00" points="262.8012,-843.5001 272.8011,-840 262.8011,-836.5001 262.8012,-843.5001"/>
</g>
<!-- proc~iosi -->
<g id="proc~~readinitfiles~~CallsGraph_node37" class="node">
<title>proc~iosi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node37"><a xlink:href=".././proc/iosi.html" xlink:title="iosi">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-810 273,-810 273,-786 327,-786 327,-810"/>
<text text-anchor="middle" x="300" y="-795.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">iosi</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~iosi -->
<g id="proc~~readinitfiles~~CallsGraph_edge34" class="edge">
<title>proc~boundary&#45;&gt;proc~iosi</title>
<path fill="none" stroke="#33ff00" d="M195.5032,-830.1529C215.7749,-823.9154 242.0569,-815.8286 263.1914,-809.3257"/>
<polygon fill="#33ff00" stroke="#33ff00" points="264.2726,-812.655 272.8011,-806.3689 262.214,-805.9646 264.2726,-812.655"/>
</g>
<!-- proc~cyclicsj -->
<g id="proc~~readinitfiles~~CallsGraph_node38" class="node">
<title>proc~cyclicsj</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node38"><a xlink:href=".././proc/cyclicsj.html" xlink:title="cyclicsj">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-650 273,-650 273,-626 327,-626 327,-650"/>
<text text-anchor="middle" x="300" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">cyclicsj</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~cyclicsj -->
<g id="proc~~readinitfiles~~CallsGraph_edge35" class="edge">
<title>proc~boundary&#45;&gt;proc~cyclicsj</title>
<path fill="none" stroke="#33ff00" d="M166.2609,-827.668C174.0364,-795.6052 199.018,-708.6736 251,-659 254.6154,-655.5451 258.8875,-652.6132 263.3779,-650.1373"/>
<polygon fill="#33ff00" stroke="#33ff00" points="265.2342,-653.1302 272.7615,-645.6743 262.2276,-646.8087 265.2342,-653.1302"/>
</g>
<!-- proc~fluxtop -->
<g id="proc~~readinitfiles~~CallsGraph_node41" class="node">
<title>proc~fluxtop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node41"><a xlink:href=".././proc/fluxtop.html" xlink:title="fluxtop">
<polygon fill="#d9534f" stroke="#d9534f" points="327,-524 273,-524 273,-500 327,-500 327,-524"/>
<text text-anchor="middle" x="300" y="-509.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fluxtop</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~fluxtop -->
<g id="proc~~readinitfiles~~CallsGraph_edge36" class="edge">
<title>proc~boundary&#45;&gt;proc~fluxtop</title>
<path fill="none" stroke="#33ff00" d="M165.5102,-827.9821C174.2403,-777.0221 210.2625,-579.281 251,-533 254.5028,-529.0205 258.8914,-525.7705 263.5939,-523.1227"/>
<polygon fill="#33ff00" stroke="#33ff00" points="265.3262,-526.1753 272.8736,-518.7398 262.3366,-519.8458 265.3262,-526.1753"/>
</g>
<!-- proc~inletgen -->
<g id="proc~~readinitfiles~~CallsGraph_node43" class="node">
<title>proc~inletgen</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node43"><a xlink:href=".././proc/inletgen.html" xlink:title="inletgen">
<polygon fill="#d9534f" stroke="#d9534f" points="328,-566 272,-566 272,-542 328,-542 328,-566"/>
<text text-anchor="middle" x="300" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">inletgen</text>
</a>
</g>
</g>
<!-- proc~boundary&#45;&gt;proc~inletgen -->
<g id="proc~~readinitfiles~~CallsGraph_edge37" class="edge">
<title>proc~boundary&#45;&gt;proc~inletgen</title>
<path fill="none" stroke="#33ff00" d="M164.0769,-827.9776C166.6611,-787.127 180.412,-651.9334 251,-575 254.3065,-571.3962 258.3359,-568.3854 262.6487,-565.8764"/>
<polygon fill="#33ff00" stroke="#33ff00" points="264.3262,-568.9519 271.7588,-561.4017 261.24,-562.6689 264.3262,-568.9519"/>
</g>
<!-- mpi_allreduce -->
<g id="proc~~readinitfiles~~CallsGraph_node19" class="node">
<title>mpi_allreduce</title>
<polygon fill="#777777" stroke="#777777" points="653,-297 565,-297 565,-273 653,-273 653,-297"/>
<text text-anchor="middle" x="609" y="-282.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_allreduce</text>
</g>
<!-- proc~slabsum&#45;&gt;mpi_allreduce -->
<g id="proc~~readinitfiles~~CallsGraph_edge38" class="edge">
<title>proc~slabsum&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#00ff66" d="M485.59,-267.9499C505.0671,-270.6409 531.461,-274.2874 554.8413,-277.5175"/>
<polygon fill="#00ff66" stroke="#00ff66" points="554.6057,-281.0182 564.9907,-278.9198 555.5638,-274.084 554.6057,-281.0182"/>
</g>
<!-- proc~zinterpolate2d -->
<g id="proc~~readinitfiles~~CallsGraph_node21" class="node">
<title>proc~zinterpolate2d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node21"><a xlink:href=".././proc/zinterpolate2d.html" xlink:title="zinterpolate2d">
<polygon fill="#d9534f" stroke="#d9534f" points="345,-150 255,-150 255,-126 345,-126 345,-150"/>
<text text-anchor="middle" x="300" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolate2d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolate2d -->
<g id="proc~~readinitfiles~~CallsGraph_edge40" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolate2d</title>
<path fill="none" stroke="#00ffff" d="M210.858,-138C221.7055,-138 233.3322,-138 244.4882,-138"/>
<polygon fill="#00ffff" stroke="#00ffff" points="244.5653,-141.5001 254.5653,-138 244.5652,-134.5001 244.5653,-141.5001"/>
</g>
<!-- proc~zinterpolatew1d -->
<g id="proc~~readinitfiles~~CallsGraph_node31" class="node">
<title>proc~zinterpolatew1d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node31"><a xlink:href=".././proc/zinterpolatew1d.html" xlink:title="zinterpolatew1d">
<polygon fill="#d9534f" stroke="#d9534f" points="349,-108 251,-108 251,-84 349,-84 349,-108"/>
<text text-anchor="middle" x="300" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolatew1d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolatew1d -->
<g id="proc~~readinitfiles~~CallsGraph_edge39" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolatew1d</title>
<path fill="none" stroke="#00ffff" d="M202.6154,-125.9645C217.7511,-121.3074 235.2401,-115.9261 251.1852,-111.0199"/>
<polygon fill="#00ffff" stroke="#00ffff" points="252.3504,-114.3234 260.8789,-108.0373 250.2917,-107.633 252.3504,-114.3234"/>
</g>
<!-- proc~zinterpolatet1d -->
<g id="proc~~readinitfiles~~CallsGraph_node39" class="node">
<title>proc~zinterpolatet1d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node39"><a xlink:href=".././proc/zinterpolatet1d.html" xlink:title="zinterpolatet1d">
<polygon fill="#d9534f" stroke="#d9534f" points="347,-66 253,-66 253,-42 347,-42 347,-66"/>
<text text-anchor="middle" x="300" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolatet1d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolatet1d -->
<g id="proc~~readinitfiles~~CallsGraph_edge41" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolatet1d</title>
<path fill="none" stroke="#00ffff" d="M199.5751,-125.8783C204.9751,-123.3418 210.3006,-120.3882 215,-117 234.9425,-102.6216 231.1855,-89.5544 251,-75 253.0233,-73.5138 255.168,-72.1068 257.3856,-70.7789"/>
<polygon fill="#00ffff" stroke="#00ffff" points="259.0421,-73.8621 266.1978,-66.0489 255.7315,-67.6944 259.0421,-73.8621"/>
</g>
<!-- proc~zinterpolate1d -->
<g id="proc~~readinitfiles~~CallsGraph_node42" class="node">
<title>proc~zinterpolate1d</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node42"><a xlink:href=".././proc/zinterpolate1d.html" xlink:title="zinterpolate1d">
<polygon fill="#d9534f" stroke="#d9534f" points="345,-24 255,-24 255,0 345,0 345,-24"/>
<text text-anchor="middle" x="300" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">zinterpolate1d</text>
</a>
</g>
</g>
<!-- proc~readrestartfiles&#45;&gt;proc~zinterpolate1d -->
<g id="proc~~readinitfiles~~CallsGraph_edge42" class="edge">
<title>proc~readrestartfiles&#45;&gt;proc~zinterpolate1d</title>
<path fill="none" stroke="#00ffff" d="M202.6654,-125.9508C207.1668,-123.4745 211.4183,-120.5188 215,-117 243.974,-88.5345 222.2791,-61.7209 251,-33 252.0635,-31.9365 253.1894,-30.9234 254.3655,-29.9586"/>
<polygon fill="#00ffff" stroke="#00ffff" points="256.428,-32.7887 262.7269,-24.2696 252.4903,-27.0012 256.428,-32.7887"/>
</g>
<!-- proc~yinterpolate -->
<g id="proc~~readinitfiles~~CallsGraph_node16" class="node">
<title>proc~yinterpolate</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node16"><a xlink:href=".././proc/yinterpolate.html" xlink:title="yinterpolate">
<polygon fill="#d9534f" stroke="#d9534f" points="647.5,-940 570.5,-940 570.5,-916 647.5,-916 647.5,-940"/>
<text text-anchor="middle" x="609" y="-925.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">yinterpolate</text>
</a>
</g>
</g>
<!-- proc~readinletfile&#45;&gt;proc~yinterpolate -->
<g id="proc~~readinitfiles~~CallsGraph_edge43" class="edge">
<title>proc~readinletfile&#45;&gt;proc~yinterpolate</title>
<path fill="none" stroke="#cc00ff" d="M495.7493,-928C515.3128,-928 539.2514,-928 560.0718,-928"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="560.3215,-931.5001 570.3215,-928 560.3214,-924.5001 560.3215,-931.5001"/>
</g>
<!-- proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_node29" class="node">
<title>proc~excjs</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node29"><a xlink:href=".././proc/excjs.html" xlink:title="excjs">
<polygon fill="#d9534f" stroke="#d9534f" points="636,-1077 582,-1077 582,-1053 636,-1053 636,-1077"/>
<text text-anchor="middle" x="609" y="-1062.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">excjs</text>
</a>
</g>
</g>
<!-- proc~readinletfile&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge44" class="edge">
<title>proc~readinletfile&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#cc00ff" d="M479.2114,-940.0006C494.0409,-948.5242 513.5766,-960.7678 529,-974 554.1976,-995.6178 578.7331,-1025.1685 593.8455,-1044.6539"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="591.2425,-1047.012 600.0945,-1052.8337 596.805,-1042.7624 591.2425,-1047.012"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge53" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#ff2f00" d="M339.7523,-667.7304C343.2976,-665.3181 346.4886,-662.4378 349,-659 398.2537,-591.5795 331.7568,-349.3166 385,-285 393.2551,-275.028 405.9579,-269.6342 418.4085,-266.7666"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="419.0414,-270.209 428.2499,-264.9692 417.7837,-263.3229 419.0414,-270.209"/>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge55" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~readinletfile</title>
<path fill="none" stroke="#ff2f00" d="M332.6978,-692.0218C338.9171,-695.6536 344.7882,-700.2513 349,-706 401.3443,-777.4452 327.7429,-834.428 385,-902 391.2491,-909.3749 399.7593,-914.6579 408.7413,-918.4424"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="407.6031,-921.7526 418.1973,-921.8686 409.9878,-915.1713 407.6031,-921.7526"/>
</g>
<!-- wrec -->
<g id="proc~~readinitfiles~~CallsGraph_node44" class="node">
<title>wrec</title>
<polygon fill="#777777" stroke="#777777" points="484,-818 430,-818 430,-794 484,-794 484,-818"/>
<text text-anchor="middle" x="457" y="-803.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wrec</text>
</g>
<!-- proc~inletgennotemp&#45;&gt;wrec -->
<g id="proc~~readinitfiles~~CallsGraph_edge45" class="edge">
<title>proc~inletgennotemp&#45;&gt;wrec</title>
<path fill="none" stroke="#ff2f00" d="M330.1467,-692.0158C336.9532,-695.7481 343.7188,-700.3906 349,-706 375.4494,-734.0931 355.8271,-759.7467 385,-785 394.6909,-793.3888 407.5747,-798.4313 419.7632,-801.4605"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="419.2463,-804.9283 429.7526,-803.5608 420.6867,-798.0781 419.2463,-804.9283"/>
</g>
<!-- utav -->
<g id="proc~~readinitfiles~~CallsGraph_node45" class="node">
<title>utav</title>
<polygon fill="#777777" stroke="#777777" points="636,-566 582,-566 582,-542 636,-542 636,-566"/>
<text text-anchor="middle" x="609" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">utav</text>
</g>
<!-- proc~inletgennotemp&#45;&gt;utav -->
<g id="proc~~readinitfiles~~CallsGraph_edge46" class="edge">
<title>proc~inletgennotemp&#45;&gt;utav</title>
<path fill="none" stroke="#ff2f00" d="M332.5432,-692.1373C338.7721,-695.7619 344.6862,-700.3275 349,-706 393.9087,-765.0543 327.1587,-822.5395 385,-869 434.8966,-909.079 478.4815,-908.2922 529,-869 576.0495,-832.406 599.9288,-641.6603 606.8362,-576.1314"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="610.3295,-576.3743 607.8658,-566.0699 603.3659,-575.6616 610.3295,-576.3743"/>
</g>
<!-- proc~dispthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_node46" class="node">
<title>proc~dispthicknessexp</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node46"><a xlink:href=".././proc/dispthicknessexp.html" xlink:title="dispthicknessexp">
<polygon fill="#d9534f" stroke="#d9534f" points="508.5,-566 405.5,-566 405.5,-542 508.5,-542 508.5,-566"/>
<text text-anchor="middle" x="457" y="-551.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">dispthicknessexp</text>
</a>
</g>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~dispthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge47" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~dispthicknessexp</title>
<path fill="none" stroke="#ff2f00" d="M337.2731,-667.7304C341.5545,-665.2902 345.5969,-662.4031 349,-659 377.7209,-630.2791 354.5938,-601.9303 385,-575 388.3811,-572.0054 392.1679,-569.4368 396.1883,-567.2336"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="397.7225,-570.38 405.296,-562.971 394.7552,-564.04 397.7225,-570.38"/>
</g>
<!-- proc~writeinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_node47" class="node">
<title>proc~writeinletfile</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node47"><a xlink:href=".././proc/writeinletfile.html" xlink:title="writeinletfile">
<polygon fill="#d9534f" stroke="#d9534f" points="496.5,-776 417.5,-776 417.5,-752 496.5,-752 496.5,-776"/>
<text text-anchor="middle" x="457" y="-761.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">writeinletfile</text>
</a>
</g>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~writeinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge48" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~writeinletfile</title>
<path fill="none" stroke="#ff2f00" d="M326.343,-692.0595C333.9512,-696.0426 342.066,-700.7999 349,-706 367.3556,-719.7657 365.3379,-731.1753 385,-743 391.981,-747.1983 399.85,-750.5988 407.756,-753.3407"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="406.7713,-756.7 417.3609,-756.368 408.8755,-750.0238 406.7713,-756.7"/>
</g>
<!-- proc~writerestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_node48" class="node">
<title>proc~writerestartfiles</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node48"><a xlink:href=".././proc/writerestartfiles.html" xlink:title="writerestartfiles">
<polygon fill="#d9534f" stroke="#d9534f" points="505,-734 409,-734 409,-710 505,-710 505,-734"/>
<text text-anchor="middle" x="457" y="-719.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">writerestartfiles</text>
</a>
</g>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~writerestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_edge49" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~writerestartfiles</title>
<path fill="none" stroke="#ff2f00" d="M344.9899,-692.0355C362.8093,-696.8025 383.4647,-702.3281 402.1486,-707.3264"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="401.4387,-710.7595 412.0035,-709.9627 403.2477,-703.9973 401.4387,-710.7595"/>
</g>
<!-- uinl -->
<g id="proc~~readinitfiles~~CallsGraph_node51" class="node">
<title>uinl</title>
<polygon fill="#777777" stroke="#777777" points="484,-692 430,-692 430,-668 484,-668 484,-692"/>
<text text-anchor="middle" x="457" y="-677.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">uinl</text>
</g>
<!-- proc~inletgennotemp&#45;&gt;uinl -->
<g id="proc~~readinitfiles~~CallsGraph_edge50" class="edge">
<title>proc~inletgennotemp&#45;&gt;uinl</title>
<path fill="none" stroke="#ff2f00" d="M348.8152,-680C371.6087,-680 398.318,-680 419.4947,-680"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="419.7088,-683.5001 429.7087,-680 419.7087,-676.5001 419.7088,-683.5001"/>
</g>
<!-- urec -->
<g id="proc~~readinitfiles~~CallsGraph_node55" class="node">
<title>urec</title>
<polygon fill="#777777" stroke="#777777" points="484,-650 430,-650 430,-626 484,-626 484,-650"/>
<text text-anchor="middle" x="457" y="-635.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">urec</text>
</g>
<!-- proc~inletgennotemp&#45;&gt;urec -->
<g id="proc~~readinitfiles~~CallsGraph_edge51" class="edge">
<title>proc~inletgennotemp&#45;&gt;urec</title>
<path fill="none" stroke="#ff2f00" d="M344.9899,-667.9645C368.7203,-661.6162 397.4803,-653.9225 419.9158,-647.9206"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="420.9824,-651.2584 429.7382,-645.293 419.1733,-644.4962 420.9824,-651.2584"/>
</g>
<!-- proc~momentumthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_node56" class="node">
<title>proc~momentumthicknessexp</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node56"><a xlink:href=".././proc/momentumthicknessexp.html" xlink:title="momentumthicknessexp">
<polygon fill="#d9534f" stroke="#d9534f" points="529,-608 385,-608 385,-584 529,-584 529,-608"/>
<text text-anchor="middle" x="457" y="-593.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">momentumthicknessexp</text>
</a>
</g>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~momentumthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge52" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~momentumthicknessexp</title>
<path fill="none" stroke="#ff2f00" d="M333.8022,-667.9511C339.1166,-665.3804 344.3753,-662.397 349,-659 368.8145,-644.4456 364.3411,-630.3288 385,-617 387.7353,-615.2352 390.623,-613.6149 393.6073,-612.1275"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="395.0716,-615.307 402.7939,-608.0533 392.2336,-608.908 395.0716,-615.307"/>
</g>
<!-- proc~blthicknesst -->
<g id="proc~~readinitfiles~~CallsGraph_node57" class="node">
<title>proc~blthicknesst</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node57"><a xlink:href=".././proc/blthicknesst.html" xlink:title="blthicknesst">
<polygon fill="#d9534f" stroke="#d9534f" points="495,-860 419,-860 419,-836 495,-836 495,-860"/>
<text text-anchor="middle" x="457" y="-845.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">blthicknesst</text>
</a>
</g>
</g>
<!-- proc~inletgennotemp&#45;&gt;proc~blthicknesst -->
<g id="proc~~readinitfiles~~CallsGraph_edge54" class="edge">
<title>proc~inletgennotemp&#45;&gt;proc~blthicknesst</title>
<path fill="none" stroke="#ff2f00" d="M331.7315,-692.0869C338.1611,-695.7448 344.3634,-700.3369 349,-706 384.5442,-749.4127 345.2193,-787.433 385,-827 391.6441,-833.6084 400.2428,-838.1608 409.1722,-841.2911"/>
<polygon fill="#ff2f00" stroke="#ff2f00" points="408.3329,-844.6925 418.9143,-844.1595 410.3101,-837.9775 408.3329,-844.6925"/>
</g>
<!-- proc~cyclichj&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge56" class="edge">
<title>proc~cyclichj&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#ff5f00" d="M470.0657,-1214.9237C484.7427,-1201.2158 509.1126,-1178.0245 529,-1157 551.8065,-1132.8895 576.6869,-1103.8008 592.5451,-1084.8769"/>
<polygon fill="#ff5f00" stroke="#ff5f00" points="595.2375,-1087.1132 598.9566,-1077.1926 589.8626,-1082.6286 595.2375,-1087.1132"/>
</g>
<!-- proc~iolet&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge57" class="edge">
<title>proc~iolet&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#00ff3f" d="M327.0071,-375.5275C334.8082,-371.545 342.8627,-366.3899 349,-360 374.6126,-333.3334 356.8048,-308.9194 385,-285 394.3691,-277.0517 406.6133,-272.1097 418.3404,-269.0377"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="419.4277,-272.3813 428.4275,-266.7908 417.9057,-265.5488 419.4277,-272.3813"/>
</g>
<!-- proc~cyclicmj&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge58" class="edge">
<title>proc~cyclicmj&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#00ff6f" d="M482.7847,-1123.9558C507.7877,-1112.2768 545.9153,-1094.4672 573.722,-1081.4785"/>
<polygon fill="#00ff6f" stroke="#00ff6f" points="575.5097,-1084.5066 583.0888,-1077.1033 572.5472,-1078.1643 575.5097,-1084.5066"/>
</g>
<!-- proc~slabsumi -->
<g id="proc~~readinitfiles~~CallsGraph_node54" class="node">
<title>proc~slabsumi</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node54"><a xlink:href=".././proc/slabsumi.html" xlink:title="slabsumi">
<polygon fill="#d9534f" stroke="#d9534f" points="487,-318 427,-318 427,-294 487,-294 487,-318"/>
<text text-anchor="middle" x="457" y="-303.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">slabsumi</text>
</a>
</g>
</g>
<!-- proc~inlettop&#45;&gt;proc~slabsumi -->
<g id="proc~~readinitfiles~~CallsGraph_edge59" class="edge">
<title>proc~inlettop&#45;&gt;proc~slabsumi</title>
<path fill="none" stroke="#00ffcf" d="M327.0901,-463.2281C335.0801,-460.0626 343.2215,-455.5037 349,-449 386.5496,-406.738 344.9619,-366.9124 385,-327 393.5588,-318.4681 405.3754,-313.3624 416.9626,-310.32"/>
<polygon fill="#00ffcf" stroke="#00ffcf" points="417.9678,-313.6834 426.9987,-308.1432 416.484,-306.8425 417.9678,-313.6834"/>
</g>
<!-- proc~cyclicqj&#45;&gt;proc~excjs -->
<g id="proc~~readinitfiles~~CallsGraph_edge60" class="edge">
<title>proc~cyclicqj&#45;&gt;proc~excjs</title>
<path fill="none" stroke="#00ffff" d="M483.1297,-1007.0334C508.0343,-1018.5027 545.7307,-1035.8628 573.3794,-1048.5958"/>
<polygon fill="#00ffff" stroke="#00ffff" points="572.1554,-1051.8854 582.7026,-1052.8893 575.0835,-1045.5272 572.1554,-1051.8854"/>
</g>
<!-- mpi_sendrecv -->
<g id="proc~~readinitfiles~~CallsGraph_node59" class="node">
<title>mpi_sendrecv</title>
<polygon fill="#777777" stroke="#777777" points="776,-1077 689,-1077 689,-1053 776,-1053 776,-1077"/>
<text text-anchor="middle" x="732.5" y="-1062.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">mpi_sendrecv</text>
</g>
<!-- proc~excjs&#45;&gt;mpi_sendrecv -->
<g id="proc~~readinitfiles~~CallsGraph_edge61" class="edge">
<title>proc~excjs&#45;&gt;mpi_sendrecv</title>
<path fill="none" stroke="#00cfff" d="M636.1026,-1065C648.6793,-1065 664.091,-1065 678.871,-1065"/>
<polygon fill="#00cfff" stroke="#00cfff" points="678.9599,-1068.5001 688.9599,-1065 678.9598,-1061.5001 678.9599,-1068.5001"/>
</g>
<!-- proc~fromztop -->
<g id="proc~~readinitfiles~~CallsGraph_node52" class="node">
<title>proc~fromztop</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node52"><a xlink:href=".././proc/fromztop.html" xlink:title="fromztop">
<polygon fill="#d9534f" stroke="#d9534f" points="487.5,-234 426.5,-234 426.5,-210 487.5,-210 487.5,-234"/>
<text text-anchor="middle" x="457" y="-219.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">fromztop</text>
</a>
</g>
</g>
<!-- proc~diagfld&#45;&gt;proc~fromztop -->
<g id="proc~~readinitfiles~~CallsGraph_edge62" class="edge">
<title>proc~diagfld&#45;&gt;proc~fromztop</title>
<path fill="none" stroke="#4f00ff" d="M327.3473,-222C351.8865,-222 388.2379,-222 416.2103,-222"/>
<polygon fill="#4f00ff" stroke="#4f00ff" points="416.4786,-225.5001 426.4786,-222 416.4785,-218.5001 416.4786,-225.5001"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~slabsum -->
<g id="proc~~readinitfiles~~CallsGraph_edge74" class="edge">
<title>proc~inletgen&#45;&gt;proc~slabsum</title>
<path fill="none" stroke="#ff002f" d="M328.177,-547.5008C336.0257,-544.3638 343.8129,-539.7525 349,-533 416.8492,-444.6743 311.9304,-369.0581 385,-285 393.4089,-275.3265 405.9967,-269.9874 418.3063,-267.0796"/>
<polygon fill="#ff002f" stroke="#ff002f" points="419.3016,-270.4539 428.4831,-265.1671 418.0087,-263.5743 419.3016,-270.4539"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~readinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge77" class="edge">
<title>proc~inletgen&#45;&gt;proc~readinletfile</title>
<path fill="none" stroke="#ff002f" d="M328.0141,-560.3268C335.9534,-563.4622 343.833,-568.116 349,-575 428.0248,-680.2847 321.532,-753.6675 385,-869 394.4441,-886.1616 411.0863,-900.2987 425.9929,-910.428"/>
<polygon fill="#ff002f" stroke="#ff002f" points="424.2021,-913.4378 434.5017,-915.9214 427.9989,-907.557 424.2021,-913.4378"/>
</g>
<!-- proc~inletgen&#45;&gt;wrec -->
<g id="proc~~readinitfiles~~CallsGraph_edge63" class="edge">
<title>proc~inletgen&#45;&gt;wrec</title>
<path fill="none" stroke="#ff002f" d="M328.0711,-560.5817C335.9154,-563.722 343.7268,-568.3145 349,-575 407.6438,-649.3506 321.9646,-714.3343 385,-785 393.8226,-794.8906 407.0122,-800.2359 419.7012,-803.0869"/>
<polygon fill="#ff002f" stroke="#ff002f" points="419.2161,-806.5557 429.6772,-804.8777 420.453,-799.6658 419.2161,-806.5557"/>
</g>
<!-- proc~inletgen&#45;&gt;utav -->
<g id="proc~~readinitfiles~~CallsGraph_edge64" class="edge">
<title>proc~inletgen&#45;&gt;utav</title>
<path fill="none" stroke="#ff002f" d="M328.0143,-545.2629C344.4357,-540.6005 365.6857,-535.3505 385,-533 448.5313,-525.2683 465.5265,-524.8079 529,-533 543.2992,-534.8455 558.6881,-538.4738 572.1124,-542.2025"/>
<polygon fill="#ff002f" stroke="#ff002f" points="571.3658,-545.6299 581.9445,-545.0456 573.3103,-538.9054 571.3658,-545.6299"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~dispthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge69" class="edge">
<title>proc~inletgen&#45;&gt;proc~dispthicknessexp</title>
<path fill="none" stroke="#ff002f" d="M328.0685,-554C346.7384,-554 372.0084,-554 395.23,-554"/>
<polygon fill="#ff002f" stroke="#ff002f" points="395.3766,-557.5001 405.3766,-554 395.3765,-550.5001 395.3766,-557.5001"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~writeinletfile -->
<g id="proc~~readinitfiles~~CallsGraph_edge66" class="edge">
<title>proc~inletgen&#45;&gt;proc~writeinletfile</title>
<path fill="none" stroke="#ff002f" d="M328.158,-560.8206C335.9102,-563.9628 343.6486,-568.4963 349,-575 397.5186,-633.9666 333.0021,-687.0774 385,-743 391.1199,-749.5818 399.1738,-754.1411 407.674,-757.2899"/>
<polygon fill="#ff002f" stroke="#ff002f" points="406.794,-760.681 417.3812,-760.2784 408.8537,-753.9909 406.794,-760.681"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~writerestartfiles -->
<g id="proc~~readinitfiles~~CallsGraph_edge67" class="edge">
<title>proc~inletgen&#45;&gt;proc~writerestartfiles</title>
<path fill="none" stroke="#ff002f" d="M328.1447,-561.1536C335.8036,-564.298 343.4943,-568.7492 349,-575 387.4951,-618.705 343.9308,-659.7045 385,-701 389.1763,-705.1993 394.1414,-708.5693 399.4833,-711.2722"/>
<polygon fill="#ff002f" stroke="#ff002f" points="398.1841,-714.523 408.7561,-715.2196 400.926,-708.0823 398.1841,-714.523"/>
</g>
<!-- proc~enthalpythickness -->
<g id="proc~~readinitfiles~~CallsGraph_node49" class="node">
<title>proc~enthalpythickness</title>
<g id="a_proc~~readinitfiles~~CallsGraph_node49"><a xlink:href=".././proc/enthalpythickness.html" xlink:title="enthalpythickness">
<polygon fill="#d9534f" stroke="#d9534f" points="511.5,-360 402.5,-360 402.5,-336 511.5,-336 511.5,-360"/>
<text text-anchor="middle" x="457" y="-345.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">enthalpythickness</text>
</a>
</g>
</g>
<!-- proc~inletgen&#45;&gt;proc~enthalpythickness -->
<g id="proc~~readinitfiles~~CallsGraph_edge65" class="edge">
<title>proc~inletgen&#45;&gt;proc~enthalpythickness</title>
<path fill="none" stroke="#ff002f" d="M328.1378,-547.1627C335.8893,-544.02 343.6324,-539.4903 349,-533 396.5584,-475.4936 334.0489,-423.5232 385,-369 387.4754,-366.3511 390.264,-364.03 393.2685,-361.9967"/>
<polygon fill="#ff002f" stroke="#ff002f" points="395.2013,-364.9262 402.2264,-356.9953 391.7888,-358.8143 395.2013,-364.9262"/>
</g>
<!-- trec -->
<g id="proc~~readinitfiles~~CallsGraph_node50" class="node">
<title>trec</title>
<polygon fill="#777777" stroke="#777777" points="484,-486 430,-486 430,-462 484,-462 484,-486"/>
<text text-anchor="middle" x="457" y="-471.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">trec</text>
</g>
<!-- proc~inletgen&#45;&gt;trec -->
<g id="proc~~readinitfiles~~CallsGraph_edge76" class="edge">
<title>proc~inletgen&#45;&gt;trec</title>
<path fill="none" stroke="#ff002f" d="M328.0465,-543.9006C335.1274,-540.8401 342.5468,-537.1675 349,-533 367.2334,-521.2248 366.4309,-511.2383 385,-500 395.8369,-493.4414 408.5849,-488.1624 420.3186,-484.1194"/>
<polygon fill="#ff002f" stroke="#ff002f" points="421.4446,-487.4337 429.8722,-481.013 419.28,-480.7768 421.4446,-487.4337"/>
</g>
<!-- proc~inletgen&#45;&gt;uinl -->
<g id="proc~~readinitfiles~~CallsGraph_edge70" class="edge">
<title>proc~inletgen&#45;&gt;uinl</title>
<path fill="none" stroke="#ff002f" d="M328.1698,-561.8209C335.6511,-564.9597 343.2409,-569.2409 349,-575 377.7209,-603.7209 354.5938,-632.0697 385,-659 394.5951,-667.4982 407.4568,-672.5659 419.6543,-675.5848"/>
<polygon fill="#ff002f" stroke="#ff002f" points="419.154,-679.0557 429.6577,-677.6692 420.5819,-672.2028 419.154,-679.0557"/>
</g>
<!-- ttav -->
<g id="proc~~readinitfiles~~CallsGraph_node53" class="node">
<title>ttav</title>
<polygon fill="#777777" stroke="#777777" points="484,-444 430,-444 430,-420 484,-420 484,-444"/>
<text text-anchor="middle" x="457" y="-429.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">ttav</text>
</g>
<!-- proc~inletgen&#45;&gt;ttav -->
<g id="proc~~readinitfiles~~CallsGraph_edge71" class="edge">
<title>proc~inletgen&#45;&gt;ttav</title>
<path fill="none" stroke="#ff002f" d="M328.1033,-546.112C335.5835,-542.9721 343.1894,-538.7072 349,-533 376.8164,-505.6788 355.5813,-478.5879 385,-453 394.671,-444.5883 407.5503,-439.5406 419.7406,-436.5135"/>
<polygon fill="#ff002f" stroke="#ff002f" points="420.665,-439.8958 429.7329,-434.4165 419.2272,-433.0451 420.665,-439.8958"/>
</g>
<!-- proc~inletgen&#45;&gt;urec -->
<g id="proc~~readinitfiles~~CallsGraph_edge72" class="edge">
<title>proc~inletgen&#45;&gt;urec</title>
<path fill="none" stroke="#ff002f" d="M328.1499,-563.468C335.3048,-566.5545 342.7343,-570.3976 349,-575 368.8145,-589.5544 364.3411,-603.6712 385,-617 395.4087,-623.7155 408.0243,-628.3399 419.7692,-631.5"/>
<polygon fill="#ff002f" stroke="#ff002f" points="419.2471,-634.9743 429.7889,-633.9158 420.8879,-628.1693 419.2471,-634.9743"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~momentumthicknessexp -->
<g id="proc~~readinitfiles~~CallsGraph_edge73" class="edge">
<title>proc~inletgen&#45;&gt;proc~momentumthicknessexp</title>
<path fill="none" stroke="#ff002f" d="M328.0685,-561.5088C348.6247,-567.0079 377.1821,-574.6474 402.197,-581.3393"/>
<polygon fill="#ff002f" stroke="#ff002f" points="401.3796,-584.7437 411.9444,-583.9469 403.1886,-577.9814 401.3796,-584.7437"/>
</g>
<!-- proc~inletgen&#45;&gt;proc~blthicknesst -->
<g id="proc~~readinitfiles~~CallsGraph_edge75" class="edge">
<title>proc~inletgen&#45;&gt;proc~blthicknesst</title>
<path fill="none" stroke="#ff002f" d="M328.1864,-560.492C336.0354,-563.6287 343.8205,-568.2416 349,-575 417.8198,-664.7988 310.8724,-741.5301 385,-827 391.3318,-834.3006 400.0439,-839.1332 409.224,-842.3151"/>
<polygon fill="#ff002f" stroke="#ff002f" points="408.3034,-845.6921 418.8799,-845.0678 410.2226,-838.9603 408.3034,-845.6921"/>
</g>
<!-- tinl -->
<g id="proc~~readinitfiles~~CallsGraph_node58" class="node">
<title>tinl</title>
<polygon fill="#777777" stroke="#777777" points="484,-402 430,-402 430,-378 484,-378 484,-402"/>
<text text-anchor="middle" x="457" y="-387.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tinl</text>
</g>
<!-- proc~inletgen&#45;&gt;tinl -->
<g id="proc~~readinitfiles~~CallsGraph_edge68" class="edge">
<title>proc~inletgen&#45;&gt;tinl</title>
<path fill="none" stroke="#ff002f" d="M328.1107,-546.8164C335.7687,-543.6711 343.4674,-539.227 349,-533 386.5496,-490.738 344.9619,-450.9124 385,-411 394.3138,-401.7154 407.4856,-396.4882 420.0214,-393.562"/>
<polygon fill="#ff002f" stroke="#ff002f" points="420.6917,-396.9974 429.8527,-391.6751 419.3722,-390.1228 420.6917,-396.9974"/>
</g>
<!-- proc~dispthicknessexp&#45;&gt;utav -->
<g id="proc~~readinitfiles~~CallsGraph_edge78" class="edge">
<title>proc~dispthicknessexp&#45;&gt;utav</title>
<path fill="none" stroke="#ffbf00" d="M508.8846,-554C529.493,-554 552.7405,-554 571.6428,-554"/>
<polygon fill="#ffbf00" stroke="#ffbf00" points="571.6527,-557.5001 581.6526,-554 571.6526,-550.5001 571.6527,-557.5001"/>
</g>
<!-- proc~slabsumi&#45;&gt;mpi_allreduce -->
<g id="proc~~readinitfiles~~CallsGraph_edge79" class="edge">
<title>proc~slabsumi&#45;&gt;mpi_allreduce</title>
<path fill="none" stroke="#003fff" d="M487.0303,-301.8511C506.3993,-299.1751 532.1491,-295.6176 554.9966,-292.461"/>
<polygon fill="#003fff" stroke="#003fff" points="555.492,-295.9259 564.9189,-291.0902 554.5339,-288.9918 555.492,-295.9259"/>
</g>
</g>
</svg>
</div><script>var panprocreadinitfilesCallsGraph = svgPanZoom('#procreadinitfilesCallsGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="599pt" height="32pt"
 viewBox="0.00 0.00 598.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 594.5,-28 594.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="147.5,-24 89.5,-24 89.5,0 147.5,0 147.5,-24"/>
<text text-anchor="middle" x="118.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="227,-24 166,-24 166,0 227,0 227,-24"/>
<text text-anchor="middle" x="196.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="392,-24 245,-24 245,0 392,0 392,-24"/>
<text text-anchor="middle" x="318.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="468.5,-24 410.5,-24 410.5,0 468.5,0 468.5,-24"/>
<text text-anchor="middle" x="439.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="590.5,-24 486.5,-24 486.5,0 590.5,0 590.5,-24"/>
<text text-anchor="middle" x="538.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
     
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Called by</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: proc~~readinitfiles~~CalledByGraph Pages: 1 -->
<svg id="procreadinitfilesCalledByGraph" width="295pt" height="32pt"
 viewBox="0.00 0.00 295.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="proc~~readinitfiles~~CalledByGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>proc~~readinitfiles~~CalledByGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 291,-28 291,4 -4,4"/>
<!-- proc~readinitfiles -->
<g id="proc~~readinitfiles~~CalledByGraph_node1" class="node">
<title>proc~readinitfiles</title>
<polygon fill="none" stroke="#000000" points="287,-24 211,-24 211,0 287,0 287,-24"/>
<text text-anchor="middle" x="249" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">readinitfiles</text>
</g>
<!-- proc~startup -->
<g id="proc~~readinitfiles~~CalledByGraph_node2" class="node">
<title>proc~startup</title>
<g id="a_proc~~readinitfiles~~CalledByGraph_node2"><a xlink:href=".././proc/startup.html" xlink:title="startup">
<polygon fill="#d9534f" stroke="#d9534f" points="175,-24 121,-24 121,0 175,0 175,-24"/>
<text text-anchor="middle" x="148" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">startup</text>
</a>
</g>
</g>
<!-- proc~startup&#45;&gt;proc~readinitfiles -->
<g id="proc~~readinitfiles~~CalledByGraph_edge1" class="edge">
<title>proc~startup&#45;&gt;proc~readinitfiles</title>
<path fill="none" stroke="#ff0000" d="M175.0661,-12C182.9618,-12 191.8395,-12 200.631,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="200.8478,-15.5001 210.8477,-12 200.8477,-8.5001 200.8478,-15.5001"/>
</g>
<!-- program~dalesurban -->
<g id="proc~~readinitfiles~~CalledByGraph_node3" class="node">
<title>program~dalesurban</title>
<g id="a_proc~~readinitfiles~~CalledByGraph_node3"><a xlink:href=".././program/dalesurban.html" xlink:title="DALESURBAN">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="85,-24 0,-24 0,0 85,0 85,-24"/>
<text text-anchor="middle" x="42.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">DALESURBAN</text>
</a>
</g>
</g>
<!-- program~dalesurban&#45;&gt;proc~startup -->
<g id="proc~~readinitfiles~~CalledByGraph_edge2" class="edge">
<title>program~dalesurban&#45;&gt;proc~startup</title>
<path fill="none" stroke="#ff0000" d="M85.1068,-12C93.5509,-12 102.3554,-12 110.6101,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="110.7036,-15.5001 120.7036,-12 110.7035,-8.5001 110.7036,-15.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="599pt" height="32pt"
 viewBox="0.00 0.00 598.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 594.5,-28 594.5,4 -4,4"/>
<!-- Subroutine -->
<g id="node1" class="node">
<title>Subroutine</title>
<polygon fill="#d9534f" stroke="#d9534f" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Subroutine</text>
</g>
<!-- Function -->
<g id="node2" class="node">
<title>Function</title>
<polygon fill="#d94e8f" stroke="#d94e8f" points="147.5,-24 89.5,-24 89.5,0 147.5,0 147.5,-24"/>
<text text-anchor="middle" x="118.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Function</text>
</g>
<!-- Interface -->
<g id="node3" class="node">
<title>Interface</title>
<polygon fill="#a7506f" stroke="#a7506f" points="227,-24 166,-24 166,0 227,0 227,-24"/>
<text text-anchor="middle" x="196.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Interface</text>
</g>
<!-- Unknown Procedure Type -->
<g id="node4" class="node">
<title>Unknown Procedure Type</title>
<polygon fill="#777777" stroke="#777777" points="392,-24 245,-24 245,0 392,0 392,-24"/>
<text text-anchor="middle" x="318.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Unknown Procedure Type</text>
</g>
<!-- Program -->
<g id="node5" class="node">
<title>Program</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="468.5,-24 410.5,-24 410.5,0 468.5,0 468.5,-24"/>
<text text-anchor="middle" x="439.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Program</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node6" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="590.5,-24 486.5,-24 486.5,0 590.5,0 590.5,-24"/>
<text text-anchor="middle" x="538.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a procedure to one which it calls. Dashed 
    arrows point from an interface to procedures which implement that interface.
    This could include the module procedures in a generic interface or the
    implementation in a submodule of an interface in a parent module. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
     
    <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 





















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../proc/readinitfiles.html#src">readinitfiles</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    

    
    
    
    
    

    
    
    
    
    


    
    
    
    <section>
    <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="highlight"><pre><span></span>   <span class="k">subroutine </span><span class="n">readinitfiles</span>
      <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">um</span><span class="p">,</span> <span class="n">vm</span><span class="p">,</span> <span class="n">wm</span><span class="p">,</span> <span class="n">thlm</span><span class="p">,</span> <span class="n">thl0</span><span class="p">,</span> <span class="n">thl0h</span><span class="p">,</span> <span class="n">qtm</span><span class="p">,</span> <span class="n">qt0</span><span class="p">,</span> <span class="n">qt0h</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">ql0</span><span class="p">,</span> <span class="n">ql0h</span><span class="p">,</span> <span class="n">thv0h</span><span class="p">,</span> <span class="n">sv0</span><span class="p">,</span> <span class="n">svm</span><span class="p">,</span> <span class="n">e12m</span><span class="p">,</span> <span class="n">e120</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">dudxls</span><span class="p">,</span> <span class="n">dudyls</span><span class="p">,</span> <span class="n">dvdxls</span><span class="p">,</span> <span class="n">dvdyls</span><span class="p">,</span> <span class="n">dthldxls</span><span class="p">,</span> <span class="n">dthldyls</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">dqtdxls</span><span class="p">,</span> <span class="n">dqtdyls</span><span class="p">,</span> <span class="n">dqtdtls</span><span class="p">,</span> <span class="n">dpdx</span><span class="p">,</span> <span class="n">dpdxl</span><span class="p">,</span> <span class="n">dpdyl</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">wfls</span><span class="p">,</span> <span class="n">whls</span><span class="p">,</span> <span class="n">ug</span><span class="p">,</span> <span class="n">vg</span><span class="p">,</span> <span class="n">pgx</span><span class="p">,</span> <span class="n">pgy</span><span class="p">,</span> <span class="n">uprof</span><span class="p">,</span> <span class="n">vprof</span><span class="p">,</span> <span class="n">thlprof</span><span class="p">,</span> <span class="n">qtprof</span><span class="p">,</span> <span class="n">e12prof</span><span class="p">,</span> <span class="n">svprof</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">v0av</span><span class="p">,</span> <span class="n">u0av</span><span class="p">,</span> <span class="n">qt0av</span><span class="p">,</span> <span class="n">ql0av</span><span class="p">,</span> <span class="n">thl0av</span><span class="p">,</span> <span class="n">qt0av</span><span class="p">,</span> <span class="n">sv0av</span><span class="p">,</span> <span class="n">exnf</span><span class="p">,</span> <span class="n">exnh</span><span class="p">,</span> <span class="n">presf</span><span class="p">,</span> <span class="n">presh</span><span class="p">,</span> <span class="n">rhof</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">thlpcar</span><span class="p">,</span> <span class="n">uav</span><span class="p">,</span> <span class="n">thvh</span><span class="p">,</span> <span class="n">thvf</span><span class="p">,</span> <span class="n">IIc</span><span class="p">,</span> <span class="n">IIcs</span><span class="p">,</span> <span class="n">IIu</span><span class="p">,</span> <span class="n">IIus</span><span class="p">,</span> <span class="n">IIv</span><span class="p">,</span> <span class="n">IIvs</span><span class="p">,</span> <span class="n">IIw</span><span class="p">,</span> <span class="n">IIws</span>
            <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span>         <span class="k">only</span> <span class="p">:</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">khc</span><span class="p">,</span><span class="n">kmax</span><span class="p">,</span><span class="n">dtmax</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">runtime</span><span class="p">,</span><span class="n">timeleft</span><span class="p">,</span><span class="n">timee</span><span class="p">,</span><span class="n">ntimee</span><span class="p">,</span><span class="n">ntrun</span><span class="p">,</span><span class="n">btime</span><span class="p">,</span><span class="n">dt_lim</span><span class="p">,</span><span class="n">nsv</span><span class="p">,&amp;</span>
         <span class="n">zf</span><span class="p">,</span> <span class="n">zh</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzh</span><span class="p">,</span> <span class="n">rv</span><span class="p">,</span> <span class="n">rd</span><span class="p">,</span> <span class="n">grav</span><span class="p">,</span> <span class="n">cp</span><span class="p">,</span> <span class="n">rlv</span><span class="p">,</span> <span class="n">pref0</span><span class="p">,</span> <span class="n">om23_gs</span><span class="p">,</span> <span class="n">jgb</span><span class="p">,</span> <span class="n">jge</span><span class="p">,</span> <span class="n">Uinf</span><span class="p">,</span> <span class="n">Vinf</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">rslabs</span><span class="p">,</span> <span class="n">e12min</span><span class="p">,</span> <span class="n">dzh</span><span class="p">,</span> <span class="n">dtheta</span><span class="p">,</span> <span class="n">dqt</span><span class="p">,</span> <span class="n">dsv</span><span class="p">,</span> <span class="n">cexpnr</span><span class="p">,</span> <span class="n">ifinput</span><span class="p">,</span> <span class="n">lwarmstart</span><span class="p">,</span> <span class="n">lstratstart</span><span class="p">,</span> <span class="n">trestart</span><span class="p">,</span> <span class="n">numol</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">ladaptive</span><span class="p">,</span> <span class="n">tnextrestart</span><span class="p">,</span> <span class="n">jmax</span><span class="p">,</span> <span class="n">linoutflow</span><span class="p">,</span> <span class="n">lper2inout</span><span class="p">,</span> <span class="n">iinletgen</span><span class="p">,</span> <span class="n">lreadminl</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">uflowrate</span><span class="p">,</span> <span class="n">vflowrate</span><span class="p">,</span><span class="n">ltempeq</span><span class="p">,</span> <span class="n">prandtlmoli</span><span class="p">,</span> <span class="n">freestreamav</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">tnextfielddump</span><span class="p">,</span> <span class="n">tfielddump</span><span class="p">,</span> <span class="n">tsample</span><span class="p">,</span> <span class="n">tstatsdump</span><span class="p">,</span> <span class="n">startfile</span><span class="p">,</span> <span class="n">lprofforc</span><span class="p">,</span> <span class="n">lchem</span><span class="p">,</span> <span class="n">k1</span><span class="p">,</span> <span class="n">JNO2</span><span class="p">,&amp;</span>
         <span class="n">idriver</span><span class="p">,</span><span class="n">dtdriver</span><span class="p">,</span><span class="n">driverstore</span><span class="p">,</span><span class="n">tdriverstart</span><span class="p">,</span><span class="n">tdriverdump</span>        
      <span class="k">use </span><span class="n">modsubgriddata</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">ekm</span><span class="p">,</span> <span class="n">ekh</span>
      <span class="k">use </span><span class="n">modsurfdata</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">wtsurf</span><span class="p">,</span> <span class="n">wqsurf</span><span class="p">,</span> <span class="n">wsvsurf</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">thls</span><span class="p">,</span> <span class="n">thvs</span><span class="p">,</span> <span class="n">ps</span><span class="p">,</span> <span class="n">qts</span><span class="p">,</span> <span class="n">svs</span><span class="p">,</span> <span class="n">sv_top</span>
      <span class="c">! use modsurface,        only : surface,dthldz</span>
      <span class="k">use </span><span class="n">modboundary</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">boundary</span><span class="p">,</span> <span class="n">tqaver</span>
      <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">slabsum</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">,</span> <span class="n">my_real</span><span class="p">,</span> <span class="n">avexy_ibm</span>
      <span class="k">use </span><span class="n">modthermodynamics</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">thermodynamics</span><span class="p">,</span> <span class="n">calc_halflev</span>
      <span class="k">use </span><span class="n">modinletdata</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">Uinl</span><span class="p">,</span> <span class="n">Urec</span><span class="p">,</span> <span class="n">Wrec</span><span class="p">,</span> <span class="n">u0inletbc</span><span class="p">,</span> <span class="n">v0inletbc</span><span class="p">,</span> <span class="n">w0inletbc</span><span class="p">,</span> <span class="n">ubulk</span><span class="p">,</span> <span class="n">irecy</span><span class="p">,</span> <span class="n">Utav</span><span class="p">,</span> <span class="n">Ttav</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">uminletbc</span><span class="p">,</span> <span class="n">vminletbc</span><span class="p">,</span> <span class="n">wminletbc</span><span class="p">,</span> <span class="n">u0inletbcold</span><span class="p">,</span> <span class="n">v0inletbcold</span><span class="p">,</span> <span class="n">w0inletbcold</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">storeu0inletbc</span><span class="p">,</span> <span class="n">storev0inletbc</span><span class="p">,</span> <span class="n">storew0inletbc</span><span class="p">,</span> <span class="n">nstepread</span><span class="p">,</span> <span class="n">nfile</span><span class="p">,</span> <span class="n">Tinl</span><span class="p">,</span> <span class="p">&amp;</span>
         <span class="n">Trec</span><span class="p">,</span> <span class="n">tminletbc</span><span class="p">,</span> <span class="n">t0inletbcold</span><span class="p">,</span> <span class="n">t0inletbc</span><span class="p">,</span> <span class="n">storet0inletbc</span><span class="p">,</span> <span class="n">utaui</span><span class="p">,</span> <span class="n">ttaui</span><span class="p">,</span> <span class="n">iangle</span><span class="p">,&amp;</span>
         <span class="n">u0driver</span><span class="p">,</span><span class="n">v0driver</span><span class="p">,</span><span class="n">w0driver</span><span class="p">,</span><span class="n">e120driver</span><span class="p">,</span><span class="n">tdriver</span><span class="p">,</span><span class="n">thl0driver</span><span class="p">,</span><span class="n">qt0driver</span><span class="p">,</span><span class="n">storetdriver</span><span class="p">,&amp;</span>
         <span class="n">storeu0driver</span><span class="p">,</span><span class="n">storev0driver</span><span class="p">,</span><span class="n">storew0driver</span><span class="p">,</span><span class="n">storee120driver</span><span class="p">,</span><span class="n">storethl0driver</span><span class="p">,</span><span class="n">storeqt0driver</span><span class="p">,&amp;</span>
         <span class="n">nstepreaddriver</span>
      <span class="k">use </span><span class="n">modinlet</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">readinletfile</span>
      <span class="k">use </span><span class="n">moddriver</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="n">readdriverfile</span><span class="p">,</span><span class="n">initdriver</span><span class="p">,</span><span class="n">drivergen</span>

      <span class="kt">integer </span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span>

      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">height</span><span class="p">(:),</span> <span class="n">th0av</span><span class="p">(:)</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="kd">::</span> <span class="n">thv0</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uaverage</span> <span class="c">! volume averaged u-velocity</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vaverage</span> <span class="c">! volume averaged v-velocity</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uaverager</span> <span class="c">! recycle plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uaveragei</span> <span class="c">! inlet plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">taverager</span> <span class="c">! recycle plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="kd">::</span> <span class="n">taveragei</span> <span class="c">! inlet plane</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">waverage</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">uprofrot</span>
      <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="kd">::</span> <span class="n">vprofrot</span>
      <span class="kt">real </span><span class="n">tv</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span><span class="p">,</span> <span class="n">vbulk</span>

      <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="n">chmess</span>

      <span class="k">allocate</span> <span class="p">(</span><span class="n">height</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
      <span class="k">allocate</span> <span class="p">(</span><span class="n">th0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">lstratstart</span><span class="p">)</span> <span class="k">then</span> <span class="c">! Switch</span>

         <span class="c">! Read restart files as in lwarmstart</span>
         <span class="k">call </span><span class="n">readrestartfiles</span>
         <span class="n">um</span> <span class="o">=</span> <span class="n">u0</span>
         <span class="n">vm</span> <span class="o">=</span> <span class="n">v0</span>
         <span class="n">wm</span> <span class="o">=</span> <span class="n">w0</span>
         <span class="n">thlm</span> <span class="o">=</span> <span class="n">thl0</span> <span class="c">!do this before or just not?</span>
         <span class="n">qtm</span> <span class="o">=</span> <span class="n">qt0</span>
         <span class="n">svm</span> <span class="o">=</span> <span class="n">sv0</span>
         <span class="n">e12m</span> <span class="o">=</span> <span class="n">e120</span>

         <span class="c">! Overwrite thlm, thl0, qtm, qt0 from prof.inp.xxx</span>
         <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">            open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
            <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>

            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                  <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>

            <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height    thl     qt      u      v     e12&#39;</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
               <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(f7.1,2f8.1,3f7.1)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
                  <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                  <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

            <span class="k">end do</span>
<span class="k">         end if</span> <span class="c">!myid=0</span>

         <span class="c">! MPI broadcast thl and qt</span>
         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">qtprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="n">thlm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="n">qtm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">         end do</span>

         <span class="c">!ILS13 reintroduced thv !tg3315 this part may wrong, could need to use</span>
         <span class="k">call </span><span class="n">calc_halflev</span>
         <span class="c">! exnf = (presf/pref0)**(rd/cp)  !exner functions not in restart files</span>
         <span class="c">! anymore.. or at least not read</span>
         <span class="c">! exnh = (presh/pref0)**(rd/cp)</span>

         <span class="c">!   write(*,*) &quot;exnf&quot;,enf</span>
         <span class="c">!   write(*,*) &quot;exnh&quot;,exnh</span>
         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
                  <span class="c">!write(*,*) &quot;thl0h&quot;,thl0h(i,j,k)</span>
                  <span class="n">thv0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                                   <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
               <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">         end do</span>

<span class="k">         do </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">je</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
                  <span class="n">thv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                                  <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
               <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">         end do</span>

<span class="k">         </span><span class="n">thvh</span> <span class="o">=</span> <span class="mf">0.</span>
         <span class="c">! call slabsum(thvh,kb,ke,thv0h,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke) ! redefine halflevel thv using calculated thv</span>
         <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0h</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIw</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
         <span class="c">! thvh = thvh/rslabs</span>

         <span class="n">thvf</span> <span class="o">=</span> <span class="mf">0.0</span>
         <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
         <span class="c">! call slabsum(thvf,kb,ke,thv0,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke)</span>
         <span class="c">! thvf = thvf/rslabs</span>

      <span class="k">else</span> <span class="c">!if not lstratstart</span>

         <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lwarmstart</span><span class="p">)</span> <span class="k">then</span>

            <span class="c">!********************************************************************</span>

            <span class="c">!    1.0 prepare initial fields from files &#39;prof.inp&#39; and &#39;scalar.inp&#39;</span>
            <span class="c">!    ----------------------------------------------------------------</span>

            <span class="c">!--------------------------------------------------------------------</span>
            <span class="c">!    1.1 read fields</span>
            <span class="c">!-----------------------------------------------------------------</span>

            <span class="n">dt</span> <span class="o">=</span> <span class="n">dtmax</span><span class="o">/</span><span class="mi">10</span><span class="mf">0.</span>
            <span class="n">timee</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
               <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
               <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
               <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>

               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>

               <span class="c">! Apply rotation in horizontal</span>
               <span class="c">!write (6, *) &#39;iangle = &#39;, iangle</span>

               <span class="c">!uprofrot = uprof*cos(iangle) - vprof*sin(iangle)</span>
               <span class="c">!vprofrot = vprof*cos(iangle) + uprof*sin(iangle)</span>
               <span class="c">!uprof = uprofrot</span>
               <span class="c">!vprof = vprofrot</span>

               <span class="k">close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
               <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height    thl     qt      u      v     e12&#39;</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(f7.1,2f8.1,3f7.1)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
                     <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>

               <span class="k">end do</span>

<span class="k">               if</span> <span class="p">(</span><span class="nb">minval</span><span class="p">(</span><span class="n">e12prof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span> <span class="o">&lt;</span> <span class="n">e12min</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;e12 value is zero (or less) in prof.inp&#39;</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">e12min</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">               end if</span>

<span class="k">            end if</span> <span class="c">! end if myid==0</span>
            <span class="c">! MPI broadcast numbers reading</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">qtprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">uprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">vprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">e12prof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">thlm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">qtm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">vm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
               <span class="n">wm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
               <span class="n">e120</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="n">e12m</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="c">!        ekm (i,j,k) = 0.0</span>
               <span class="c">!        ekh (i,j,k) = 0.0</span>
               <span class="n">ekm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">numol</span>
               <span class="n">ekh</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">numol</span>
            <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">            end do</span>

<span class="k">            </span><span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span><span class="p">)</span> <span class="c">! also for start up</span>

            <span class="c">! ILS13 30.11.17, added, not sure if necessary</span>
            <span class="c">! ILS13 30.11.1, commented</span>
            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="n">jh</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span>
                  <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kb</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">            end do</span>

            <span class="c">!! add random fluctuations</span>
            <span class="n">krand</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">krand</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">krand</span>
               <span class="k">call </span><span class="n">randomnize</span><span class="p">(</span><span class="n">um</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">randu</span><span class="p">,</span> <span class="n">irandom</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">krand</span>
               <span class="k">call </span><span class="n">randomnize</span><span class="p">(</span><span class="n">vm</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">randu</span><span class="p">,</span> <span class="n">irandom</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">krand</span>
               <span class="k">call </span><span class="n">randomnize</span><span class="p">(</span><span class="n">wm</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">randu</span><span class="p">,</span> <span class="n">irandom</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">)</span>
            <span class="k">end do</span>

            <span class="c">!       do k=kb+1,ke-1</span>
            <span class="c">!       do j=jb,je</span>
            <span class="c">!       do i=ib+1,ie-1</span>
            <span class="c">!         call random_number(ran)</span>
            <span class="c">!         ran1 = -1. +2.*ran</span>
            <span class="c">!         wm(i,j,k)=wm(i,j,k)+ 0.1*Uinf*ran1</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!</span>
            <span class="c">!       do k=kb+1,ke-1</span>
            <span class="c">!       do j=jb,je</span>
            <span class="c">!       do i=ib+2,ie-1</span>
            <span class="c">!         call random_number(ran)</span>
            <span class="c">!         ran1 = -1. +2.*ran</span>
            <span class="c">!         um(i,j,k)=um(i,j,k)+ 0.1*Uinf*ran1</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!</span>
            <span class="c">!       do k=kb+1,ke-1</span>
            <span class="c">!       do j=jb,je</span>
            <span class="c">!       do i=ib+1,ie-1</span>
            <span class="c">!         call random_number(ran)</span>
            <span class="c">!         ran1 = -1. +2.*ran</span>
            <span class="c">!         vm(i,j,k)=vm(i,j,k)+ 0.1*Uinf*ran1</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>
            <span class="c">!       end do</span>

            <span class="n">u0</span> <span class="o">=</span> <span class="n">um</span>
            <span class="n">v0</span> <span class="o">=</span> <span class="n">vm</span>
            <span class="n">w0</span> <span class="o">=</span> <span class="n">wm</span>

            <span class="n">uaverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="c">! call slabsum(uaverage, kb, ke, um, ib - 1, ie + 1, jb - 1, je + 1, kb - 1, ke + 1, ib, ie, jb, je, kb, ke)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! averaged u-velocity inflow profile</span>

            <span class="n">vaverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="c">! call slabsum(vaverage, kb, ke, vm, ib - 1, ie + 1, jb - 1, je + 1, kb - 1, ke + 1, ib, ie, jb, je, kb, ke)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="n">vaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
            <span class="k">end do</span>
<span class="k">            </span><span class="n">vbulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">vaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! averaged u-velocity inflow profile</span>

            <span class="c">! Set average inlet profile to initial inlet profile in case of inletgenerator mode</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>

<span class="k">               </span><span class="n">uaverage</span> <span class="o">=</span> <span class="mf">0.</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">um</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>
               <span class="n">Utav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">Uinl</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to um</span>
               <span class="n">Urec</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to um</span>
               <span class="n">Wrec</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to mean w-profile</span>
               <span class="n">u0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">v0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">w0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
               <span class="n">uminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">vminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">wminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">u0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">v0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
               <span class="n">w0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
               <span class="n">utaui</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numol</span><span class="o">*</span><span class="n">Uinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">/</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)))</span> <span class="c">! average streamwise friction at inlet (need for first time step)</span>

               <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">Ttav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to thlm</span>
                  <span class="n">Tinl</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to thlm</span>
                  <span class="n">Trec</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to thlm</span>
                  <span class="n">t0inletbcold</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
                  <span class="n">t0inletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thl0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
                  <span class="n">tminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
                  <span class="n">ttaui</span> <span class="o">=</span> <span class="n">numol</span><span class="o">*</span><span class="n">prandtlmoli</span><span class="o">*</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">Tinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">-</span> <span class="n">thls</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">*</span><span class="n">utaui</span><span class="p">)</span> <span class="c">! average friction temp. at inlet (need for first time step)</span>
               <span class="k">end if</span>

               <span class="c">! add random perturbations</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;random=&#39;</span><span class="p">,</span> <span class="n">ran</span><span class="p">,</span> <span class="n">ran1</span>
               <span class="k">end if</span>

<span class="k">               do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">48</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="n">wm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Uinf</span><span class="o">*</span><span class="n">ran1</span>
               <span class="k">end do</span>
<span class="k">               end do</span>
<span class="k">               end do</span>

               <span class="c">!       do k=kb+1,ke-1</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">48</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">ie</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="n">um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Uinf</span><span class="o">*</span><span class="n">ran1</span>
               <span class="k">end do</span>
<span class="k">               end do</span>
<span class="k">               end do</span>

               <span class="c">!       do k=kb+1,ke-1</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">48</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
               <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">-</span> <span class="mi">1</span>
                  <span class="k">call </span><span class="nb">random_number</span><span class="p">(</span><span class="n">ran</span><span class="p">)</span>
                  <span class="n">ran1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span><span class="o">+</span><span class="mf">2.</span><span class="o">*</span><span class="n">ran</span>
                  <span class="n">vm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span><span class="o">*</span><span class="n">Uinf</span><span class="o">*</span><span class="n">ran1</span>
               <span class="k">end do</span>
<span class="k">               end do</span>
<span class="k">               end do</span>

<span class="k">               </span><span class="n">u0</span> <span class="o">=</span> <span class="n">um</span>
               <span class="n">v0</span> <span class="o">=</span> <span class="n">vm</span>
               <span class="n">w0</span> <span class="o">=</span> <span class="n">wm</span>

            <span class="k">else if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>

<span class="k">               </span><span class="n">nfile</span> <span class="o">=</span> <span class="n">nfile</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">call </span><span class="n">readinletfile</span>
               <span class="n">u0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">v0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">w0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">uminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">vminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">wminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="c">! determine bulk velocity</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>
            <span class="n">elseif</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span> <span class="c">! idriver</span>

               <span class="k">call </span><span class="n">readdriverfile</span>

               <span class="c">! if(myid==0) then</span>
                 <span class="c">! write(*,*) &#39;Driver inlet velocity&#39;</span>
                 <span class="c">! do n=1,driverstore</span>
                   <span class="c">! write (*,&#39;(f9.2,e20.12)&#39;) storetdriver(n),     storeu0driver(1,32,n)</span>
                 <span class="c">! end do</span>
               <span class="c">! endif</span>

              <span class="c">! call slabsum(uaverage,kb,ke,u0,ib-1,ie+1,jb-1,je+1,kb-1,ke+1,ib,ie,jb,je,kb,ke)</span>
              <span class="c">! uaverage = uaverage / ((ie-ib+1)*(jge-jgb+1))  ! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>

              <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
              <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>
                <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
              <span class="k">end do</span>
<span class="k">              </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">!volume-averaged u-velocity</span>

              <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span><span class="n">ubulk</span>
              <span class="k">end if</span>

<span class="k">            </span><span class="n">elseif</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>

<span class="k">              call </span><span class="n">drivergen</span>

            <span class="k">end if</span>

            <span class="c">!---------------------------------------------------------------</span>
            <span class="c">!  1.2 randomnize fields</span>
            <span class="c">!---------------------------------------------------------------</span>
            <span class="c">!     if (iinletgen /= 2 .and. iinletgen /= 1) then</span>
            <span class="c">!       write(6,*) &#39;randomnizing temperature!&#39;</span>
            <span class="c">!       krand  = min(krand,ke)</span>
            <span class="c">!        do k = kb,ke !edited tg3315 krand --&gt; ke</span>
            <span class="c">!          call randomnize(thlm,k,randthl,irandom,ih,jh)</span>
            <span class="c">!          call randomnize(thl0,k,randthl,irandom,ih,jh)</span>
            <span class="c">!        end do</span>
            <span class="c">!       end if</span>

            <span class="n">svprof</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               if</span> <span class="p">(</span><span class="n">nsv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                        <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">                  open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height   sv(1) --------- sv(nsv) &#39;</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                        <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                  <span class="k">end do</span>

<span class="k">               end if</span>
<span class="k">            end if</span> <span class="c">! end if myid==0</span>

            <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svprof</span><span class="p">,</span> <span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span> <span class="o">-</span> <span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">))</span><span class="o">*</span><span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span>
                     <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
                        <span class="n">sv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                        <span class="n">svm</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
                     <span class="k">end do</span>
<span class="k">                  end do</span>
<span class="k">               end do</span>
<span class="k">            end do</span>
<span class="k">          </span>
<span class="k">            if</span> <span class="p">(</span><span class="n">nsv</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span> <span class="c">!tg3315 set these variables here for now and repeat for warmstart</span>

              <span class="k">allocate</span><span class="p">(</span><span class="n">sv_top</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
              <span class="n">sv_top</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span>

              <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">sv_top</span><span class="p">,</span> <span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

              <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;svprof&#39;</span><span class="p">,</span> <span class="n">svprof</span>
              <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;sv_top&#39;</span><span class="p">,</span> <span class="n">sv_top</span>

            <span class="k">end if</span>
 
            <span class="c">!do n = 1,nsv</span>
            <span class="c">!  do j = jb - jhc, je + jhc</span>
            <span class="c">!    do i = ib - ihc, ie + ihc</span>
            <span class="c">!      svm(i, j, ke + 1, n) = svm(i, j, ke)</span>
            <span class="c">!      sv0(i, j, kb - 1, n) = sv0(i, j, kb)</span>
            <span class="c">!    end do</span>
            <span class="c">!  end do</span>
            <span class="c">!end do</span>

            <span class="c">!-----------------------------------------------------------------</span>
            <span class="c">!    2.2 Initialize surface layer</span>
            <span class="c">!-----------------------------------------------------------------</span>

         <span class="c">!ILS13 reintroduced thv !tg3315 this part may wrong, could need to use</span>
         <span class="k">call </span><span class="n">calc_halflev</span>
         <span class="c">! exnf = (presf/pref0)**(rd/cp)  !exner functions not in restart files</span>
         <span class="c">! anymore.. or at least not read</span>
         <span class="c">! exnh = (presh/pref0)**(rd/cp)</span>

            <span class="k">call </span><span class="n">boundary</span> <span class="c">! tg3315 17.10.17 having this in startup was causing issues for running with lmoist ! turned of when pot. temp = temp.</span>
            <span class="k">call </span><span class="n">thermodynamics</span> <span class="c">! turned off when pot. temp = temp.</span>

            <span class="k">call </span><span class="n">boundary</span>
            <span class="k">call </span><span class="n">thermodynamics</span> <span class="c">! turned off when pot. temp = temp.</span>

         <span class="k">else</span> <span class="c">!if lwarmstart</span>
            <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s2">&quot;doing warmstart&quot;</span>
            <span class="k">call </span><span class="n">readrestartfiles</span>

            <span class="n">um</span> <span class="o">=</span> <span class="n">u0</span>
            <span class="n">vm</span> <span class="o">=</span> <span class="n">v0</span>
            <span class="n">wm</span> <span class="o">=</span> <span class="n">w0</span>
            <span class="n">thlm</span> <span class="o">=</span> <span class="n">thl0</span>
            <span class="n">qtm</span> <span class="o">=</span> <span class="n">qt0</span>
            <span class="n">svm</span> <span class="o">=</span> <span class="n">sv0</span>
            <span class="n">e12m</span> <span class="o">=</span> <span class="n">e120</span>
            <span class="n">ekm</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">numol</span>
            <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">numol</span><span class="o">*</span><span class="n">prandtlmoli</span> <span class="c">!tg3315 added because wttop using ekh in modboundary which is called in startup</span>

            <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">ekh</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">ke</span><span class="p">)</span> <span class="c">! also for start up</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">1</span><span class="p">)</span> <span class="k">then</span>                                                                   
              <span class="c">!driverstore = (timeleft - tdriverstart)/dtdriver + 1</span>
              <span class="c">!if(myid==0) then</span>
              <span class="c">!  write(*,*) &#39;driverstore: &#39;, driverstore</span>
              <span class="c">!end if</span>
              <span class="k">call </span><span class="n">drivergen</span>
              <span class="n">tdriverdump</span> <span class="o">=</span> <span class="n">tdriverstart</span>
            <span class="n">endif</span>

            <span class="c">!ILS13 reintroduced thv</span>
            <span class="k">call </span><span class="n">calc_halflev</span>
            <span class="c">! exnf = (presf/pref0)**(rd/cp)  !exner functions not in restart files</span>
            <span class="c">! anymore.. or at least not read</span>
            <span class="c">! exnh = (presh/pref0)**(rd/cp)</span>

            <span class="c">!   write(*,*) &quot;exnf&quot;,enf</span>
            <span class="c">!   write(*,*) &quot;exnh&quot;,exnh</span>

            <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
               <span class="c">!write(*,*) &quot;thl0h&quot;,thl0h(i,j,k)</span>
               <span class="n">thv0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                                <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0h</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
            <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">            end do</span>

<span class="k">            do </span><span class="n">j</span> <span class="o">=</span> <span class="n">j</span><span class="p">,</span> <span class="n">je</span>
            <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
            <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
               <span class="n">thv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">rlv</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">cp</span><span class="p">))</span> <span class="p">&amp;</span>
                               <span class="o">*</span><span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">qt0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span><span class="o">*</span><span class="n">ql0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span>
            <span class="k">end do</span>
<span class="k">            end do</span>
<span class="k">            end do</span>

<span class="k">            </span><span class="n">thvh</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="c">! call slabsum(thvh,kb,ke,thv0h,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke) ! redefine halflevel thv using calculated thv</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0h</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIw</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! thvh = thvh/rslabs</span>

            <span class="n">thvf</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thvf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(thvf,kb,ke,thv0,ib-ih,ie+ih,jb-jh,je+jh,kb-kh,ke+kh,ib,ie,jb,je,kb,ke)</span>
            <span class="c">! thvf = thvf/rslabs</span>

            <span class="c">! Set average inlet profile to initial inlet profile in case of inletgenerator mode</span>
            <span class="n">uaverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">uaveragei</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">uaverager</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">waverage</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">taveragei</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="n">taverager</span> <span class="o">=</span> <span class="mf">0.</span>
            <span class="k">if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<span class="k">               call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaveragei</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverager</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">irecy</span><span class="p">,</span> <span class="n">irecy</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">waverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="n">uaveragei</span> <span class="o">=</span> <span class="n">uaveragei</span><span class="o">/</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! this gives the j-averaged u-velocity at the inlet</span>
               <span class="n">uaverager</span> <span class="o">=</span> <span class="n">uaverager</span><span class="o">/</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! this gives the j-averaged u-velocity at the recycle plane</span>
               <span class="n">waverage</span> <span class="o">=</span> <span class="n">waverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged w-velocity (only correct for equidistant grid?)</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">taveragei</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">thl0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">taverager</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">thl0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">irecy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">irecy</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="n">taveragei</span> <span class="o">=</span> <span class="n">taveragei</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the j-averaged temperature at the inlet</span>
                  <span class="n">taverager</span> <span class="o">=</span> <span class="n">taverager</span><span class="o">/</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! this gives the j-averaged temperature at the recycle plane</span>
               <span class="k">end if</span>
<span class="k">               if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lreadminl</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                     write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uaverage(kb)=&#39;</span><span class="p">,</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uaverage(ke)=&#39;</span><span class="p">,</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;waverage(ke)=&#39;</span><span class="p">,</span> <span class="n">waverage</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;waverage(ke-20)=&#39;</span><span class="p">,</span> <span class="n">waverage</span><span class="p">(</span><span class="n">ke</span> <span class="o">-</span> <span class="mi">20</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;taveragei(kb)=&#39;</span><span class="p">,</span> <span class="n">taveragei</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;taveragei(ke)=&#39;</span><span class="p">,</span> <span class="n">taveragei</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
                  <span class="k">end if</span>

<span class="k">                  </span><span class="n">Utav</span> <span class="o">=</span> <span class="mf">0.</span>
                  <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
                     <span class="n">Utav</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">uaverage</span>
                  <span class="k">end do</span>

<span class="k">                  </span><span class="n">Uinl</span> <span class="o">=</span> <span class="n">uaverage</span> <span class="c">! set the initial time-averaged inlet profile equal to mean u-profile read from means</span>
                  <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Uinl(kb+10)=&#39;</span><span class="p">,</span> <span class="n">Uinl</span><span class="p">(</span><span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
                  <span class="n">utaui</span> <span class="o">=</span> <span class="nb">sqrt</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">numol</span><span class="o">*</span><span class="n">Uinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">/</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)))</span> <span class="c">! average streamwise friction at inlet (need for first time step)</span>
                  <span class="n">Urec</span> <span class="o">=</span> <span class="n">uaverage</span> <span class="c">! set the initial time-averaged inlet profile equal to mean u-profile</span>

                  <span class="n">Wrec</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">waverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="c">! set the initial time-averaged inlet profile equal to mean w-profile</span>
                  <span class="n">Wrec</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">! set the initial time-averaged inlet profile equal to zero</span>
                  <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                     </span><span class="n">Ttav</span> <span class="o">=</span> <span class="mf">0.</span>
                     <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
                        <span class="n">Ttav</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">taveragei</span><span class="p">(:)</span>
                     <span class="k">end do</span>
<span class="k">                     </span><span class="n">Tinl</span> <span class="o">=</span> <span class="n">taveragei</span>
                     <span class="n">Trec</span> <span class="o">=</span> <span class="n">taveragei</span>
                     <span class="n">ttaui</span> <span class="o">=</span> <span class="n">numol</span><span class="o">*</span><span class="n">prandtlmoli</span><span class="o">*</span><span class="mf">2.</span><span class="o">*</span><span class="p">(</span><span class="n">Tinl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">-</span> <span class="n">thls</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">*</span><span class="n">utaui</span><span class="p">)</span> <span class="c">! friction temp. at inlet (need at first time step)</span>
                  <span class="k">end if</span>
<span class="k">               else</span> <span class="c">! -&gt; lreadminl -&gt; Uinl, Urec, Wrec already read</span>
                  <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
                  <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="k">end if</span>

               <span class="c">! determine bulk velocity</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>

               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
                  <span class="n">uminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">vminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">u0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">v0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">u0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">v0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">vm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               end do</span>

<span class="k">               do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
                  <span class="n">wminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">w0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="n">w0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">wm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               end do</span>

<span class="k">               if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
                     <span class="n">tminletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                     <span class="n">t0inletbcold</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                     <span class="n">t0inletbc</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">thlm</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">                  end do</span>
<span class="k">               end if</span>

<span class="k">               write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uminletbc(jb,kb),um(ib,jb,kb)=&#39;</span><span class="p">,</span> <span class="n">uminletbc</span><span class="p">(</span><span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">),</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">kb</span><span class="p">)</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uminletbc(jb+1,kb+10),um(ib,jb+1,kb+10)=&#39;</span><span class="p">,</span> <span class="n">uminletbc</span><span class="p">(</span><span class="n">jb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">jb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;uminletbc(je,kb+10),um(ib,je,kb+10)=&#39;</span><span class="p">,</span> <span class="n">uminletbc</span><span class="p">(</span><span class="n">je</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">),</span> <span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">10</span><span class="p">)</span>

            <span class="k">else if</span> <span class="p">(</span><span class="n">iinletgen</span> <span class="o">==</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>

<span class="k">               </span><span class="n">nfile</span> <span class="o">=</span> <span class="n">nfile</span> <span class="o">+</span> <span class="mi">1</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Loading inletfile&#39;</span>
               <span class="k">call </span><span class="n">readinletfile</span>
               <span class="n">u0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">v0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">w0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">uminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storeu0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">vminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storev0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="n">wminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storew0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">ltempeq</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  </span><span class="n">t0inletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storet0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
                  <span class="n">tminletbc</span><span class="p">(:,</span> <span class="p">:)</span> <span class="o">=</span> <span class="n">storet0inletbc</span><span class="p">(:,</span> <span class="p">:,</span> <span class="n">nstepread</span><span class="p">)</span>
               <span class="k">end if</span>
               <span class="c">! determine bulk velocity</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>

            <span class="n">elseif</span> <span class="p">(</span><span class="n">idriver</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="k">then</span> <span class="c">! idriver</span>

               <span class="k">call </span><span class="n">readdriverfile</span>
               <span class="k">call </span><span class="n">drivergen</span>

              <span class="c">!call slabsum(uaverage,kb,ke,u0,ib-1,ie+1,jb-1,je+1,kb-1,ke+1,ib,ie,jb,je,kb,ke)</span>
              <span class="c">!uaverage = uaverage / ((ie-ib+1)*(jge-jgb+1))  ! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
              <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
              <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>
                <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
              <span class="k">end do</span>
<span class="k">              </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">!volume-averaged u-velocity</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span><span class="n">ubulk</span>
              <span class="k">end if</span>

<span class="k">            end if</span> <span class="c">! iinletgen/idriver</span>

            <span class="k">if</span> <span class="p">(</span><span class="n">lper2inout</span><span class="p">)</span> <span class="k">then</span> <span class="c">! if the restart starts from a periodic simulation to in/outflow, lper2inout should be set to .true.</span>
               <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                  write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;per2inout=.true. -&gt; reading inlet profile from prof.inp.XXX and scalar.inp.XXX&#39;</span>
                  <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span> <span class="c">!  read the inlet profile from prof.inp</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                  <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>

                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                        <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                        <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
                  <span class="k">end do</span>
<span class="k">                  </span><span class="n">svprof</span> <span class="o">=</span> <span class="mf">0.</span>
                  <span class="k">if</span> <span class="p">(</span><span class="n">nsv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                     open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                     <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                           <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                           <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                     <span class="k">end do</span>
<span class="k">                     open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                     <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height   sv(1) --------- sv(nsv) &#39;</span>
                     <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                        <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                           <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                           <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                     <span class="k">end do</span>

<span class="k">                  end if</span>
<span class="k">               end if</span> <span class="c">! end if myid==0</span>

               <span class="c">! MPI broadcast numbers reading</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">uprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">vprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">e12prof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">qtprof</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
               <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svprof</span><span class="p">,</span> <span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span> <span class="o">-</span> <span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">))</span><span class="o">*</span><span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

            <span class="k">else if</span> <span class="p">(</span><span class="n">linoutflow</span><span class="p">)</span> <span class="k">then</span> <span class="c">! restart of inoutflow simulation: reproduce inlet boundary condition from restartfile</span>
               <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span>
                  <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span>
                     <span class="n">uprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
                     <span class="n">vprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">thlprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">qtprof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">e12prof</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">e120</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">e120</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
                        <span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">+</span> <span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">))</span><span class="o">/</span><span class="mi">2</span>
                     <span class="n">enddo</span>
                  <span class="n">enddo</span>
               <span class="n">enddo</span>
               <span class="c">! outlet bulk velocity</span>
               <span class="k">call </span><span class="n">slabsum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">u0</span><span class="p">,</span> <span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">je</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">)</span>
               <span class="n">uaverage</span> <span class="o">=</span> <span class="n">uaverage</span><span class="o">/</span><span class="p">((</span><span class="n">ie</span> <span class="o">-</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">jge</span> <span class="o">-</span> <span class="n">jgb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="c">! this gives the i-j-averaged velocity (only correct for equidistant grid?)</span>
               <span class="c">! determine bulk velocity</span>
               <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                  <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">uaverage</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
               <span class="k">end do</span>
<span class="k">               </span><span class="n">ubulk</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">uaverage</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">))</span> <span class="c">! volume-averaged u-velocity</span>
               <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Modstartup: ubulk=&#39;</span><span class="p">,</span> <span class="n">ubulk</span>
            <span class="k">else</span> <span class="c">! else per2per... read svprof regardless...</span>

            <span class="c">! tg3315 read svprof (but do not use regardless of above...)</span>
              <span class="n">svprof</span> <span class="o">=</span> <span class="mf">0.</span>
              <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                 if</span> <span class="p">(</span><span class="n">nsv</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">                    open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                    <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                    <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
                    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
                       <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                          <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                          <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                    <span class="k">end do</span>
<span class="k">                    open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;scalar.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
                    <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;height   sv(1) --------- sv(nsv) &#39;</span>
                    <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
                       <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
                          <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
                          <span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">k</span><span class="p">,</span> <span class="n">n</span><span class="p">),</span> <span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span><span class="p">)</span>
                    <span class="k">end do</span>

<span class="k">                 end if</span>
<span class="k">              end if</span> <span class="c">! end if myid==0</span>

              <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svprof</span><span class="p">,</span> <span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span> <span class="o">-</span> <span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">))</span><span class="o">*</span><span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
          
              <span class="k">if</span> <span class="p">(</span><span class="n">nsv</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span> <span class="c">!tg3315 set these variables here for now and repeat for warmstart</span>

                <span class="k">allocate</span><span class="p">(</span><span class="n">sv_top</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
                <span class="n">sv_top</span><span class="p">(:)</span> <span class="o">=</span> <span class="n">svprof</span><span class="p">(</span><span class="n">ke</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span>

                <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">sv_top</span><span class="p">,</span> <span class="n">nsv</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

              <span class="k">end if</span>

<span class="k">            end if</span> <span class="c">! end if lper2inout</span>

            <span class="n">u0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">v0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">thl0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">qt0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">th0av</span> <span class="o">=</span> <span class="mf">0.0</span>
            <span class="n">sv0av</span> <span class="o">=</span> <span class="mf">0.</span>

            <span class="c">! call slabsum(u0av  ,kb,ke+kh,u0(:,:,kb:ke+kh)  ,ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">u0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(v0av  ,kb,ke+kh,v0(:,:,kb:ke+kh)  ,ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">v0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIv</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIvs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(thl0av,kb,ke+kh,thl0(:,:,kb:ke+kh),ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">thl0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="c">! call slabsum(qt0av,kb,ke+kh,qt0(:,:,kb:ke+kh),ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
            <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">qt0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
               <span class="c">! call slabsum(sv0av(kb,n),kb,ke+kh,sv0(ib-ih,jb-jh,kb,n),ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh,ib,ie,jb,je,kb,ke+kh)</span>
               <span class="k">call </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">sv0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">),</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">),.</span><span class="n">false</span><span class="p">.)</span>
            <span class="k">end do</span>

            <span class="c">! CvH - only do this for fixed timestepping. In adaptive dt comes from restartfile</span>
            <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.</span> <span class="n">ladaptive</span><span class="p">)</span> <span class="n">dt</span> <span class="o">=</span> <span class="n">dtmax</span>
            <span class="c">!  call boundary</span>
         <span class="k">end if</span> <span class="c">! lwarmstart</span>
      <span class="k">end if</span> <span class="c">! not lstratstart</span>
      <span class="c">!-----------------------------------------------------------------</span>
      <span class="c">!    2.1 read and initialise fields</span>
      <span class="c">!-----------------------------------------------------------------</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<span class="k">         open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;lscale.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
         <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39; height  u_geo  v_geo  pgx  pgy  subs     &#39;</span> <span class="p">&amp;</span>
            <span class="p">,</span> <span class="s1">&#39;   dqtdx      dqtdy        dqtdtls     thl_rad &#39;</span>
         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">ug</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">vg</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">wfls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdxls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdyls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdtls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">thlpcar</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">         close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>

         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
            <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(3f7.1,5e12.4)&#39;</span><span class="p">)</span> <span class="p">&amp;</span>
               <span class="n">height</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">ug</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">vg</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">wfls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdxls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdyls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">dqtdtls</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="p">&amp;</span>
               <span class="n">thlpcar</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>

<span class="k">      end if</span> <span class="c">! end myid==0</span>

      <span class="c">! MPI broadcast variables read in</span>

      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">ug</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">vg</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">pgx</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">pgy</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">wfls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">dqtdxls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">dqtdyls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">dqtdtls</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">thlpcar</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>

      <span class="c">!-----------------------------------------------------------------</span>
      <span class="c">!    2.3 make large-scale horizontal pressure gradient</span>
      <span class="c">!-----------------------------------------------------------------</span>

      <span class="c">!******include rho if rho = rho(z) /= 1.0 ***********</span>

      <span class="k">if</span> <span class="p">(</span><span class="n">lprofforc</span><span class="p">)</span> <span class="k">then</span> <span class="c">!tg3315</span>
         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="n">dpdxl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpdx</span> <span class="c">!-om23_gs*ug(k)-pgx(k)-dpdx</span>
            <span class="n">dpdyl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">      else</span>
<span class="k">         do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
            <span class="c">!dpdxl(k) =  om23_gs*vg(k)</span>
            <span class="c">!dpdyl(k) = -om23_gs*ug(k)</span>
            <span class="c">!dpdxl(k) =  -ug(k)</span>
            <span class="c">!dpdyl(k) =  -vg(k)</span>
            <span class="n">dpdxl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">om23_gs</span><span class="o">*</span><span class="n">vg</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pgx</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">dpdx</span> <span class="c">!corriolis forcing and pressure gradient</span>
            <span class="n">dpdyl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="n">om23_gs</span><span class="o">*</span><span class="n">ug</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pgy</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
         <span class="k">end do</span>
<span class="k">      </span><span class="n">endif</span>

      <span class="c">!-----------------------------------------------------------------</span>
      <span class="c">!    2.4 large-scale subsidence, reintroduced ILS13 05.06.2014</span>
      <span class="c">!-----------------------------------------------------------------</span>

      <span class="n">whls</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span>
         <span class="n">whls</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">wfls</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">wfls</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
      <span class="k">end do</span>
<span class="k">      </span><span class="n">whls</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">wfls</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">wfls</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span> <span class="o">-</span> <span class="n">wfls</span><span class="p">(</span><span class="n">ke</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">/</span><span class="n">dzh</span><span class="p">(</span><span class="n">ke</span><span class="p">))</span> <span class="c">! tg3315 31/07/18 removed a 0.5</span>

      <span class="c">!    idtmax = floor(dtmax/tres)</span>
      <span class="n">btime</span> <span class="o">=</span> <span class="n">timee</span>
      <span class="c">!    timeleft=ceiling(runtime/tres)</span>
      <span class="n">timeleft</span> <span class="o">=</span> <span class="n">runtime</span>
      <span class="n">dt_lim</span> <span class="o">=</span> <span class="n">timeleft</span>
      <span class="c">!    write(6,*) &#39;real(dt)*tres= &#39;,rdt, &#39; dtmax/100= &#39;,dtmax/100</span>
      <span class="k">if</span> <span class="p">((</span><span class="n">lwarmstart</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">lstratstart</span><span class="p">))</span> <span class="k">then</span> <span class="c">! tg3315 to have cumulative number on restart files</span>
         <span class="k">read</span> <span class="p">(</span><span class="n">startfile</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">13</span><span class="p">),</span> <span class="s1">&#39;(i4)&#39;</span><span class="p">)</span> <span class="n">ntrun</span>
         <span class="c">! ntrun = ichar(startfile(6:13))</span>
      <span class="k">else</span>
<span class="k">         </span><span class="n">ntrun</span> <span class="o">=</span> <span class="mi">0</span>
      <span class="k">end if</span>
<span class="k">      </span><span class="n">ntimee</span> <span class="o">=</span> <span class="nb">nint</span><span class="p">(</span><span class="n">timee</span><span class="o">/</span><span class="n">dtmax</span><span class="p">)</span>
      <span class="n">tnextrestart</span> <span class="o">=</span> <span class="n">btime</span> <span class="o">+</span> <span class="n">trestart</span>
      <span class="n">tnextfielddump</span> <span class="o">=</span> <span class="n">btime</span> <span class="o">+</span> <span class="n">tfielddump</span>
      <span class="k">deallocate</span> <span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="n">th0av</span><span class="p">)</span>

      <span class="c">!    call boundary</span>

   <span class="k">end subroutine </span><span class="n">readinitfiles</span>
</pre></div>

    </section>
    <br>
    
    
    </div>
  </div>


    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>