<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modfields.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>modfields.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 6.4% of total for source files.">904 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modfields.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">modfields.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modfields.html">modfields</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modfields.f90.html#src">modfields.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modfields.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemodfieldsf90EfferentGraph" width="332pt" height="32pt"
 viewBox="0.00 0.00 332.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modfields.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~modfields.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 328,-28 328,4 -4,4"/>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~modfields.f90</title>
<polygon fill="none" stroke="#000000" points="324,-24 239,-24 239,0 324,0 324,-24"/>
<text text-anchor="middle" x="281.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modfields.f90</text>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~modfields.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-24 113,-24 113,0 203,0 203,-24"/>
<text text-anchor="middle" x="158" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.9983,-12C230.6734,-12 221.8299,-12 213.1616,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.1079,-8.5001 203.1078,-12 213.1078,-15.5001 213.1079,-8.5001"/>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~modfields.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="77,-24 0,-24 0,0 77,0 77,-24"/>
<text text-anchor="middle" x="38.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modfields.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.8222,-12C104.4581,-12 95.6884,-12 87.2244,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.0997,-8.5001 77.0997,-12 87.0997,-15.5001 87.0997,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modfields.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodfieldsf90AfferentGraph" width="641pt" height="362pt"
 viewBox="0.00 0.00 641.00 361.51" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modfields.f90~~AfferentGraph" class="graph" transform="scale(.6762 .6762) rotate(0) translate(4 530.6561)">
<title>sourcefile~~modfields.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-530.6561 944,-530.6561 944,4 -4,4"/>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modfields.f90</title>
<polygon fill="none" stroke="#000000" points="85,-304.6561 0,-304.6561 0,-280.6561 85,-280.6561 85,-304.6561"/>
<text text-anchor="middle" x="42.5" y="-290.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modfields.f90</text>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="217.5,-526.6561 127.5,-526.6561 127.5,-502.6561 217.5,-502.6561 217.5,-526.6561"/>
<text text-anchor="middle" x="172.5" y="-512.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M139.8196,-502.6348C132.9481,-498.9573 126.2122,-494.3403 121,-488.6561 73.8996,-437.2905 53.4618,-354.1137 46.0623,-314.7081"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.5009,-314.0531 44.3097,-304.8172 42.6083,-315.2745 49.5009,-314.0531"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-478.6561 387,-478.6561 387,-454.6561 494,-454.6561 494,-478.6561"/>
<text text-anchor="middle" x="440.5" y="-464.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M406.5904,-454.6502C379.248,-446.5284 339.8308,-438.3363 305.5,-444.6561"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="825,-356.6561 713,-356.6561 713,-332.6561 825,-332.6561 825,-356.6561"/>
<text text-anchor="middle" x="769" y="-342.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M725.0398,-356.7424C691.8572,-365.5082 645.0907,-377.1043 603.5,-384.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.5,-384.6561C532.221,-397.5984 509.0035,-361.0877 440.5,-384.6561"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="652,-356.6561 555,-356.6561 555,-332.6561 652,-332.6561 652,-356.6561"/>
<text text-anchor="middle" x="603.5" y="-342.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M712.9692,-344.6561C696.5835,-344.6561 678.632,-344.6561 662.0919,-344.6561"/>
<polygon fill="#00ff00" stroke="#00ff00" points="662.0024,-341.1562 652.0024,-344.6561 662.0023,-348.1562 662.0024,-341.1562"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="492,-436.6561 389,-436.6561 389,-412.6561 492,-412.6561 492,-436.6561"/>
<text text-anchor="middle" x="440.5" y="-422.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#ff0048" stroke-dasharray="5,2" d="M603.5,-384.6561C566.377,-391.3966 525.1062,-401.5519 493.3811,-409.9431"/>
<polygon fill="#ff0048" stroke="#ff0048" points="492.1922,-406.6378 483.4335,-412.599 493.9979,-413.4009 492.1922,-406.6378"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="213.5,-244.6561 131.5,-244.6561 131.5,-220.6561 213.5,-220.6561 213.5,-244.6561"/>
<text text-anchor="middle" x="172.5" y="-230.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M146.1926,-244.798C126.5456,-253.8658 99.4833,-266.3561 77.932,-276.3028"/>
<polygon fill="#ff0000" stroke="#ff0000" points="76.3812,-273.1637 68.7683,-280.5322 79.3146,-279.5195 76.3812,-273.1637"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="335,-400.6561 276,-400.6561 276,-376.6561 335,-376.6561 335,-400.6561"/>
<text text-anchor="middle" x="305.5" y="-386.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275.7295,-392.9328C237.8205,-396.9946 171.2176,-399.408 121,-375.6561 92.3915,-362.1248 68.9492,-333.2166 55.3473,-313.3568"/>
<polygon fill="#ff0000" stroke="#ff0000" points="58.2345,-311.3773 49.8069,-304.9565 52.391,-315.2314 58.2345,-311.3773"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="216,-324.6561 129,-324.6561 129,-300.6561 216,-300.6561 216,-324.6561"/>
<text text-anchor="middle" x="172.5" y="-310.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="#ff00da" stroke-dasharray="5,2" d="M288.4202,-376.5191C268.5393,-362.5014 236.7992,-340.4898 224,-333.6561 220.9256,-332.0146 217.6945,-330.4186 214.4118,-328.8878"/>
<polygon fill="#ff00da" stroke="#ff00da" points="215.6719,-325.6179 205.1116,-324.7628 212.8337,-332.0167 215.6719,-325.6179"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="816,-236.6561 722,-236.6561 722,-212.6561 816,-212.6561 816,-236.6561"/>
<text text-anchor="middle" x="769" y="-222.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M721.8469,-222.7785C688.6952,-221.9172 643.3258,-221.6597 603.5,-224.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.5,-224.6561C529.0095,-230.2605 515.143,-186.5999 440.5,-183.6561"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M733.5194,-236.6995C726.1307,-240.3597 718.8276,-244.9637 713,-250.6561 687.1217,-275.9337 704.7735,-300.4769 677,-323.6561 672.4309,-327.4693 667.2073,-330.591 661.6985,-333.1464"/>
<polygon fill="#00ff00" stroke="#00ff00" points="660.2099,-329.9721 652.2238,-336.9344 662.8086,-336.4719 660.2099,-329.9721"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="349.5,-314.6561 261.5,-314.6561 261.5,-290.6561 349.5,-290.6561 349.5,-314.6561"/>
<text text-anchor="middle" x="305.5" y="-300.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M440.5,-261.6561C408.7974,-267.5937 373.991,-278.2705 347.6614,-287.2403"/>
<polygon fill="#00ffda" stroke="#00ffda" points="346.3146,-284.0026 338.0095,-290.581 348.6043,-290.6176 346.3146,-284.0026"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="677,-158.6561 530,-158.6561 530,-134.6561 677,-134.6561 677,-158.6561"/>
<text text-anchor="middle" x="603.5" y="-144.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M743.5033,-212.6395C715.3185,-199.356 669.7527,-177.8809 638.2992,-163.0569"/>
<polygon fill="#00daff" stroke="#00daff" points="639.5635,-159.7836 629.0257,-158.6863 636.5792,-166.1156 639.5635,-159.7836"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="493.5,-314.6561 387.5,-314.6561 387.5,-290.6561 493.5,-290.6561 493.5,-314.6561"/>
<text text-anchor="middle" x="440.5" y="-300.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M603.5,-224.6561C569.2328,-227.2342 560.4878,-232.8009 530,-248.6561 512.256,-257.8838 510.9934,-265.1097 494,-275.6561 488.1794,-279.2684 481.8138,-282.8087 475.5686,-286.075"/>
<polygon fill="#0048ff" stroke="#0048ff" points="473.912,-282.9907 466.5822,-290.6409 477.0829,-289.2314 473.912,-282.9907"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="345.5,-272.6561 265.5,-272.6561 265.5,-248.6561 345.5,-248.6561 345.5,-272.6561"/>
<text text-anchor="middle" x="305.5" y="-258.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M603.5,-224.6561C529.422,-230.2294 513.5178,-247.9806 440.5,-261.6561"/>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M440.5,-261.6561C412.8617,-266.8325 381.4793,-266.9375 355.9321,-265.5877"/>
<polygon fill="#0000ff" stroke="#0000ff" points="355.927,-262.0808 345.7299,-264.9563 355.4946,-269.0674 355.927,-262.0808"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643,-314.6561 564,-314.6561 564,-290.6561 643,-290.6561 643,-314.6561"/>
<text text-anchor="middle" x="603.5" y="-300.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#9100ff" stroke-dasharray="5,2" d="M742.7678,-236.7781C733.3699,-241.1361 722.7025,-246.1 713,-250.6561 687.7774,-262.5 659.3535,-276.0027 637.787,-286.28"/>
<polygon fill="#9100ff" stroke="#9100ff" points="636.2159,-283.1516 628.6958,-290.6148 639.2286,-289.4701 636.2159,-283.1516"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648.5,-116.6561 558.5,-116.6561 558.5,-92.6561 648.5,-92.6561 648.5,-116.6561"/>
<text text-anchor="middle" x="603.5" y="-102.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M758.4972,-212.6486C736.5211,-187.6299 686.9005,-131.7283 677,-125.6561 671.2234,-122.1131 664.8271,-119.148 658.288,-116.6713"/>
<polygon fill="#ff0091" stroke="#ff0091" points="659.2554,-113.3032 648.6609,-113.3815 656.9918,-119.9271 659.2554,-113.3032"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="215,-446.6561 130,-446.6561 130,-422.6561 215,-422.6561 215,-446.6561"/>
<text text-anchor="middle" x="172.5" y="-432.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.2802,-422.6075C134.8481,-418.8121 127.2406,-414.1482 121,-408.6561 90.0588,-381.4257 65.677,-339.4012 52.7328,-314.1107"/>
<polygon fill="#ff0000" stroke="#ff0000" points="55.7852,-312.3885 48.194,-304.9976 49.5193,-315.5093 55.7852,-312.3885"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M554.6918,-354.2082C521.9543,-361.2035 478.11,-371.7165 440.5,-384.6561"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M556.7907,-332.6206C538.1199,-327.8097 516.4501,-322.226 496.9118,-317.1916"/>
<polygon fill="#0048ff" stroke="#0048ff" points="497.7731,-313.7993 487.2161,-314.6933 496.0264,-320.5779 497.7731,-313.7993"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="218,-366.6561 127,-366.6561 127,-342.6561 218,-342.6561 218,-366.6561"/>
<text text-anchor="middle" x="172.5" y="-352.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M141.5232,-342.5766C134.7102,-339.767 127.5696,-336.7029 121,-333.6561 104.9813,-326.2269 87.5367,-317.2121 73.1694,-309.5294"/>
<polygon fill="#ff0000" stroke="#ff0000" points="74.6815,-306.3684 64.2183,-304.7032 71.3593,-312.5298 74.6815,-306.3684"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="211,-122.6561 134,-122.6561 134,-98.6561 211,-98.6561 211,-122.6561"/>
<text text-anchor="middle" x="172.5" y="-108.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M133.7575,-122.7329C129.1339,-125.2109 124.7369,-128.1597 121,-131.6561 79.4055,-170.5735 57.1446,-236.2271 47.8454,-270.4307"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.3936,-269.7987 45.2735,-280.3569 51.1699,-271.5544 44.3936,-269.7987"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.9905,-290.6305C237.9672,-283.7585 203.5778,-275.8833 172.5,-272.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M172.5,-272.6561C146.7635,-269.9835 118.3409,-273.5952 94.6524,-278.4516"/>
<polygon fill="#ff0000" stroke="#ff0000" points="93.838,-275.0469 84.8116,-280.5944 95.3274,-281.8866 93.838,-275.0469"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M277.7724,-290.5899C271.8333,-287.8032 265.6485,-284.7453 260,-281.6561 243.3419,-272.5456 240.4956,-268.0576 224,-258.6561 218.4608,-255.4991 212.4921,-252.3045 206.6499,-249.2862"/>
<polygon fill="#ffda00" stroke="#ffda00" points="208.1546,-246.125 197.6534,-244.7191 204.9859,-252.3667 208.1546,-246.125"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M571.2069,-158.6589C538.6671,-169.6364 486.7823,-184.1114 440.5,-183.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M440.5,-183.6561C321.3275,-182.4836 285.7095,-155.4128 172.5,-192.6561"/>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="351,-154.6561 260,-154.6561 260,-130.6561 351,-130.6561 351,-154.6561"/>
<text text-anchor="middle" x="305.5" y="-140.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275.6459,-154.6971C248.8563,-165.3056 208.3519,-180.8616 172.5,-192.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M172.5,-192.6561C149.3249,-200.2801 141.4437,-198.342 121,-211.6561 95.6162,-228.1874 72.247,-254.315 57.7259,-272.406"/>
<polygon fill="#ff0000" stroke="#ff0000" points="54.7473,-270.5329 51.338,-280.5642 60.2588,-274.8484 54.7473,-270.5329"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M259.7289,-131.6435C247.2779,-128.6477 233.7495,-125.3928 221.1454,-122.3602"/>
<polygon fill="#00ff91" stroke="#00ff91" points="221.8148,-118.9215 211.2735,-119.985 220.1773,-125.7273 221.8148,-118.9215"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M398.061,-314.7248C383.2946,-318.3587 366.5373,-321.8577 351,-323.6561 310.8238,-328.3063 297.8043,-338.0292 260,-323.6561 239.9902,-316.0483 242.3608,-302.6631 224,-291.6561 203.0751,-279.1119 196.7664,-275.176 172.5,-272.6561"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffda" stroke-dasharray="5,2" d="M387.1444,-302.6561C378.1483,-302.6561 368.8013,-302.6561 359.7819,-302.6561"/>
<polygon fill="#00ffda" stroke="#00ffda" points="359.7742,-299.1562 349.7741,-302.6561 359.7741,-306.1562 359.7742,-299.1562"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M401.8144,-290.6206C386.8451,-285.9634 369.5482,-280.5822 353.7784,-275.676"/>
<polygon fill="#0000ff" stroke="#0000ff" points="354.7796,-272.3221 344.1912,-272.6933 352.7,-279.0061 354.7796,-272.3221"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M294.9638,-248.5833C273.095,-225.0707 220.7835,-176.772 172.5,-192.6561"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M265.2347,-252.1792C252.0688,-249.4074 237.2689,-246.2916 223.4236,-243.3768"/>
<polygon fill="#ffda00" stroke="#ffda00" points="224.0543,-239.933 213.5478,-241.2977 222.6122,-246.7828 224.0543,-239.933"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="824.5,-78.6561 713.5,-78.6561 713.5,-54.6561 824.5,-54.6561 824.5,-78.6561"/>
<text text-anchor="middle" x="769" y="-64.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M735.213,-54.6534C637.2255,-22.1676 348.7313,56.7785 172.5,-70.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M172.5,-70.6561C153.0141,-85.3363 138.3848,-72.5395 121,-89.6561 69.4511,-140.4096 51.1006,-228.783 45.1238,-270.1242"/>
<polygon fill="#ff0000" stroke="#ff0000" points="41.6269,-269.8693 43.7758,-280.2439 48.5656,-270.7936 41.6269,-269.8693"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M563.7467,-311.5145C552.5644,-314.6698 540.5747,-318.7 530,-323.6561 486.4116,-344.0848 486.0195,-368.9953 440.5,-384.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M440.5,-384.6561C416.6399,-392.865 410.2047,-393.7447 387,-403.6561 349.7115,-419.5831 345.3774,-437.3152 305.5,-444.6561"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M305.5,-444.6561C224.7118,-459.528 190.555,-499.3596 121,-455.6561 71.3501,-424.4596 52.3679,-352.0792 45.7286,-315.1719"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.1224,-314.24 44.0441,-304.9416 42.2154,-315.3774 49.1224,-314.24"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M563.6257,-302.6561C545.5651,-302.6561 523.7765,-302.6561 503.5803,-302.6561"/>
<polygon fill="#0048ff" stroke="#0048ff" points="503.5059,-299.1562 493.5059,-302.6561 503.5059,-306.1562 503.5059,-299.1562"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="224,-164.6561 121,-164.6561 121,-140.6561 224,-140.6561 224,-164.6561"/>
<text text-anchor="middle" x="172.5" y="-150.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M142.3106,-164.7394C134.8781,-168.5343 127.2627,-173.1893 121,-178.6561 90.315,-205.4413 65.8501,-246.7333 52.8205,-271.5797"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.6796,-270.0347 48.2485,-280.5325 55.9137,-273.2184 49.6796,-270.0347"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M128.8502,-305.9407C118.1201,-304.2899 106.5168,-302.5048 95.4025,-300.7949"/>
<polygon fill="#ff0000" stroke="#ff0000" points="95.7882,-297.3132 85.3722,-299.2518 94.7237,-304.2318 95.7882,-297.3132"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M558.423,-94.61C461.4102,-74.0149 236.4388,-32.0626 172.5,-70.6561"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M388.7548,-431.458C363.5656,-434.9891 332.8796,-439.6159 305.5,-444.6561"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modfields.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="940,-256.6561 861,-256.6561 861,-232.6561 940,-232.6561 940,-256.6561"/>
<text text-anchor="middle" x="900.5" y="-242.2561" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="#ff4800" stroke-dasharray="5,2" d="M896.4412,-256.7371C887.5726,-281.2355 864.0739,-336.872 825,-365.6561 728.5467,-436.7092 586.1251,-457.8422 504.4134,-464.0849"/>
<polygon fill="#ff4800" stroke="#ff4800" points="503.9967,-460.6056 494.2705,-464.8069 504.4938,-467.5879 503.9967,-460.6056"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#ff9100" stroke-dasharray="5,2" d="M884.638,-256.7184C861.8314,-274.0619 819.5975,-306.1789 792.9706,-326.4275"/>
<polygon fill="#ff9100" stroke="#ff9100" points="790.7595,-323.7118 784.9182,-332.551 794.9967,-329.2837 790.7595,-323.7118"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ffda00" stroke-dasharray="5,2" d="M769,-146.6561C730.1033,-130.9697 718.1582,-159.5931 677,-167.6561 596.1184,-183.501 575.6639,-186.5254 494,-197.6561 398.8806,-210.6207 287.4045,-221.8802 223.8523,-227.929"/>
<polygon fill="#ffda00" stroke="#ffda00" points="223.3208,-224.4636 213.6951,-228.8902 223.9803,-231.4325 223.3208,-224.4636"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#91ff00" stroke-dasharray="5,2" d="M860.6888,-238.6011C849.814,-236.9472 837.8117,-235.1217 826.1741,-233.3517"/>
<polygon fill="#91ff00" stroke="#91ff00" points="826.4911,-229.8598 816.0784,-231.8163 825.4385,-236.7802 826.4911,-229.8598"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M769,-264.6561C721.3015,-273.8406 721.2681,-303.6601 677,-323.6561 672.0866,-325.8754 666.8817,-327.9193 661.6016,-329.7874"/>
<polygon fill="#00ff00" stroke="#00ff00" points="660.4469,-326.4828 652.0627,-332.9601 662.6563,-333.125 660.4469,-326.4828"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M888.7686,-232.5598C867.2508,-211.2056 819.0654,-167.1497 769,-146.6561"/>
<path fill="none" stroke="#00ff91" stroke-dasharray="5,2" d="M769,-146.6561C723.1366,-127.8825 724.3404,-98.3116 677,-83.6561 516.0829,-33.8398 312.6743,-73.9631 221.0918,-97.1175"/>
<polygon fill="#00ff91" stroke="#00ff91" points="220.0841,-93.7627 211.2718,-99.6443 221.8286,-100.5419 220.0841,-93.7627"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#00daff" stroke-dasharray="5,2" d="M769,-146.6561C743.5992,-136.4124 714.1685,-133.7972 687.2307,-134.5498"/>
<polygon fill="#00daff" stroke="#00daff" points="686.8802,-131.0617 677.0422,-134.9943 687.1853,-138.055 686.8802,-131.0617"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M860.9451,-249.8456C834.7658,-253.4832 799.7258,-258.7397 769,-264.6561"/>
<path fill="none" stroke="#0048ff" stroke-dasharray="5,2" d="M769,-264.6561C664.4303,-284.7915 635.283,-265.6645 530,-281.6561 518.7721,-283.3615 506.8713,-285.7413 495.539,-288.2888"/>
<polygon fill="#0048ff" stroke="#0048ff" points="494.7082,-284.8885 485.7579,-290.558 496.2902,-291.7074 494.7082,-284.8885"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="#4800ff" stroke-dasharray="5,2" d="M892.9842,-232.5851C879.8611,-211.7262 851.623,-167.7953 825,-132.6561 812.9405,-116.7389 798.311,-99.5621 787.0294,-86.7227"/>
<polygon fill="#4800ff" stroke="#4800ff" points="789.4108,-84.1327 780.1598,-78.9684 784.1712,-88.7745 789.4108,-84.1327"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#9100ff" stroke-dasharray="5,2" d="M769,-264.6561C729.7793,-272.2082 685.7176,-282.4101 652.9243,-290.3417"/>
<polygon fill="#9100ff" stroke="#9100ff" points="652.0161,-286.9605 643.1267,-292.7249 653.6706,-293.7622 652.0161,-286.9605"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modfields.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#ff0091" stroke-dasharray="5,2" d="M769,-146.6561C733.3721,-132.2879 691.4039,-121.7037 658.6449,-114.7545"/>
<polygon fill="#ff0091" stroke="#ff0091" points="659.2931,-111.3145 648.7912,-112.7143 657.8739,-118.1691 659.2931,-111.3145"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemodfieldsf90AfferentGraph = svgPanZoom('#sourcefilemodfieldsf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modfields.html">modfields</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modfields.f90.html#src">modfields.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file modfields.f90</span>
<a name="ln-2"></a><span class="c">!!  Declares, allocates and initializes the 3D fields</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="c">!&gt;</span>
<a name="ln-5"></a><span class="c">!!  Declares, allocates and initializes the 3D fields</span>
<a name="ln-6"></a><span class="c">!&gt;</span>
<a name="ln-7"></a>
<a name="ln-8"></a>
<a name="ln-9"></a><span class="k">module </span><span class="n">modfields</span>
<a name="ln-10"></a>
<a name="ln-11"></a>  <span class="k">implicit none</span>
<a name="ln-12"></a><span class="k">  save</span>
<a name="ln-13"></a>
<a name="ln-14"></a>  <span class="c">! Prognostic variables</span>
<a name="ln-15"></a>
<a name="ln-16"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">worksave</span><span class="p">(:)</span>      <span class="c">!&lt;   Used in POISR!</span>
<a name="ln-17"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">um</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   x-component of velocity at time step t-1</span>
<a name="ln-18"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vm</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   y-component of velocity at time step t-1</span>
<a name="ln-19"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wm</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   z-component of velocity at time step t-1</span>
<a name="ln-20"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlm</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   liq. water pot. temperature at time step t-1</span>
<a name="ln-21"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e12m</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   turb. kin. energy at time step t-1</span>
<a name="ln-22"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtm</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   total specific humidity at time step t</span>
<a name="ln-23"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">u0</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   x-component of velocity at time step t</span>
<a name="ln-24"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">v0</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   y-component of velocity at time step t</span>
<a name="ln-25"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">w0</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   z-component of velocity at time step t</span>
<a name="ln-26"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">pres0</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   pressure at time step t</span>
<a name="ln-27"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">thl0</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   liq. water pot. temperature at time step t</span>
<a name="ln-28"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thl0h</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   3d-field of theta_l at half levels for kappa scheme</span>
<a name="ln-29"></a>
<a name="ln-30"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qt0h</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;  3d-field of q_tot   at half levels for kappa scheme</span>
<a name="ln-31"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e120</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   turb. kin. energy at time step t</span>
<a name="ln-32"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">qt0</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   total specific humidity at time step t</span>
<a name="ln-33"></a>
<a name="ln-34"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">up</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   tendency of um</span>
<a name="ln-35"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vp</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   tendency of vm</span>
<a name="ln-36"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wp</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   tendency of wm</span>
<a name="ln-37"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlp</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   tendency of thlm</span>
<a name="ln-38"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e12p</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   tendency of e12m</span>
<a name="ln-39"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtp</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   tendency of qtm</span>
<a name="ln-40"></a>
<a name="ln-41"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svm</span><span class="p">(:,:,:,:)</span>     <span class="c">!&lt;  scalar sv(n) at time step t-1</span>
<a name="ln-42"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">sv0</span><span class="p">(:,:,:,:)</span>     <span class="c">!&lt;  scalar sv(n) at time step t</span>
<a name="ln-43"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svp</span><span class="p">(:,:,:,:)</span>     <span class="c">!&lt;  tendency of sv(n)</span>
<a name="ln-44"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpp</span><span class="p">(:,:,:,:)</span>
<a name="ln-45"></a> 
<a name="ln-46"></a>  <span class="c">! Diagnostic variables</span>
<a name="ln-47"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">mindist</span><span class="p">(:,:,:)</span>   <span class="c">!&lt; minimal distance of cell center to a wall</span>
<a name="ln-48"></a>
<a name="ln-49"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">shear</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   wall shear (last rank indicates the type of shear componenten (uym, uyp, etc.)</span>
<a name="ln-50"></a>
<a name="ln-51"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">momfluxb</span><span class="p">(:,:,:)</span> <span class="c">!&lt; fields for the wallfluxes of total momentum  </span>
<a name="ln-52"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tfluxb</span><span class="p">(:,:,:)</span>  <span class="c">!&lt; heat</span>
<a name="ln-53"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qfluxb</span><span class="p">(:,:,:)</span>  <span class="c">!&lt; and moisture</span>
<a name="ln-54"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">cth</span><span class="p">(:,:,:)</span>     <span class="c">!&lt; heat transfer coefficient</span>
<a name="ln-55"></a>
<a name="ln-56"></a>  <span class="c">!tg3315 added variables (statistics, masking and others) </span>
<a name="ln-57"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIc</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at cell centres</span>
<a name="ln-58"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIu</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at x-direction half cells</span>
<a name="ln-59"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIv</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at y-direction half cells</span>
<a name="ln-60"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIw</span><span class="p">(:,:,:)</span>        <span class="c">!&lt; Masking matrix for blocks at z-direction half cells</span>
<a name="ln-61"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuw</span><span class="p">(:,:,:)</span>       <span class="c">!&lt; Masking matrix for blocks at x-and z-direction half cells</span>
<a name="ln-62"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvw</span><span class="p">(:,:,:)</span>       <span class="c">!&lt; Masking matrix for blocks at y- and z-direction half cells</span>
<a name="ln-63"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuv</span><span class="p">(:,:,:)</span>       <span class="c">!&lt; Masking matrix for blocks at x- and y-direction half cells  </span>
<a name="ln-64"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIct</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at cell centre that span 1:jtot</span>
<a name="ln-65"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIwt</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at z-direction half cells that span 1:jtot</span>
<a name="ln-66"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuwt</span><span class="p">(:,:)</span>        <span class="c">!&lt; 2-D Masking matrix for blocks at x- and z-direction half cells that span 1:jtot</span>
<a name="ln-67"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIut</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at x-direction half cells that span 1:jtot</span>
<a name="ln-68"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvt</span><span class="p">(:,:)</span>         <span class="c">!&lt; 2-D Masking matrix for blocks at y-direction half cells that span 1:jtot</span>
<a name="ln-69"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIcs</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at cell centres that span ib:ie and 1:jtot</span>
<a name="ln-70"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIus</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at x-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-71"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvs</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at y-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-72"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIws</span><span class="p">(:)</span>           <span class="c">!&lt; 1-D Masking matrix for blocks at z-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-73"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuws</span><span class="p">(:)</span>          <span class="c">!&lt; 1-D Masking matrix for blocks at x- and z-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-74"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIvws</span><span class="p">(:)</span>          <span class="c">!&lt; 1-D Masking matrix for blocks at y- and z-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-75"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">IIuvs</span><span class="p">(:)</span>          <span class="c">!&lt; 1-D Masking matrix for blocks at x- and y-direction half cells that span ib:ie and 1:jtot</span>
<a name="ln-76"></a>
<a name="ln-77"></a><span class="c">!  integer              :: IIbl = 1          !&lt; Switch for if layer at kb is all blocks</span>
<a name="ln-78"></a>
<a name="ln-79"></a>  <span class="c">! statistical fields following notation &quot;[statistical name][averaging directions - x,y,z,t][position in grid - i,j,k]&quot;</span>
<a name="ln-80"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uyt</span><span class="p">(:,:)</span> 
<a name="ln-81"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uytik</span><span class="p">(:,:)</span>
<a name="ln-82"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vyt</span><span class="p">(:,:)</span>        
<a name="ln-83"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wyt</span><span class="p">(:,:)</span>        
<a name="ln-84"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wytik</span><span class="p">(:,:)</span>
<a name="ln-85"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlyt</span><span class="p">(:,:)</span>      
<a name="ln-86"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtyt</span><span class="p">(:,:)</span>      
<a name="ln-87"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlytk</span><span class="p">(:,:)</span>      
<a name="ln-88"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sca1yt</span><span class="p">(:,:)</span>     
<a name="ln-89"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sca2yt</span><span class="p">(:,:)</span>     
<a name="ln-90"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sca3yt</span><span class="p">(:,:)</span>     
<a name="ln-91"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlsgsyt</span><span class="p">(:,:)</span>     
<a name="ln-92"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtsgsyt</span><span class="p">(:,:)</span>
<a name="ln-93"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">usgsyt</span><span class="p">(:,:)</span> 
<a name="ln-94"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsgsyt</span><span class="p">(:,:)</span>    
<a name="ln-95"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1sgsyt</span><span class="p">(:,:)</span>
<a name="ln-96"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2sgsyt</span><span class="p">(:,:)</span>
<a name="ln-97"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3sgsyt</span><span class="p">(:,:)</span>
<a name="ln-98"></a>
<a name="ln-99"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uxyt</span><span class="p">(:)</span>        
<a name="ln-100"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vxyt</span><span class="p">(:)</span>        
<a name="ln-101"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wxyt</span><span class="p">(:)</span>        
<a name="ln-102"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlxyt</span><span class="p">(:)</span>        
<a name="ln-103"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtxyt</span><span class="p">(:)</span>
<a name="ln-104"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pxyt</span><span class="p">(:)</span>  <span class="c">! bss116      </span>
<a name="ln-105"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">usgsxyt</span><span class="p">(:)</span>
<a name="ln-106"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlsgsxyt</span><span class="p">(:)</span>
<a name="ln-107"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vsgsxyt</span><span class="p">(:)</span>
<a name="ln-108"></a>
<a name="ln-109"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uwtik</span><span class="p">(:,:,:)</span>
<a name="ln-110"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wthltk</span><span class="p">(:,:,:)</span>
<a name="ln-111"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wqttk</span><span class="p">(:,:,:)</span>
<a name="ln-112"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlthlt</span><span class="p">(:,:,:)</span>
<a name="ln-113"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtqtt</span><span class="p">(:,:,:)</span>
<a name="ln-114"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1sv1t</span><span class="p">(:,:,:)</span>
<a name="ln-115"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2sv2t</span><span class="p">(:,:,:)</span>
<a name="ln-116"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3sv3t</span><span class="p">(:,:,:)</span>
<a name="ln-117"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4sv4t</span><span class="p">(:,:,:)</span>
<a name="ln-118"></a>  <span class="c">! real, allocatable :: sv1max(:,:,:)</span>
<a name="ln-119"></a>  <span class="c">! real, allocatable :: sv2max(:,:,:)</span>
<a name="ln-120"></a>  <span class="c">! real, allocatable :: sv3max(:,:,:)</span>
<a name="ln-121"></a>  <span class="c">! real, allocatable :: sv4max(:,:,:)</span>
<a name="ln-122"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">PSSt</span><span class="p">(:,:,:)</span>
<a name="ln-123"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uutc</span><span class="p">(:,:,:)</span>
<a name="ln-124"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vvtc</span><span class="p">(:,:,:)</span>
<a name="ln-125"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wwtc</span><span class="p">(:,:,:)</span>
<a name="ln-126"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vwtjk</span><span class="p">(:,:,:)</span>
<a name="ln-127"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uvtij</span><span class="p">(:,:,:)</span>
<a name="ln-128"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">utik</span><span class="p">(:,:,:)</span>
<a name="ln-129"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wtik</span><span class="p">(:,:,:)</span>
<a name="ln-130"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vtjk</span><span class="p">(:,:,:)</span>
<a name="ln-131"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wtjk</span><span class="p">(:,:,:)</span>
<a name="ln-132"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">utij</span><span class="p">(:,:,:)</span>
<a name="ln-133"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vtij</span><span class="p">(:,:,:)</span>
<a name="ln-134"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wmt</span><span class="p">(:,:,:)</span>
<a name="ln-135"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thltk</span><span class="p">(:,:,:)</span>
<a name="ln-136"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qttk</span><span class="p">(:,:,:)</span>
<a name="ln-137"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlt</span><span class="p">(:,:,:)</span>
<a name="ln-138"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">utc</span><span class="p">(:,:,:)</span>
<a name="ln-139"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vtc</span><span class="p">(:,:,:)</span>
<a name="ln-140"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wtc</span><span class="p">(:,:,:)</span>
<a name="ln-141"></a>
<a name="ln-142"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vmt</span><span class="p">(:,:,:)</span>
<a name="ln-143"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">umt</span><span class="p">(:,:,:)</span>
<a name="ln-144"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1t</span><span class="p">(:,:,:)</span>
<a name="ln-145"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2t</span><span class="p">(:,:,:)</span>
<a name="ln-146"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3t</span><span class="p">(:,:,:)</span>
<a name="ln-147"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4t</span><span class="p">(:,:,:)</span>
<a name="ln-148"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1tk</span><span class="p">(:,:,:)</span>
<a name="ln-149"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2tk</span><span class="p">(:,:,:)</span>
<a name="ln-150"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3tk</span><span class="p">(:,:,:)</span>
<a name="ln-151"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4tk</span><span class="p">(:,:,:)</span>
<a name="ln-152"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv1tk</span><span class="p">(:,:,:)</span>
<a name="ln-153"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv2tk</span><span class="p">(:,:,:)</span>
<a name="ln-154"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv3tk</span><span class="p">(:,:,:)</span> 
<a name="ln-155"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wsv4tk</span><span class="p">(:,:,:)</span>
<a name="ln-156"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv1sgst</span><span class="p">(:,:,:)</span>
<a name="ln-157"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2sgst</span><span class="p">(:,:,:)</span>
<a name="ln-158"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv3sgst</span><span class="p">(:,:,:)</span>
<a name="ln-159"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv4sgst</span><span class="p">(:,:,:)</span>
<a name="ln-160"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtt</span><span class="p">(:,:,:)</span> <span class="c">! bss116</span>
<a name="ln-161"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pt</span><span class="p">(:,:,:)</span>  <span class="c">! bss116</span>
<a name="ln-162"></a>
<a name="ln-163"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice</span><span class="p">(:,:)</span> 
<a name="ln-164"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice2</span><span class="p">(:,:)</span> 
<a name="ln-165"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice3</span><span class="p">(:,:)</span> 
<a name="ln-166"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice4</span><span class="p">(:,:)</span> 
<a name="ln-167"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice5</span><span class="p">(:,:)</span> 
<a name="ln-168"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice6</span><span class="p">(:,:)</span> 
<a name="ln-169"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice7</span><span class="p">(:,:)</span> 
<a name="ln-170"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">slice8</span><span class="p">(:,:)</span>
<a name="ln-171"></a>
<a name="ln-172"></a>  <span class="c">! fields for scalar sources</span>
<a name="ln-173"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">scar</span><span class="p">(:,:)</span>
<a name="ln-174"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">scarl</span><span class="p">(:,:)</span>
<a name="ln-175"></a>
<a name="ln-176"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uav</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   time-averaged u-velocity</span>
<a name="ln-177"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vav</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   time-averaged u-velocity</span>
<a name="ln-178"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wav</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   time-averaged u-velocity </span>
<a name="ln-179"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlav</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   time-averaged liquid temperature</span>
<a name="ln-180"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-averaged specific humidity</span>
<a name="ln-181"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-averaged liquid water</span>
<a name="ln-182"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">presav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-averaged pressure</span>
<a name="ln-183"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svav</span><span class="p">(:,:,:,:)</span>    <span class="c">!&lt;   time-averaged scalar concentration </span>
<a name="ln-184"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">viscratioav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-averaged viscosity ratio; turb viscosity / molecular viscosity</span>
<a name="ln-185"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">umint</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   um interpolated to cell-center</span>
<a name="ln-186"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vmint</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   vm interpolated to cell-center</span>
<a name="ln-187"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wmint</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   wm interpolated to cell-center</span>
<a name="ln-188"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thl2av</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: liquid temperature squared</span>
<a name="ln-189"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ql2av</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: liquid temperature squared</span>
<a name="ln-190"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qt2av</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: liquid temperature squared</span>
<a name="ln-191"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv2av</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: scalar concentration squared</span>
<a name="ln-192"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uuav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: u-velocity squared</span>
<a name="ln-193"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vvav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: v-velocity squared</span>
<a name="ln-194"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wwav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: w-velocity squared</span>
<a name="ln-195"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uvav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: u-velocity times v-velocity</span>
<a name="ln-196"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uwav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: u-velocity times fluctuation</span>
<a name="ln-197"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vwav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   time-average: v-velocity times w-velocity</span>
<a name="ln-198"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thluav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: thl times u-velocity</span>
<a name="ln-199"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlvav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: thl times v-velocity</span>
<a name="ln-200"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlwav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: thl times w-velocity</span>
<a name="ln-201"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlthlav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl times thl</span>
<a name="ln-202"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qluav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: ql times u-velocity</span>
<a name="ln-203"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlvav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: ql times v-velocity</span>
<a name="ln-204"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlwav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: ql times w-velocity</span>
<a name="ln-205"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtuav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: qt times u-velocity</span>
<a name="ln-206"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtvav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: qt times v-velocity</span>
<a name="ln-207"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtwav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: qt times w-velocity</span>
<a name="ln-208"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svuav</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: sv times u-velocity</span>
<a name="ln-209"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svvav</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: sv times v-velocity</span>
<a name="ln-210"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svwav</span><span class="p">(:,:,:,:)</span>   <span class="c">!&lt;   time-average: sv times w-velocity</span>
<a name="ln-211"></a><span class="c">!  real, allocatable :: tekm(:,:,:)     !tekm = ekm - numol !tg3315</span>
<a name="ln-212"></a>
<a name="ln-213"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">upupav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: u&#39;u&#39;</span>
<a name="ln-214"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vpvpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: v&#39;v&#39;</span>
<a name="ln-215"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wpwpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: w&#39;w&#39;</span>
<a name="ln-216"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpthlpav</span><span class="p">(:,:,:)</span><span class="c">!&lt;   time-average: thl&#39;thl&#39;</span>
<a name="ln-217"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpqlpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;ql&#39;</span>
<a name="ln-218"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpqtpav</span><span class="p">(:,:,:)</span><span class="c">!&lt;   time-average: thl&#39;thl&#39;</span>
<a name="ln-219"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpsvpav</span><span class="p">(:,:,:,:)</span><span class="c">!&lt;   time-average: sv&#39;sv&#39;</span>
<a name="ln-220"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">upvpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: u&#39;v&#39;</span>
<a name="ln-221"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">upwpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: u&#39;w&#39;</span>
<a name="ln-222"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vpwpav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average: v&#39;w&#39;</span>
<a name="ln-223"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpupav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl&#39;u&#39;</span>
<a name="ln-224"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpvpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl&#39;v&#39;</span>
<a name="ln-225"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpwpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: thl&#39;w&#39;</span>
<a name="ln-226"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpupav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;u&#39;</span>
<a name="ln-227"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpvpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;v&#39;</span>
<a name="ln-228"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlpwpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: ql&#39;w&#39;</span>
<a name="ln-229"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpupav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: qt&#39;u&#39;</span>
<a name="ln-230"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpvpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: qt&#39;v&#39;</span>
<a name="ln-231"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtpwpav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average: qt&#39;w&#39;</span>
<a name="ln-232"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpupav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average: sv&#39;u&#39;</span>
<a name="ln-233"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpvpav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average: sv&#39;v&#39;</span>
<a name="ln-234"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svpwpav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average: sv&#39;w&#39;</span>
<a name="ln-235"></a>
<a name="ln-236"></a><span class="c">! SGS fields</span>
<a name="ln-237"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uusgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-238"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vvsgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-239"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wwsgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-240"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uwsgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-241"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlusgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-242"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlwsgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-243"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlusgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-244"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlwsgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-245"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtusgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-246"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtwsgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-247"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svusgsav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-248"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svwsgsav</span><span class="p">(:,:,:,:)</span> <span class="c">!&lt;   time-average subgrid contribution (estimate)</span>
<a name="ln-249"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tkesgsav</span><span class="p">(:,:,:)</span>   <span class="c">!&lt;   time-average subgrid turbulence kinetic energy</span>
<a name="ln-250"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">nusgsav</span><span class="p">(:,:,:)</span>    <span class="c">!&lt;   time-average subgrid viscosity</span>
<a name="ln-251"></a>
<a name="ln-252"></a><span class="c">! Resolved dissipation &#39;terms&#39;</span>
<a name="ln-253"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">strain2av</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   &lt;Sij*Sij&gt; used to compute &lt;Sij&#39;*Sij&#39;&gt; = &lt;Sij*Sij&gt; - &lt;S&gt;ij*&lt;S&gt;ij</span>
<a name="ln-254"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">disssgsav</span><span class="p">(:,:,:)</span>  <span class="c">!&lt;   mean subgrid dissipation: &lt;nu_sgs*2.*Sij*Sij&gt;</span>
<a name="ln-255"></a>                                         <span class="c">!&lt;   which is used for resolved dissipation = nu*2*&lt;Sij&#39;*Sij&#39;&gt; </span>
<a name="ln-256"></a><span class="c">! TKE budget terms:</span>
<a name="ln-257"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tvmx</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for viscous transport: &lt;u*d/dxj(2*nu*S1j)&gt;</span>
<a name="ln-258"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tvmy</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for viscous transport: &lt;v*d/dxj(2*nu*S2j)&gt;</span>
<a name="ln-259"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tvmz</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for viscous transport: &lt;w*d/dxj(2*nu*S3j)&gt;</span>
<a name="ln-260"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tpm</span> <span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by pressure fluctuations</span>
<a name="ln-261"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ttmx</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by turb. vel. fluctuations</span>
<a name="ln-262"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ttmy</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by turb. vel. fluctuations</span>
<a name="ln-263"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ttmz</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   needed for transport by turb. vel. fluctuations</span>
<a name="ln-264"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmx1</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid x = &lt;u*d/dxj(2*nu_t*S1j)&gt;</span>
<a name="ln-265"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmy1</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid y = &lt;v*d/dxj(2*nu_t*S2j)&gt;</span>
<a name="ln-266"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmz1</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid z = &lt;w*d/dxj(2*nu_t*S3j)&gt;</span>
<a name="ln-267"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmx2</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid x = &lt;d/dxj(2*nu_t*S1j)&gt;</span>
<a name="ln-268"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmy2</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid y = &lt;d/dxj(2*nu_t*S2j)&gt;</span>
<a name="ln-269"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tsgsmz2</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   needed for transport by subgrid z = &lt;d/dxj(2*nu_t*S3j)&gt;</span>
<a name="ln-270"></a><span class="c">! TKE budget results (written to files):</span>
<a name="ln-271"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_vav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   viscous transport</span>
<a name="ln-272"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_sgsav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   transport by subgrid</span>
<a name="ln-273"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_pav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   transport by pressure fluctuations</span>
<a name="ln-274"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_tav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   transport by by turb. vel. fluctuations</span>
<a name="ln-275"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_tav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   production by shear</span>
<a name="ln-276"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_bav</span><span class="p">(:,:,:)</span>        <span class="c">!&lt;   production/destruction by buoyancy</span>
<a name="ln-277"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">d_sgsav</span><span class="p">(:,:,:)</span>      <span class="c">!&lt;   dissipation by subgrid</span>
<a name="ln-278"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">tkeadv</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   advection of tke </span>
<a name="ln-279"></a>  
<a name="ln-280"></a><span class="c">! TKE budget results (written to tkedump): !tg3315</span>
<a name="ln-281"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_v</span><span class="p">(:)</span>            <span class="c">!&lt;   viscous transport</span>
<a name="ln-282"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_sgs</span><span class="p">(:)</span>          <span class="c">!&lt;   transport by subgrid</span>
<a name="ln-283"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_p</span><span class="p">(:)</span>            <span class="c">!&lt;   transport by pressurefluctuations</span>
<a name="ln-284"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">t_t</span><span class="p">(:)</span>            <span class="c">!&lt;   transport by by turb. vel. fluctuations</span>
<a name="ln-285"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_t</span><span class="p">(:)</span>            <span class="c">!&lt;   production by shear</span>
<a name="ln-286"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">p_b</span><span class="p">(:)</span>            <span class="c">!&lt;   production/destruction by buoyancy</span>
<a name="ln-287"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">d_sgs</span><span class="p">(:)</span>          <span class="c">!&lt;   dissipation by subgrid</span>
<a name="ln-288"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">adv</span><span class="p">(:)</span>            <span class="c">!&lt;   advection of tke</span>
<a name="ln-289"></a>
<a name="ln-290"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span><span class="p">,</span> <span class="k">target</span> <span class="kd">::</span> <span class="n">ql0</span><span class="p">(:,:,:)</span>       <span class="c">!&lt;   liquid water content</span>
<a name="ln-291"></a>
<a name="ln-292"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thv0h</span><span class="p">(:,:,:)</span>     <span class="c">!&lt;   theta_v at half level</span>
<a name="ln-293"></a>
<a name="ln-294"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">whls</span><span class="p">(:)</span>          <span class="c">!&lt;   large scale vert velocity at half levels</span>
<a name="ln-295"></a>
<a name="ln-296"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">presf</span><span class="p">(:)</span>         <span class="c">!&lt;   hydrostatic pressure at full level</span>
<a name="ln-297"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">presh</span><span class="p">(:)</span>         <span class="c">!&lt;   hydrostatic pressure at half level</span>
<a name="ln-298"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">exnf</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at full level</span>
<a name="ln-299"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">exnh</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at half level</span>
<a name="ln-300"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thvf</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at full level</span>
<a name="ln-301"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thvh</span><span class="p">(:)</span>          <span class="c">!&lt;   hydrostatic exner function at half level</span>
<a name="ln-302"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">rhof</span><span class="p">(:)</span>          <span class="c">!&lt;   slab averaged density at full level</span>
<a name="ln-303"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qt0av</span><span class="p">(:)</span>         <span class="c">!&lt;   slab averaged q_tot</span>
<a name="ln-304"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ql0av</span><span class="p">(:)</span>         <span class="c">!&lt;   slab averaged q_liq</span>
<a name="ln-305"></a>
<a name="ln-306"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thl0av</span><span class="p">(:)</span>        <span class="c">!&lt;   slab averaged th_liq</span>
<a name="ln-307"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">u0av</span><span class="p">(:)</span>          <span class="c">!&lt;   slab averaged u</span>
<a name="ln-308"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">v0av</span><span class="p">(:)</span>          <span class="c">!&lt;   slab averaged v</span>
<a name="ln-309"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ug</span><span class="p">(:)</span>            <span class="c">!&lt;   geostrophic u-wind</span>
<a name="ln-310"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vg</span><span class="p">(:)</span>            <span class="c">!&lt;   geostrophic v-wind</span>
<a name="ln-311"></a>
<a name="ln-312"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pgx</span><span class="p">(:)</span>            <span class="c">!&lt;   driving pressure gradient in x, this is dp/dx [(\Delta p) / (\Delta x)] across one cell, already divided by \rho -&gt; in units of [m/s^2]</span>
<a name="ln-313"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">pgy</span><span class="p">(:)</span>            <span class="c">!&lt;   driving pressure gradient in y [m/s^2]</span>
<a name="ln-314"></a>
<a name="ln-315"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dpdxl</span><span class="p">(:)</span>                      <span class="c">!&lt;   large scale pressure x-gradient [m/s^2]</span>
<a name="ln-316"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dpdyl</span><span class="p">(:)</span>                      <span class="c">!&lt;   large scale pressure y-gradient [m/s^2]</span>
<a name="ln-317"></a>
<a name="ln-318"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dthldxls</span><span class="p">(:)</span>                   <span class="c">!&lt;   large scale x-gradient of th_liq</span>
<a name="ln-319"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dthldyls</span><span class="p">(:)</span>                   <span class="c">!&lt;   large scale y-gradient of th_liq</span>
<a name="ln-320"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dqtdxls</span><span class="p">(:)</span>                    <span class="c">!&lt;   large scale x-gradient of q_tot</span>
<a name="ln-321"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dqtdyls</span><span class="p">(:)</span>                    <span class="c">!&lt;   large scale y-gradient of q_tot</span>
<a name="ln-322"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dqtdtls</span><span class="p">(:)</span>                    <span class="c">!&lt;   large scale y-gradient of q_tot</span>
<a name="ln-323"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dudxls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale x-gradient of u</span>
<a name="ln-324"></a>
<a name="ln-325"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dudyls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale y-gradient of u</span>
<a name="ln-326"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dvdxls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale x-gradient of v</span>
<a name="ln-327"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dvdyls</span><span class="p">(:)</span>                     <span class="c">!&lt;   large scale y-gradient of v</span>
<a name="ln-328"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wfls</span>  <span class="p">(:)</span>                     <span class="c">!&lt;   large scale y-gradient of v</span>
<a name="ln-329"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ql0h</span><span class="p">(:,:,:)</span>
<a name="ln-330"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dthvdz</span><span class="p">(:,:,:)</span>                 <span class="c">!&lt;   theta_v at half level</span>
<a name="ln-331"></a>
<a name="ln-332"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlprof</span><span class="p">(:)</span>                    <span class="c">!&lt;   initial thl-profile</span>
<a name="ln-333"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qtprof</span><span class="p">(:)</span>                     <span class="c">!&lt;   initial qt-profile</span>
<a name="ln-334"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uprof</span><span class="p">(:)</span>                      <span class="c">!&lt;   initial u-profile</span>
<a name="ln-335"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vprof</span><span class="p">(:)</span>                      <span class="c">!&lt;   initial v-profile</span>
<a name="ln-336"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">e12prof</span><span class="p">(:)</span>                    <span class="c">!&lt;   initial subgrid TKE profile</span>
<a name="ln-337"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">sv0av</span><span class="p">(:,:)</span>                    <span class="c">!&lt;   slab average of sv(n)</span>
<a name="ln-338"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">svprof</span><span class="p">(:,:)</span>                   <span class="c">!&lt;   initial sv(n)-profile</span>
<a name="ln-339"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">qlprof</span><span class="p">(:)</span>
<a name="ln-340"></a>
<a name="ln-341"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">thlpcar</span><span class="p">(:)</span>                    <span class="c">!&lt; prescribed radiatively forced thl tendency</span>
<a name="ln-342"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">SW_up_TOA</span><span class="p">(:,:),</span> <span class="n">SW_dn_TOA</span><span class="p">(:,:),</span> <span class="n">LW_up_TOA</span><span class="p">(:,:),</span> <span class="n">LW_dn_TOA</span><span class="p">(:,:)</span>
<a name="ln-343"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">uout</span><span class="p">(:)</span>                      <span class="c">!&lt; height average outlet velocity (used in convective outflow BC)</span>
<a name="ln-344"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wout</span><span class="p">(:)</span>                      <span class="c">!&lt; j-averaged top velocity</span>
<a name="ln-345"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">friction</span><span class="p">(:)</span>                  <span class="c">!&lt; skin-friction coeff: from y-line-averaged shear </span>
<a name="ln-346"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">momthick</span><span class="p">(:)</span>                  <span class="c">!&lt; momentum thickness: y-line average </span>
<a name="ln-347"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">displthick</span><span class="p">(:)</span>                <span class="c">!&lt; displacement thickness: y-line average </span>
<a name="ln-348"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">uouttot</span>                      <span class="c">!&lt; area-averaged outflow velocity (used in convective outflow BC) </span>
<a name="ln-349"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">wouttot</span>                      <span class="c">!&lt; area-averaveraged top velocity</span>
<a name="ln-350"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">udef</span>
<a name="ln-351"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">vdef</span>
<a name="ln-352"></a>  <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">vout</span><span class="p">(:)</span>
<a name="ln-353"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">vouttot</span>
<a name="ln-354"></a>
<a name="ln-355"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">thlsrcdt</span>                     <span class="c">! thlsrc -&gt; thlsrcdt is used to solve 1-order ODE for thlsrc </span>
<a name="ln-356"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">dgdt</span>                         <span class="c">! g = dp/dx -&gt; dgdt is used to solve 1-order ODE for dpdx </span>
<a name="ln-357"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">dpdx</span> <span class="o">=</span> <span class="mf">0.</span>                   <span class="c">! dpdx given in namoptions</span>
<a name="ln-358"></a>
<a name="ln-359"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">uoutarea</span>                     <span class="c">!&lt; area of domain u-outlet</span>
<a name="ln-360"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">voutarea</span>                     <span class="c">!&lt; area of domain v-outlet</span>
<a name="ln-361"></a>  <span class="kt">real</span>              <span class="kd">::</span> <span class="n">fluidvol</span>                     <span class="c">!&lt; fluid volume (excluding blocks)</span>
<a name="ln-362"></a>
<a name="ln-363"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncname</span><span class="p">(:,:)</span>
<a name="ln-364"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstaty</span><span class="p">(:,:)</span>
<a name="ln-365"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatyt</span><span class="p">(:,:)</span>
<a name="ln-366"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstattke</span><span class="p">(:,:)</span>
<a name="ln-367"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatxy</span><span class="p">(:,:)</span>
<a name="ln-368"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatxyt</span><span class="p">(:,:)</span>
<a name="ln-369"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatslice</span><span class="p">(:,:)</span>
<a name="ln-370"></a>  <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">),</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ncstatt</span><span class="p">(:,:)</span>
<a name="ln-371"></a>
<a name="ln-372"></a>  <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">wall</span><span class="p">(:,:,:,:)</span>             <span class="c">!&lt; wall(ic,jc,kc,1-5) gives the global indices of the wall closest to cell center ic,jc,kc. The 4th and 5th integer gives the corresponding shear components</span>
<a name="ln-373"></a>
<a name="ln-374"></a><span class="k">contains</span>
<a name="ln-375"></a>  <span class="c">!&gt; Allocate and initialize the prognostic variables</span>
<a name="ln-376"></a>  <span class="k">subroutine </span><span class="n">initfields</span>
<a name="ln-377"></a>
<a name="ln-378"></a>    <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">nsv</span><span class="p">,</span><span class="n">jtot</span><span class="p">,</span><span class="n">imax</span><span class="p">,</span><span class="n">jmax</span><span class="p">,</span><span class="n">kmax</span><span class="p">,&amp;</span>
<a name="ln-379"></a>         <span class="n">ihc</span><span class="p">,</span><span class="n">jhc</span><span class="p">,</span><span class="n">khc</span><span class="c">!, iadv_kappa,iadv_sv</span>
<a name="ln-380"></a>    <span class="c">! Allocation of prognostic variables</span>
<a name="ln-381"></a>    <span class="k">implicit none</span>
<a name="ln-382"></a>
<a name="ln-383"></a><span class="k">    allocate</span><span class="p">(</span><span class="n">worksave</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">imax</span><span class="o">*</span><span class="n">jmax</span><span class="o">*</span><span class="n">kmax</span><span class="p">))</span>
<a name="ln-384"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">um</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-385"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-386"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-387"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-388"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e12m</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-389"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-390"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-391"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-392"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-393"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pres0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-394"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-395"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-396"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-397"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e120</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-398"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-399"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-400"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">up</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-401"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-402"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-403"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-404"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e12p</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-405"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-406"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svm</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">khc</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-407"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv0</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">khc</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-408"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-409"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpp</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span> 
<a name="ln-410"></a>
<a name="ln-411"></a>    <span class="c">! Allocation of diagnostic variables</span>
<a name="ln-412"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">mindist</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-413"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thv0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-414"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">whls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-415"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">presf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-416"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">presh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-417"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">exnf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-418"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">exnh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-419"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thvf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-420"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thvh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-421"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">rhof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-422"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-423"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-424"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-425"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">u0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-426"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">v0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-427"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ug</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-428"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vg</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-429"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pgx</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-430"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pgy</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-431"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dpdxl</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-432"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dpdyl</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-433"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dthldxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-434"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dthldyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-435"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dqtdxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-436"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dqtdyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-437"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dqtdtls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-438"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dudxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-439"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dudyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-440"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dvdxls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-441"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dvdyls</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-442"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wfls</span>  <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-443"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql0h</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-444"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">dthvdz</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-445"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-446"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-447"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-448"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-449"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-450"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">e12prof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-451"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv0av</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-452"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svprof</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-453"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpcar</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-454"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uout</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>         <span class="c">! height average outlet velocity (used in convective outflow BC)</span>
<a name="ln-455"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vout</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-456"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wout</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>         <span class="c">! j -averaged top velocity</span>
<a name="ln-457"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">friction</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>     <span class="c">! line-averaged (along j) skin friction </span>
<a name="ln-458"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">momthick</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>     <span class="c">! line-averaged (along j) momentum thickness </span>
<a name="ln-459"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">displthick</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">))</span>   <span class="c">! line-averaged (along j) displacement thickness </span>
<a name="ln-460"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">SW_up_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-461"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">SW_dn_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-462"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">LW_up_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-463"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">LW_dn_TOA</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">))</span>
<a name="ln-464"></a>
<a name="ln-465"></a>    <span class="c">! allocate averaged variables</span>
<a name="ln-466"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-467"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-468"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-469"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-470"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-471"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-472"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">presav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-473"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-474"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">viscratioav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-475"></a>
<a name="ln-476"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIc</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-477"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIu</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-478"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIv</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-479"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIw</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-480"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuw</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-481"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvw</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-482"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuv</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ihc</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ihc</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jhc</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jhc</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-483"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIct</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-484"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIwt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-485"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuwt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-486"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIut</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-487"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-488"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIcs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-489"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIus</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-490"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-491"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-492"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-493"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIvws</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-494"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">IIuvs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">khc</span><span class="p">))</span>
<a name="ln-495"></a>
<a name="ln-496"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-497"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uytik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-498"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-499"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-500"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wytik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-501"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-502"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-503"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlytk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-504"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sca1yt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-505"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sca2yt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-506"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sca3yt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-507"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">usgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-508"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlsgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-509"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtsgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-510"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-511"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1sgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-512"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2sgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-513"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3sgsyt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-514"></a>
<a name="ln-515"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-516"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-517"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-518"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-519"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-520"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-521"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">usgsxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-522"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlsgsxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-523"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vsgsxyt</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-524"></a>
<a name="ln-525"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uwtik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-526"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wthltk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-527"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wqttk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-528"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlthlt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-529"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtqtt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-530"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1sv1t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-531"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2sv2t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-532"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3sv3t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-533"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4sv4t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-534"></a>    <span class="c">! allocate(sv1max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-535"></a>    <span class="c">! allocate(sv2max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-536"></a>    <span class="c">! allocate(sv3max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-537"></a>    <span class="c">! allocate(sv4max(ib:ie,jb:je,kb:ke+kh))</span>
<a name="ln-538"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">PSSt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-539"></a>
<a name="ln-540"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uutc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-541"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vvtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-542"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wwtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-543"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vwtjk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-544"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uvtij</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-545"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">utik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-546"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wtik</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-547"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vtjk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-548"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wtjk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-549"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">utij</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-550"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vtij</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-551"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wmt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-552"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thltk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-553"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qttk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-554"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-555"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">utc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-556"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-557"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wtc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-558"></a>
<a name="ln-559"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">umt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-560"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vmt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-561"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-562"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-563"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-564"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4t</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-565"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-566"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-567"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-568"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-569"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv1tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-570"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv2tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-571"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv3tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-572"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wsv4tk</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-573"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv1sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-574"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-575"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv3sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-576"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv4sgst</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-577"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-578"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">pt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-579"></a>
<a name="ln-580"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-581"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-582"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice3</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>  
<a name="ln-583"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice4</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-584"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice5</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span> 
<a name="ln-585"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice6</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>  
<a name="ln-586"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice7</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-587"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">slice8</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-588"></a>
<a name="ln-589"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">scar</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">jtot</span><span class="p">))</span>
<a name="ln-590"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">scarl</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">))</span>
<a name="ln-591"></a>
<a name="ln-592"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thl2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-593"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ql2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-594"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qt2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-595"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">sv2av</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-596"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">umint</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-597"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vmint</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-598"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wmint</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-599"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uuav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-600"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vvav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-601"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wwav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-602"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-603"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-604"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-605"></a>
<a name="ln-606"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thluav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-607"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-608"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-609"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlthlav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-610"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qluav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-611"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-612"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-613"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtuav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-614"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtvav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-615"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtwav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-616"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svuav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-617"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svvav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-618"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svwav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-619"></a>
<a name="ln-620"></a>    <span class="c">! &lt;x&#39;x&gt; ( = &lt;xx&gt; -&lt;x&gt;&lt;x&gt; )</span>
<a name="ln-621"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">upupav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-622"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vpvpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-623"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wpwpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-624"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">upvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-625"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">upwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-626"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-627"></a>
<a name="ln-628"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpthlpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-629"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-630"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-631"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-632"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpqlpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-633"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-634"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-635"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-636"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpqtpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-637"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-638"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-639"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-640"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpsvpav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-641"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpupav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-642"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpvpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-643"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svpwpav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-644"></a> 
<a name="ln-645"></a><span class="c">! Subgrid</span>
<a name="ln-646"></a>
<a name="ln-647"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uusgsav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-648"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">vvsgsav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-649"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-650"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">uwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-651"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlusgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-652"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">thlwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-653"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlusgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-654"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qlwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-655"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtusgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-656"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qtwsgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>   <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-657"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tkesgsav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-658"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svusgsav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-659"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">svwsgsav</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-660"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">nusgsav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span>   <span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span>   <span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span>   <span class="p">))</span>
<a name="ln-661"></a>
<a name="ln-662"></a><span class="c">! resolved dissipation</span>
<a name="ln-663"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">strain2av</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-664"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">disssgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-665"></a>
<a name="ln-666"></a><span class="c">! TKE budget terms</span>
<a name="ln-667"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tvmx</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-668"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tvmy</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-669"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tvmz</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-670"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tpm</span>   <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-671"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ttmx</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>    <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-672"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ttmy</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span>  <span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-673"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">ttmz</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span>  <span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span>    <span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-674"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmx1</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-675"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmy1</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-676"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmz1</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-677"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmx2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-678"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmy2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-679"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tsgsmz2</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-680"></a>    
<a name="ln-681"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_pav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-682"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_vav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-683"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_tav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-684"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_sgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-685"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_tav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-686"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_bav</span>  <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-687"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">d_sgsav</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-688"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">tkeadv</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-689"></a>
<a name="ln-690"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_p</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-691"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_v</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-692"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_t</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-693"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">t_sgs</span>  <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-694"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_t</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-695"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">p_b</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-696"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">d_sgs</span>  <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-697"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">adv</span>    <span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-698"></a>
<a name="ln-699"></a>    <span class="c">! allocate wall shear-stress terms (immersed boundaries)</span>
<a name="ln-700"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">shear</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="mi">1</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">:</span><span class="mi">12</span><span class="p">))</span>    <span class="c">! halo is set to 1</span>
<a name="ln-701"></a><span class="c">!     allocate(shear(ib:ie,jb-1:je+1,kb:ke,12)</span>
<a name="ln-702"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">momfluxb</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-703"></a>  <span class="c">!  write(*,*) &quot;allocate momfluxb, indeces:&quot;,ib-ih,ie+ih,jb-jh,je+jh,kb,ke+kh </span>
<a name="ln-704"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">tfluxb</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-705"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">qfluxb</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-706"></a>   <span class="k">allocate</span><span class="p">(</span><span class="n">cth</span><span class="p">(</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="o">-</span><span class="n">kh</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">))</span>
<a name="ln-707"></a>
<a name="ln-708"></a>
<a name="ln-709"></a>    <span class="n">momfluxb</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tfluxb</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qfluxb</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">cth</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-710"></a>
<a name="ln-711"></a>
<a name="ln-712"></a>    <span class="k">allocate</span><span class="p">(</span><span class="n">wall</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">,</span><span class="mi">5</span><span class="p">))</span>              <span class="c">! </span>
<a name="ln-713"></a>
<a name="ln-714"></a>    <span class="n">um</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">u0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">up</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-715"></a>    <span class="n">vm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">v0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-716"></a>    <span class="n">wm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">w0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-717"></a>    <span class="n">pres0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-718"></a>    <span class="n">thlm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-719"></a>    <span class="n">qtm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qt0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-720"></a>    <span class="n">e12m</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">e120</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">e12p</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-721"></a>    <span class="n">svm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svp</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpp</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-722"></a>
<a name="ln-723"></a>    <span class="n">ql0</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qt0h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-724"></a>    <span class="n">thv0h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl0h</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-725"></a>    <span class="n">mindist</span><span class="o">=</span><span class="mf">1.0e10</span><span class="p">;</span>
<a name="ln-726"></a>    <span class="n">presf</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">presh</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">exnf</span><span class="o">=</span><span class="mf">1.</span><span class="p">;</span><span class="n">exnh</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thvf</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thvh</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">rhof</span><span class="o">=</span><span class="mf">0.</span>    <span class="c">! OG   </span>
<a name="ln-727"></a>    <span class="c">!Exner function should be called in startup and just be initialised here</span>
<a name="ln-728"></a>    <span class="n">qt0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ql0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">u0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">v0av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv0av</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-729"></a>    <span class="n">thlprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vprof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">e12prof</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svprof</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-730"></a>    <span class="n">ug</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vg</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pgx</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pgy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dpdxl</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dpdyl</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wfls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">whls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpcar</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span><span class="n">uout</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vout</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wout</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">udef</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vdef</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uouttot</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wouttot</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vouttot</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-731"></a>    <span class="n">dthldxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dthldyls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dqtdxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dqtdyls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dudxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dudyls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dvdxls</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">dvdyls</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-732"></a>    <span class="n">dthvdz</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-733"></a>    <span class="n">SW_up_TOA</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">SW_dn_TOA</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">LW_up_TOA</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">LW_dn_TOA</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-734"></a>
<a name="ln-735"></a>    <span class="n">uyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uytik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wytik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlytk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sca1yt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sca2yt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sca3yt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlsgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtsgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1sgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2sgsyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3sgsyt</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-736"></a>    <span class="n">usgsyt</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-737"></a>    <span class="n">uxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">usgsxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vsgsxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlsgsxyt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-738"></a>    <span class="n">uwtik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wthltk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wqttk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlthlt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtqtt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1sv1t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2sv2t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3sv3t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4sv4t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uutc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vvtc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wwtc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vwtjk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uvtij</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">utik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wtik</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wtjk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vtjk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">utij</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vtij</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-739"></a>    <span class="n">wmt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thltk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qttk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice2</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice3</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice4</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice5</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">utc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vtc</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wtc</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-740"></a>    <span class="n">slice6</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice7</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">slice8</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">umt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vmt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4tk</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-741"></a>    <span class="n">wsv1tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsv2tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsv3tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wsv4tk</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv1sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv3sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv4sgst</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtt</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">pt</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-742"></a>    <span class="n">PSSt</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!sv1max = 0.; sv2max = 0.; sv3max = 0.; sv4max = 0.</span>
<a name="ln-743"></a>
<a name="ln-744"></a>    <span class="n">scar</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">scarl</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-745"></a>
<a name="ln-746"></a>    <span class="n">IIc</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIu</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIv</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIct</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuwt</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIut</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvt</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIwt</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIcs</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIus</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvs</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIws</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuws</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIvws</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuw</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span><span class="n">IIuvs</span><span class="o">=</span><span class="mi">1</span>
<a name="ln-747"></a>
<a name="ln-748"></a>    <span class="n">uav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">viscratioav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uuav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vvav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-749"></a>    <span class="n">wwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uvav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">sv2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thl2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ql2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qt2av</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">presav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-750"></a>    <span class="n">thluav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlvav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlwav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlthlav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svuav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svvav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svwav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-751"></a>    <span class="n">shear</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-752"></a>    <span class="n">upupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpthlpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpqlpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpqtpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpsvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">upvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">upwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vpwpav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-753"></a>    <span class="n">thlpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpwpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpupav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpvpav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svpwpav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-754"></a>    <span class="n">umint</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vmint</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wmint</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-755"></a><span class="c">! SGS</span>
<a name="ln-756"></a>    <span class="n">uusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">vvsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">wwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">uwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">thlwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qlwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">qtusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span>
<a name="ln-757"></a>    <span class="n">svusgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">svwsgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tkesgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">nusgsav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-758"></a><span class="c">! Resolved dissipation </span>
<a name="ln-759"></a>    <span class="n">strain2av</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-760"></a><span class="c">! Subgrid dissipation </span>
<a name="ln-761"></a>    <span class="n">disssgsav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-762"></a><span class="c">! TKE budget</span>
<a name="ln-763"></a>    <span class="n">t_vav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tvmx</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tvmy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tvmz</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tpm</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ttmx</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ttmy</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">ttmz</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_sgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_tav</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-764"></a>    <span class="n">tsgsmx1</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmy1</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmz1</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmx2</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmy2</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tsgsmz2</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-765"></a>    <span class="n">t_pav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_tav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_bav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">d_sgsav</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">tkeadv</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_p</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_v</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">t_sgs</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_t</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">p_b</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">d_sgs</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">adv</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-766"></a>    <span class="c">! domain fluid volume and area calculations</span>
<a name="ln-767"></a>    <span class="n">uoutarea</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">voutarea</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span><span class="n">fluidvol</span><span class="o">=</span><span class="mf">0.</span>
<a name="ln-768"></a>  <span class="k">end subroutine </span><span class="n">initfields</span>
<a name="ln-769"></a>
<a name="ln-770"></a>  <span class="c">!&gt; Deallocate the fields</span>
<a name="ln-771"></a>  <span class="k">subroutine </span><span class="n">exitfields</span>
<a name="ln-772"></a>    <span class="k">implicit none</span>
<a name="ln-773"></a>
<a name="ln-774"></a><span class="k">    deallocate</span><span class="p">(</span><span class="n">um</span><span class="p">,</span><span class="n">vm</span><span class="p">,</span><span class="n">wm</span><span class="p">,</span><span class="n">thlm</span><span class="p">,</span><span class="n">e12m</span><span class="p">,</span><span class="n">qtm</span><span class="p">,</span><span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">pres0</span><span class="p">,</span><span class="n">thl0</span><span class="p">,</span><span class="n">thl0h</span><span class="p">,</span><span class="n">qt0h</span><span class="p">,</span><span class="n">e120</span><span class="p">,</span><span class="n">qt0</span><span class="p">)</span>
<a name="ln-775"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">up</span><span class="p">,</span><span class="n">vp</span><span class="p">,</span><span class="n">wp</span><span class="p">,</span><span class="n">thlp</span><span class="p">,</span><span class="n">e12p</span><span class="p">,</span><span class="n">qtp</span><span class="p">)</span>
<a name="ln-776"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">svm</span><span class="p">,</span><span class="n">sv0</span><span class="p">,</span><span class="n">svp</span><span class="p">,</span><span class="n">svpp</span><span class="p">)</span>
<a name="ln-777"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">ql0</span><span class="p">,</span><span class="n">ql0h</span><span class="p">,</span><span class="n">thv0h</span><span class="p">,</span><span class="n">dthvdz</span><span class="p">,</span><span class="n">whls</span><span class="p">,</span><span class="n">presf</span><span class="p">,</span><span class="n">presh</span><span class="p">,</span><span class="n">exnf</span><span class="p">,</span><span class="n">exnh</span><span class="p">,</span><span class="n">thvf</span><span class="p">,</span><span class="n">thvh</span><span class="p">,</span><span class="n">rhof</span><span class="p">,</span><span class="n">qt0av</span><span class="p">,</span><span class="n">ql0av</span><span class="p">,</span><span class="n">thl0av</span><span class="p">,</span><span class="n">u0av</span><span class="p">,</span><span class="n">v0av</span><span class="p">)</span>
<a name="ln-778"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">ug</span><span class="p">,</span><span class="n">vg</span><span class="p">,</span><span class="n">pgx</span><span class="p">,</span><span class="n">pgy</span><span class="p">,</span><span class="n">dpdxl</span><span class="p">,</span><span class="n">dpdyl</span><span class="p">,</span><span class="n">dthldxls</span><span class="p">,</span><span class="n">dthldyls</span><span class="p">,</span><span class="n">dqtdxls</span><span class="p">,</span><span class="n">dqtdyls</span><span class="p">,</span><span class="n">dqtdtls</span><span class="p">,</span><span class="n">dudxls</span><span class="p">,</span><span class="n">dudyls</span><span class="p">,</span><span class="n">dvdxls</span><span class="p">,</span><span class="n">dvdyls</span><span class="p">,</span><span class="n">wfls</span><span class="p">)</span>
<a name="ln-779"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">thlprof</span><span class="p">,</span><span class="n">qtprof</span><span class="p">,</span><span class="n">uprof</span><span class="p">,</span><span class="n">vprof</span><span class="p">,</span><span class="n">e12prof</span><span class="p">,</span><span class="n">sv0av</span><span class="p">,</span><span class="n">svprof</span><span class="p">)</span>
<a name="ln-780"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">thlpcar</span><span class="p">)</span>
<a name="ln-781"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">momfluxb</span><span class="p">,</span><span class="n">tfluxb</span><span class="p">,</span><span class="n">qfluxb</span><span class="p">,</span><span class="n">cth</span><span class="p">)</span>
<a name="ln-782"></a>    <span class="k">deallocate</span><span class="p">(</span><span class="n">SW_up_TOA</span><span class="p">,</span><span class="n">SW_dn_TOA</span><span class="p">,</span><span class="n">LW_up_TOA</span><span class="p">,</span><span class="n">LW_dn_TOA</span><span class="p">)</span>
<a name="ln-783"></a>
<a name="ln-784"></a>  <span class="k">end subroutine </span><span class="n">exitfields</span>
<a name="ln-785"></a>
<a name="ln-786"></a><span class="k">end module </span><span class="n">modfields</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>