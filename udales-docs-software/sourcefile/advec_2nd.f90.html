<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>advec_2nd.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>advec_2nd.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.9% of total for source files.">132 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/advec_2nd.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">advec_2nd.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-0">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-0" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../proc/advecc_2nd.html">advecc_2nd</a>
      
      <a class="list-group-item" href="../proc/advecu_2nd.html">advecu_2nd</a>
      
      <a class="list-group-item" href="../proc/advecv_2nd.html">advecv_2nd</a>
      
      <a class="list-group-item" href="../proc/advecw_2nd.html">advecw_2nd</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/advec_2nd.f90.html#src">advec_2nd.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~advec_2nd.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileadvec_2ndf90EfferentGraph" width="608pt" height="317pt"
 viewBox="0.00 0.00 608.00 316.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 312.6598)">
<title>sourcefile~~advec_2nd.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-312.6598 604,-312.6598 604,4 -4,4"/>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~advec_2nd.f90</title>
<polygon fill="none" stroke="#000000" points="600,-146 509,-146 509,-122 600,-122 600,-146"/>
<text text-anchor="middle" x="554.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">advec_2nd.f90</text>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="77,-227 0,-227 0,-203 77,-203 77,-227"/>
<text text-anchor="middle" x="38.5" y="-212.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M299.5,-296C217.5711,-284.506 126.1585,-251.0889 76.1944,-230.9475"/>
<polygon fill="#ff0000" stroke="#ff0000" points="77.3507,-227.6393 66.7693,-227.1066 74.709,-234.1217 77.3507,-227.6393"/>
</g>
<!-- sourcefile~modibmdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modibmdata.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modibmdata.f90.html" xlink:title="modibmdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-24 249,-24 249,0 350,0 350,-24"/>
<text text-anchor="middle" x="299.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibmdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibmdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibmdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M540.8615,-121.9539C519.7032,-103.9899 476.9672,-70.5282 434.5,-54"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M434.5,-54C408.1473,-43.7436 378.1727,-34.2124 353.1731,-26.831"/>
<polygon fill="#ff0000" stroke="#ff0000" points="354.0807,-23.4499 343.5006,-24.0085 352.1198,-30.1697 354.0807,-23.4499"/>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-227 113,-227 113,-203 203,-203 203,-227"/>
<text text-anchor="middle" x="158" y="-212.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M434.5,-296C379.0761,-318.9824 358.9181,-304.3359 299.5,-296"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M299.5,-296C271.5896,-292.0844 264.0144,-289.9846 239,-277 216.5138,-265.3277 193.8636,-247.3387 178.2551,-233.7382"/>
<polygon fill="#ff0000" stroke="#ff0000" points="180.571,-231.1139 170.7729,-227.0828 175.9186,-236.3442 180.571,-231.1139"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="473,-146 396,-146 396,-122 473,-122 473,-146"/>
<text text-anchor="middle" x="434.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M508.7908,-134C500.4091,-134 491.6323,-134 483.1677,-134"/>
<polygon fill="#ff0000" stroke="#ff0000" points="483.0453,-130.5001 473.0453,-134 483.0452,-137.5001 483.0453,-130.5001"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="342,-268 257,-268 257,-244 342,-244 342,-268"/>
<text text-anchor="middle" x="299.5" y="-253.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M550.5184,-146.0091C538.9371,-178.5975 501.7489,-268.1142 434.5,-296"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M434.5,-296C416.5687,-303.4355 368.9257,-286.2492 335.3388,-272.1299"/>
<polygon fill="#ff0000" stroke="#ff0000" points="336.4159,-268.7838 325.8455,-268.065 333.6605,-275.2187 336.4159,-268.7838"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="332.5,-66 266.5,-66 266.5,-42 332.5,-42 332.5,-66"/>
<text text-anchor="middle" x="299.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M434.5,-54C405.3522,-42.6557 369.9076,-43.1388 342.6521,-46.201"/>
<polygon fill="#ff0000" stroke="#ff0000" points="342.1126,-42.7414 332.6373,-47.4816 343.0005,-49.6849 342.1126,-42.7414"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M112.8222,-215C104.4581,-215 95.6884,-215 87.2244,-215"/>
<polygon fill="#00ff00" stroke="#00ff00" points="87.0997,-211.5001 77.0997,-215 87.0997,-218.5001 87.0997,-211.5001"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M411.1895,-121.9452C361.6816,-98.1352 243.5785,-50.9562 158,-94"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modibmdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modibmdata.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M428.6764,-121.8842C417.9649,-100.8318 393.1615,-57.417 360,-33 357.924,-31.4714 355.7277,-30.0475 353.45,-28.7217"/>
<polygon fill="#00ffff" stroke="#00ffff" points="354.8421,-25.503 344.3431,-24.0816 351.6642,-31.74 354.8421,-25.503"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M395.7627,-145.348C346.9314,-159.653 262.8644,-184.2802 208.891,-200.0916"/>
<polygon fill="#00ffff" stroke="#00ffff" points="207.7911,-196.7666 199.1784,-202.9369 209.7591,-203.4843 207.7911,-196.7666"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M428.6764,-146.1158C417.9649,-167.1682 393.1615,-210.583 360,-235 357.3141,-236.9777 354.4268,-238.7802 351.4223,-240.4215"/>
<polygon fill="#00ffff" stroke="#00ffff" points="349.6424,-237.3935 342.1411,-244.8756 352.671,-243.7044 349.6424,-237.3935"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge13" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M419.7544,-121.7985C405.1814,-110.1134 381.9465,-92.4652 360,-80 353.9222,-76.5479 347.2965,-73.2617 340.7315,-70.259"/>
<polygon fill="#00ffff" stroke="#00ffff" points="341.7898,-66.9009 331.2271,-66.0764 338.9702,-73.3079 341.7898,-66.9009"/>
</g>
<!-- sourcefile~modsurfdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~modsurfdata.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/modsurfdata.f90.html" xlink:title="modsurfdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-226 249,-226 249,-202 350,-202 350,-226"/>
<text text-anchor="middle" x="299.5" y="-211.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsurfdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modsurfdata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modsurfdata.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M419.7544,-146.2015C405.1814,-157.8866 381.9465,-175.5348 360,-188 353.9222,-191.4521 347.2965,-194.7383 340.7315,-197.741"/>
<polygon fill="#00ffff" stroke="#00ffff" points="338.9702,-194.6921 331.2271,-201.9236 341.7898,-201.0991 338.9702,-194.6921"/>
</g>
<!-- sourcefile~modsubgriddata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~modsubgriddata.f90</title>
<g id="a_sourcefile~~advec_2nd.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/modsubgriddata.f90.html" xlink:title="modsubgriddata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-146 239,-146 239,-122 360,-122 360,-146"/>
<text text-anchor="middle" x="299.5" y="-131.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgriddata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modsubgriddata.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge14" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modsubgriddata.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M395.8144,-134C387.8063,-134 379.132,-134 370.3817,-134"/>
<polygon fill="#00ffff" stroke="#00ffff" points="370.1102,-130.5001 360.1102,-134 370.1101,-137.5001 370.1102,-130.5001"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge15" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#0000ff" stroke-dasharray="5,2" d="M257.8107,-243.9204C242.6884,-239.5387 225.4223,-234.5358 209.5508,-229.937"/>
<polygon fill="#0000ff" stroke="#0000ff" points="210.4594,-226.5563 199.8803,-227.1349 208.5112,-233.2798 210.4594,-226.5563"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge16" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M266.4489,-59.6342C236.9072,-65.5186 193.0077,-76.392 158,-94"/>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M158,-94C111.1131,-117.5829 71.7222,-166.7568 52.0244,-194.611"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="49.1398,-192.6287 46.3364,-202.846 54.8995,-196.607 49.1398,-192.6287"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~advec_2nd.f90~~EfferentGraph_edge17" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff00ff" stroke-dasharray="5,2" d="M286.0396,-66.1995C273.4504,-77.8213 254.34,-96.0148 239,-113 214.4658,-140.1654 188.5722,-173.7592 172.848,-194.7901"/>
<polygon fill="#ff00ff" stroke="#ff00ff" points="169.9187,-192.8641 166.7652,-202.9788 175.538,-197.0383 169.9187,-192.8641"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 














<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#subs-1">Subroutines</a></h3></div>
  <div class="list-group">
    <div id="subs-1" class="panel-collapse collapse">
      
      <a class="list-group-item" href="../proc/advecc_2nd.html">advecc_2nd</a>
      
      <a class="list-group-item" href="../proc/advecu_2nd.html">advecu_2nd</a>
      
      <a class="list-group-item" href="../proc/advecv_2nd.html">advecv_2nd</a>
      
      <a class="list-group-item" href="../proc/advecw_2nd.html">advecw_2nd</a>
      
    </div>
  </div>
</div>









<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/advec_2nd.f90.html#src">advec_2nd.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file advec_2nd.f90</span>
<a name="ln-2"></a><span class="c">!!  Does advection with a 2nd order central differencing scheme.</span>
<a name="ln-3"></a><span class="c">!!</span>
<a name="ln-4"></a><span class="c">!! Second order central differencing can be used for variables where neither very</span>
<a name="ln-5"></a><span class="c">!! high accuracy nor strict monotonicity is necessary.</span>
<a name="ln-6"></a><span class="c">!! \latexonly</span>
<a name="ln-7"></a><span class="c">!!\begin{eqnarray}</span>
<a name="ln-8"></a><span class="c">!! F_{i-\frac{1}{2}}^{2nd} &amp;=&amp;</span>
<a name="ln-9"></a><span class="c">!!\fav{u}_{i-\frac{1}{2}}\frac{\phi_{i}+\phi_{i-1}}{2},</span>
<a name="ln-10"></a><span class="c">!!\end{eqnarray}</span>
<a name="ln-11"></a><span class="c">!! \endlatexonly</span>
<a name="ln-12"></a><span class="c">!!</span>
<a name="ln-13"></a><span class="c">!</span>
<a name="ln-14"></a><span class="c">!&gt; Advection at cell center</span>
<a name="ln-15"></a><span class="k">subroutine </span><span class="n">advecc_2nd</span><span class="p">(</span><span class="n">hi</span><span class="p">,</span> <span class="n">hj</span><span class="p">,</span> <span class="n">hk</span><span class="p">,</span> <span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-16"></a>
<a name="ln-17"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">dxf</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">dxfi5</span><span class="p">,</span> <span class="n">dyi5</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzfi5</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">libm</span><span class="p">,</span> <span class="n">jmax</span><span class="p">,</span> <span class="n">dxfi</span><span class="p">,</span> <span class="n">dzfi</span><span class="p">,</span> <span class="n">dyi</span>
<a name="ln-18"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span>
<a name="ln-19"></a>   <span class="k">use </span><span class="n">modibm</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">nxwallsnorm</span><span class="p">,</span> <span class="n">nzwallsnorm</span><span class="p">,</span> <span class="n">nywallsm</span><span class="p">,</span> <span class="n">nywallsp</span><span class="p">,</span> <span class="n">ywallsm</span><span class="p">,</span> <span class="n">ywallsp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-20"></a>      <span class="n">xwallsnorm</span><span class="p">,</span> <span class="n">zwallsnorm</span><span class="p">,</span> <span class="n">iypluswall</span><span class="p">,</span> <span class="n">iyminwall</span><span class="p">,</span> <span class="n">nyminwall</span><span class="p">,</span> <span class="n">nypluswall</span>
<a name="ln-21"></a>   <span class="k">use </span><span class="n">modibmdata</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">nxwall</span><span class="p">,</span> <span class="n">ixwall</span>
<a name="ln-22"></a>   <span class="k">use </span><span class="n">initfac</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="k">block</span>
<a name="ln-23"></a><span class="k">   use </span><span class="n">modmpi</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">myid</span>
<a name="ln-24"></a>   <span class="k">implicit none</span>
<a name="ln-25"></a>
<a name="ln-26"></a><span class="k">   </span><span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hi</span> <span class="c">!&lt; size of halo in i</span>
<a name="ln-27"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hj</span> <span class="c">!&lt; size of halo in j</span>
<a name="ln-28"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">hk</span> <span class="c">!&lt; size of halo in k</span>
<a name="ln-29"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">hi</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">hi</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">hj</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">hj</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">hk</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">hk</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the cell centered field</span>
<a name="ln-30"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">hi</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">hi</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">hj</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">hj</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">hk</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-31"></a>
<a name="ln-32"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">jl</span><span class="p">,</span> <span class="n">ju</span><span class="p">,</span> <span class="n">kl</span><span class="p">,</span> <span class="n">ku</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-33"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-34"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-35"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-36"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-37"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-38"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-39"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-40"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-41"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-42"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-43"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-44"></a>                              <span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-45"></a>                              <span class="o">-</span> <span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">im</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! d(uc)/dx</span>
<a name="ln-46"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxfi5</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-47"></a>                              <span class="o">+</span> <span class="p">(</span> <span class="p">&amp;</span> <span class="c">!</span>
<a name="ln-48"></a>                              <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-49"></a>                              <span class="o">-</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vc)/dy</span>
<a name="ln-50"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyi5</span><span class="p">)</span>
<a name="ln-51"></a>         <span class="k">end do</span>
<a name="ln-52"></a><span class="k">      end do</span>
<a name="ln-53"></a><span class="k">   end do</span>
<a name="ln-54"></a>
<a name="ln-55"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-56"></a>      <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-57"></a>      <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-58"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-59"></a>         <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-60"></a>         <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-61"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-62"></a>            <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-63"></a>            <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-64"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-65"></a>                              <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-66"></a>                              <span class="o">-</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-67"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-68"></a>         <span class="k">end do</span>
<a name="ln-69"></a><span class="k">      end do</span>
<a name="ln-70"></a><span class="k">   end do</span>
<a name="ln-71"></a>
<a name="ln-72"></a><span class="k">end subroutine </span><span class="n">advecc_2nd</span>
<a name="ln-73"></a>
<a name="ln-74"></a><span class="c">!&gt; Advection at the u point.</span>
<a name="ln-75"></a><span class="k">subroutine </span><span class="n">advecu_2nd</span><span class="p">(</span><span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-76"></a>
<a name="ln-77"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">dxhiq</span><span class="p">,</span> <span class="n">dyiq</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzfi5</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">libm</span>
<a name="ln-78"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pres0</span>
<a name="ln-79"></a>   <span class="k">use </span><span class="n">modibm</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">nxwallsnorm</span><span class="p">,</span> <span class="n">nzwallsnorm</span><span class="p">,</span> <span class="n">nywallsm</span><span class="p">,</span> <span class="n">nywallsp</span><span class="p">,</span> <span class="n">ywallsm</span><span class="p">,</span> <span class="n">ywallsp</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-80"></a>      <span class="n">xwallsnorm</span><span class="p">,</span> <span class="n">zwallsnorm</span>
<a name="ln-81"></a>   <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">myid</span>
<a name="ln-82"></a>   <span class="k">implicit none</span>
<a name="ln-83"></a>
<a name="ln-84"></a><span class="k">   </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the u-field</span>
<a name="ln-85"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-86"></a>
<a name="ln-87"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span><span class="p">,</span> <span class="n">il</span><span class="p">,</span> <span class="n">iu</span><span class="p">,</span> <span class="n">jl</span><span class="p">,</span> <span class="n">ju</span><span class="p">,</span> <span class="n">kl</span><span class="p">,</span> <span class="n">ku</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-88"></a>
<a name="ln-89"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-90"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-91"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-92"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-93"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-94"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-95"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-96"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-97"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-98"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-99"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-100"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-101"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(uu)/dx</span>
<a name="ln-102"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxhiq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-103"></a>                              <span class="o">+</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-104"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-105"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vu)/dy</span>
<a name="ln-106"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyiq</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-107"></a>                              <span class="o">-</span> <span class="p">((</span><span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pres0</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">))</span> <span class="c">! - dp/dx</span>
<a name="ln-108"></a>
<a name="ln-109"></a>         <span class="k">end do</span>
<a name="ln-110"></a><span class="k">      end do</span>
<a name="ln-111"></a><span class="k">   end do</span>
<a name="ln-112"></a>
<a name="ln-113"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-114"></a>      <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-115"></a>      <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-116"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-117"></a>         <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-118"></a>         <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-119"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-120"></a>            <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-121"></a>            <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-122"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-123"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-124"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-125"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-126"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-127"></a>                              <span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-128"></a>         <span class="k">end do</span>
<a name="ln-129"></a><span class="k">      end do</span>
<a name="ln-130"></a><span class="k">   end do</span>
<a name="ln-131"></a>
<a name="ln-132"></a><span class="k">end subroutine </span><span class="n">advecu_2nd</span>
<a name="ln-133"></a>
<a name="ln-134"></a><span class="c">!&gt; Advection at the v point.</span>
<a name="ln-135"></a><span class="k">subroutine </span><span class="n">advecv_2nd</span><span class="p">(</span><span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-136"></a>
<a name="ln-137"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">dxf</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">dxfiq</span><span class="p">,</span> <span class="n">dyiq</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzfi5</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">dyi</span>
<a name="ln-138"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pres0</span>
<a name="ln-139"></a>   <span class="k">implicit none</span>
<a name="ln-140"></a>
<a name="ln-141"></a><span class="k">   </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the v-field</span>
<a name="ln-142"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-143"></a>
<a name="ln-144"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span>
<a name="ln-145"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-146"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-147"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-148"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-149"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-150"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-151"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-152"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-153"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-154"></a>
<a name="ln-155"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-156"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-157"></a>                              <span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-158"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-159"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-160"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! d(uv)/dx</span>
<a name="ln-161"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-162"></a>                              <span class="o">+</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-163"></a>                              <span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-164"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vv)/dy</span>
<a name="ln-165"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyiq</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-166"></a>                              <span class="o">-</span> <span class="p">((</span><span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span><span class="o">*</span><span class="n">dyi</span><span class="p">)</span> <span class="c">! - dp/dy</span>
<a name="ln-167"></a>
<a name="ln-168"></a>         <span class="k">end do</span>
<a name="ln-169"></a><span class="k">      end do</span>
<a name="ln-170"></a><span class="k">   end do</span>
<a name="ln-171"></a>
<a name="ln-172"></a><span class="k">   do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-173"></a>      <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-174"></a>      <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-175"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-176"></a>         <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-177"></a>         <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-178"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-179"></a>            <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-180"></a>            <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-181"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-182"></a>                              <span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-183"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kp</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-184"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-185"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-186"></a>                              <span class="p">)</span><span class="o">*</span><span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-187"></a>         <span class="k">end do</span>
<a name="ln-188"></a><span class="k">      end do</span>
<a name="ln-189"></a><span class="k">   end do</span>
<a name="ln-190"></a>
<a name="ln-191"></a><span class="k">end subroutine </span><span class="n">advecv_2nd</span>
<a name="ln-192"></a>
<a name="ln-193"></a><span class="c">!&gt; Advection at the w point.</span>
<a name="ln-194"></a><span class="k">subroutine </span><span class="n">advecw_2nd</span><span class="p">(</span><span class="n">putin</span><span class="p">,</span> <span class="n">putout</span><span class="p">)</span>
<a name="ln-195"></a>
<a name="ln-196"></a>   <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">ih</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span><span class="p">,</span> <span class="n">jh</span><span class="p">,</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span><span class="p">,</span> <span class="n">kh</span><span class="p">,</span> <span class="n">dxf</span><span class="p">,</span> <span class="n">dxhi</span><span class="p">,</span> <span class="n">dxfiq</span><span class="p">,</span> <span class="n">dyiq</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzhi</span><span class="p">,</span> <span class="n">dzhiq</span>
<a name="ln-197"></a>   <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">u0</span><span class="p">,</span> <span class="n">v0</span><span class="p">,</span> <span class="n">w0</span><span class="p">,</span> <span class="n">pres0</span>
<a name="ln-198"></a>   <span class="c">! use modmpi, only : myid</span>
<a name="ln-199"></a>   <span class="k">implicit none</span>
<a name="ln-200"></a>
<a name="ln-201"></a><span class="k">   </span><span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span>  <span class="kd">::</span> <span class="n">putin</span> <span class="c">!&lt; Input: the w-field</span>
<a name="ln-202"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jb</span> <span class="o">-</span> <span class="n">jh</span><span class="p">:</span><span class="n">je</span> <span class="o">+</span> <span class="n">jh</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">),</span> <span class="k">intent</span><span class="p">(</span><span class="n">inout</span><span class="p">)</span> <span class="kd">::</span> <span class="n">putout</span> <span class="c">!&lt; Output: the tendency</span>
<a name="ln-203"></a>
<a name="ln-204"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">ip</span><span class="p">,</span> <span class="n">im</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">jm</span><span class="p">,</span> <span class="n">kp</span><span class="p">,</span> <span class="n">km</span>
<a name="ln-205"></a>
<a name="ln-206"></a>   <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-207"></a>      <span class="n">km</span> <span class="o">=</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-208"></a>      <span class="n">kp</span> <span class="o">=</span> <span class="n">k</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-209"></a>      <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="n">jb</span><span class="p">,</span> <span class="n">je</span>
<a name="ln-210"></a>         <span class="n">jm</span> <span class="o">=</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-211"></a>         <span class="n">jp</span> <span class="o">=</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-212"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-213"></a>            <span class="n">im</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="mi">1</span>
<a name="ln-214"></a>            <span class="n">ip</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-215"></a>
<a name="ln-216"></a>            <span class="n">putout</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-217"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-218"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">ip</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="p">&amp;</span> <span class="c">! d(uw)/dx</span>
<a name="ln-219"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">ip</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-220"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">im</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">))</span><span class="o">*</span><span class="n">dxhi</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-221"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">u0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-222"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-223"></a>                              <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-224"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-225"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(vw)/dy</span>
<a name="ln-226"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">jp</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-227"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">k</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-228"></a>                              <span class="o">*</span><span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">km</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">v0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-229"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dyiq</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-230"></a>                              <span class="o">+</span> <span class="p">&amp;</span>
<a name="ln-231"></a>                              <span class="p">(</span> <span class="p">&amp;</span>
<a name="ln-232"></a>                              <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">kp</span><span class="p">))</span> <span class="p">&amp;</span> <span class="c">! d(ww)/dz</span>
<a name="ln-233"></a>                              <span class="o">-</span> <span class="p">(</span><span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">putin</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span><span class="o">*</span><span class="p">(</span><span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="n">w0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">km</span><span class="p">))</span> <span class="p">&amp;</span>
<a name="ln-234"></a>                              <span class="p">)</span><span class="o">*</span><span class="n">dzhiq</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-235"></a>                              <span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-236"></a>                              <span class="o">-</span> <span class="p">((</span><span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">pres0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span><span class="o">*</span><span class="n">dzhi</span><span class="p">(</span><span class="n">k</span><span class="p">))</span> <span class="c">! - dp/dz</span>
<a name="ln-237"></a>
<a name="ln-238"></a>         <span class="k">end do</span>
<a name="ln-239"></a><span class="k">      end do</span>
<a name="ln-240"></a><span class="k">   end do</span>
<a name="ln-241"></a><span class="k">end subroutine </span><span class="n">advecw_2nd</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>