<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modglobal.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>modglobal.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 3.3% of total for source files.">471 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modglobal.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">modglobal.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modglobal.html">modglobal</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modglobal.f90.html#src">modglobal.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modglobal.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemodglobalf90EfferentGraph" width="211pt" height="32pt"
 viewBox="0.00 0.00 211.00 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modglobal.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>sourcefile~~modglobal.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 207,-28 207,4 -4,4"/>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~modglobal.f90</title>
<polygon fill="none" stroke="#000000" points="203,-24 113,-24 113,0 203,0 203,-24"/>
<text text-anchor="middle" x="158" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modglobal.f90</text>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~modglobal.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="77,-24 0,-24 0,0 77,0 77,-24"/>
<text text-anchor="middle" x="38.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modglobal.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.8222,-12C104.4581,-12 95.6884,-12 87.2244,-12"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.0997,-8.5001 77.0997,-12 87.0997,-15.5001 87.0997,-8.5001"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modglobal.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodglobalf90AfferentGraph" width="641pt" height="589pt"
 viewBox="0.00 0.00 641.00 589.03" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modglobal.f90~~AfferentGraph" class="graph" transform="scale(.593 .593) rotate(0) translate(4 989.3613)">
<title>sourcefile~~modglobal.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-989.3613 1077,-989.3613 1077,4 -4,4"/>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modglobal.f90</title>
<polygon fill="none" stroke="#000000" points="90,-564.3613 0,-564.3613 0,-540.3613 90,-540.3613 90,-564.3613"/>
<text text-anchor="middle" x="45" y="-549.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modglobal.f90</text>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="347,-985.3613 276,-985.3613 276,-961.3613 347,-961.3613 347,-985.3613"/>
<text text-anchor="middle" x="311.5" y="-970.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275.9831,-976.5796C245.802,-977.4509 202.7597,-974.0844 173,-952.3613"/>
</g>
<!-- sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~modstat_nc.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/modstat_nc.f90.html" xlink:title="modstat_nc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="220,-903.3613 126,-903.3613 126,-879.3613 220,-879.3613 220,-903.3613"/>
<text text-anchor="middle" x="173" y="-888.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstat_nc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M275.9204,-961.5486C269.1567,-958.8453 262.2459,-955.7553 256,-952.3613 233.7885,-940.2916 210.7993,-922.9519 194.6638,-909.8424"/>
<polygon fill="#ffd300" stroke="#ffd300" points="196.8302,-907.0923 186.8911,-903.4229 192.3726,-912.4895 196.8302,-907.0923"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-223.3613 140,-223.3613 140,-199.3613 206,-199.3613 206,-223.3613"/>
<text text-anchor="middle" x="173" y="-208.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M275.803,-966.6413C268.1406,-963.5364 260.8878,-958.9972 256,-952.3613 216.8522,-899.2125 232.0816,-424.2564 220,-359.3613 211.3867,-313.096 192.6665,-261.1108 181.6278,-232.7182"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="184.8687,-231.3959 177.9414,-223.3794 178.3577,-233.9661 184.8687,-231.3959"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="342,-143.3613 281,-143.3613 281,-119.3613 342,-119.3613 342,-143.3613"/>
<text text-anchor="middle" x="311.5" y="-128.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M280.8371,-121.5545C272.5587,-118.4292 263.7518,-114.6516 256,-110.3613 215.4801,-87.9352 211.6293,-21.8158 173,-47.3613"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M283.7391,-143.4486C274.7551,-147.6022 264.8345,-152.4491 256,-157.3613 236.097,-168.4277 214.5677,-182.5005 198.4244,-193.5051"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="196.3086,-190.7124 190.0546,-199.2645 200.2767,-196.479 196.3086,-190.7124"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="356.5,-223.3613 266.5,-223.3613 266.5,-199.3613 356.5,-199.3613 356.5,-223.3613"/>
<text text-anchor="middle" x="311.5" y="-208.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M270.0277,-223.3963C265.0005,-225.881 260.1753,-228.8427 256,-232.3613 200.3938,-279.2211 236.8965,-338.6462 173,-373.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M173,-373.3613C108.5946,-408.3528 68.833,-491.4325 52.9508,-530.8693"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.6336,-529.7423 49.2645,-540.3308 56.1561,-532.2836 49.6336,-529.7423"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="215.5,-564.3613 130.5,-564.3613 130.5,-540.3613 215.5,-540.3613 215.5,-564.3613"/>
<text text-anchor="middle" x="173" y="-549.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M267.0303,-223.3699C262.9106,-225.8311 259.12,-228.7942 256,-232.3613 209.439,-285.5943 237.6926,-318.8876 220,-387.3613 206.7357,-438.6967 189.1927,-498.4204 179.735,-530.0448"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="176.2699,-529.415 176.7472,-539.9991 182.9744,-531.4274 176.2699,-529.415"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M266.1499,-211.3613C250.1004,-211.3613 232.0988,-211.3613 216.2302,-211.3613"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="216.1522,-207.8614 206.1522,-211.3613 216.1522,-214.8614 216.1522,-207.8614"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="365,-783.3613 258,-783.3613 258,-759.3613 365,-759.3613 365,-783.3613"/>
<text text-anchor="middle" x="311.5" y="-768.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M257.7819,-772.2449C230.9065,-770.6065 198.7136,-765.3553 173,-751.3613"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M298.0538,-759.1402C286.0649,-747.7908 268.5248,-730.0288 256,-712.3613 223.3391,-666.29 195.4793,-605.6611 181.8827,-573.8952"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="185.0942,-572.5032 177.9814,-564.6509 178.645,-575.2249 185.0942,-572.5032"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M168.4444,-879.2961C149.6293,-829.4655 77.8137,-639.2662 53.276,-574.2796"/>
<polygon fill="#ff0000" stroke="#ff0000" points="56.4416,-572.7551 49.6348,-564.6362 49.8929,-575.2279 56.4416,-572.7551"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="958,-783.3613 846,-783.3613 846,-759.3613 958,-759.3613 958,-783.3613"/>
<text text-anchor="middle" x="902" y="-768.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M861.4637,-783.4247C782.6673,-805.7734 603.0001,-851.3613 448.5,-851.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.5,-851.3613C432.6583,-852.0753 326.7146,-815.8319 311.5,-811.3613"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M448.5,-851.3613C385.0689,-851.3613 374.9311,-891.3613 311.5,-891.3613"/>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M311.5,-891.3613C284.7662,-891.3613 255.1298,-891.3613 230.1545,-891.3613"/>
<polygon fill="#ffd300" stroke="#ffd300" points="230.1166,-887.8614 220.1166,-891.3613 230.1166,-894.8614 230.1166,-887.8614"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="810,-703.3613 713,-703.3613 713,-679.3613 810,-679.3613 810,-703.3613"/>
<text text-anchor="middle" x="761.5" y="-688.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff11" stroke-dasharray="5,2" d="M874.0059,-759.2557C864.942,-755.101 854.9284,-750.2581 846,-745.3613 825.779,-734.271 803.8591,-720.1991 787.413,-709.2008"/>
<polygon fill="#00ff11" stroke="#00ff11" points="789.1319,-706.1384 778.885,-703.4454 785.216,-711.9406 789.1319,-706.1384"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M845.8239,-762.0122C808.0432,-755.3218 757.2477,-745.5452 713,-734.3613 531.8057,-688.5632 494.3297,-648.119 311.5,-609.3613"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node30"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-863.3613 260,-863.3613 260,-839.3613 363,-839.3613 363,-863.3613"/>
<text text-anchor="middle" x="311.5" y="-848.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#ff0034" stroke-dasharray="5,2" d="M448.5,-851.3613C423.9483,-851.3613 396.9217,-851.3613 373.4078,-851.3613"/>
<polygon fill="#ff0034" stroke="#ff0034" points="373.2191,-847.8614 363.2191,-851.3613 373.2191,-854.8614 373.2191,-847.8614"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="352.5,-505.3613 270.5,-505.3613 270.5,-481.3613 352.5,-481.3613 352.5,-505.3613"/>
<text text-anchor="middle" x="311.5" y="-490.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M299.8101,-480.9913C269.0927,-448.8113 187.467,-365.5013 173,-373.3613"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M283.1382,-505.4432C262.2253,-514.3519 233.5614,-526.5625 210.718,-536.2937"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="209.1521,-533.1563 201.3238,-540.2955 211.8956,-539.5963 209.1521,-533.1563"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M297.0452,-481.0525C284.7261,-469.9165 267.2741,-452.5218 256,-434.3613 234.1281,-399.1296 195.5131,-282.0025 179.869,-233.1026"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="183.1806,-231.9669 176.812,-223.4997 176.5104,-234.0903 183.1806,-231.9669"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478,-387.3613 419,-387.3613 419,-363.3613 478,-363.3613 478,-387.3613"/>
<text text-anchor="middle" x="448.5" y="-372.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M424.5521,-363.3328C417.3542,-359.287 409.6169,-354.4874 403,-349.3613 384.8622,-335.31 386.3847,-324.6354 367,-312.3613 344.9724,-298.4136 337.5403,-292.0735 311.5,-293.3613"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M425.1972,-387.3616C417.8771,-391.4742 409.9076,-396.319 403,-401.3613 385.4687,-414.1583 385.6623,-423.2785 367,-434.3613 322.1658,-460.9865 300.4973,-445.1766 256,-472.3613 229.5816,-488.501 204.7851,-514.3452 189.2963,-532.2732"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="186.2464,-530.4605 182.474,-540.3611 191.597,-534.9739 186.2464,-530.4605"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node28"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="355,-425.3613 268,-425.3613 268,-401.3613 355,-401.3613 355,-425.3613"/>
<text text-anchor="middle" x="311.5" y="-410.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="#ff009e" stroke-dasharray="5,2" d="M418.773,-383.6067C402.9633,-387.9919 383.0448,-393.5167 364.6759,-398.6117"/>
<polygon fill="#ff009e" stroke="#ff009e" points="363.6557,-395.2625 354.955,-401.3081 365.5267,-402.0079 363.6557,-395.2625"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="949,-663.3613 855,-663.3613 855,-639.3613 949,-639.3613 949,-663.3613"/>
<text text-anchor="middle" x="902" y="-648.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M761.5,-651.3613C722.6712,-654.0516 715.3318,-667.6094 677,-674.3613 576.639,-692.0393 545.8249,-663.1503 448.5,-693.3613"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff11" stroke-dasharray="5,2" d="M859.8454,-663.3626C845.3906,-667.4778 829.0358,-672.134 813.8717,-676.4512"/>
<polygon fill="#00ff11" stroke="#00ff11" points="812.7699,-673.1257 804.1105,-679.2302 814.6867,-679.8582 812.7699,-673.1257"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="492.5,-505.3613 404.5,-505.3613 404.5,-481.3613 492.5,-481.3613 492.5,-505.3613"/>
<text text-anchor="middle" x="448.5" y="-490.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffaf" stroke-dasharray="5,2" d="M891.8258,-639.2219C870.4874,-614.6709 818.3083,-559.2603 761.5,-533.3613"/>
<path fill="none" stroke="#00ffaf" stroke-dasharray="5,2" d="M761.5,-533.3613C716.8669,-513.0129 723.0889,-479.1537 677,-462.3613 615.6142,-439.9955 594.2574,-450.5532 530,-462.3613 513.9106,-465.3179 496.8824,-471.3022 482.5749,-477.2312"/>
<polygon fill="#00ffaf" stroke="#00ffaf" points="480.9502,-474.12 473.1494,-481.2892 483.7184,-480.5494 480.9502,-474.12"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M603.5,-533.3613C570.3332,-539.5567 558.6303,-534.5084 530,-552.3613 509.1381,-565.37 513.8821,-579.8993 494,-594.3613 476.2779,-607.2521 470.3918,-612.3624 448.5,-613.3613"/>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M448.5,-613.3613C387.6485,-616.1379 371.0906,-621.9938 311.5,-609.3613"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="677,-665.3613 530,-665.3613 530,-641.3613 677,-641.3613 677,-665.3613"/>
<text text-anchor="middle" x="603.5" y="-650.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#00afff" stroke-dasharray="5,2" d="M854.7899,-649.7364C827.4982,-649.2032 792.5259,-649.2116 761.5,-651.3613"/>
<path fill="none" stroke="#00afff" stroke-dasharray="5,2" d="M761.5,-651.3613C737.434,-653.0287 711.2582,-653.7866 687.2618,-654.063"/>
<polygon fill="#00afff" stroke="#00afff" points="687.092,-650.5643 677.1236,-654.1533 687.1544,-657.564 687.092,-650.5643"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="656.5,-495.3613 550.5,-495.3613 550.5,-471.3613 656.5,-471.3613 656.5,-495.3613"/>
<text text-anchor="middle" x="603.5" y="-480.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M761.5,-533.3613C729.6301,-518.8317 692.3412,-506.814 661.9941,-498.2049"/>
<polygon fill="#0046ff" stroke="#0046ff" points="662.559,-494.729 651.9865,-495.4172 660.6806,-501.4723 662.559,-494.729"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="488.5,-585.3613 408.5,-585.3613 408.5,-561.3613 488.5,-561.3613 488.5,-585.3613"/>
<text text-anchor="middle" x="448.5" y="-570.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#0011ff" stroke-dasharray="5,2" d="M761.5,-533.3613C697.6047,-504.2313 672.5283,-520.4671 603.5,-533.3613"/>
<path fill="none" stroke="#0011ff" stroke-dasharray="5,2" d="M603.5,-533.3613C568.0336,-539.9862 528.6766,-550.1789 498.4963,-558.6169"/>
<polygon fill="#0011ff" stroke="#0011ff" points="497.3038,-555.3167 488.6319,-561.4035 499.2068,-562.0531 497.3038,-555.3167"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="801,-417.3613 722,-417.3613 722,-393.3613 801,-393.3613 801,-417.3613"/>
<text text-anchor="middle" x="761.5" y="-402.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M895.0326,-639.1621C872.6073,-599.8979 802.1074,-476.4604 773.6201,-426.5822"/>
<polygon fill="#c100ff" stroke="#c100ff" points="776.5082,-424.5818 768.5095,-417.6341 770.4298,-428.0535 776.5082,-424.5818"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node29"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="648.5,-585.3613 558.5,-585.3613 558.5,-561.3613 648.5,-561.3613 648.5,-585.3613"/>
<text text-anchor="middle" x="603.5" y="-570.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M761.5,-533.3613C751.3186,-528.7196 693.3975,-545.0853 650.619,-558.2701"/>
<polygon fill="#ff0069" stroke="#ff0069" points="649.4385,-554.9718 640.9277,-561.2819 651.5159,-561.6564 649.4385,-554.9718"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="354,-703.3613 269,-703.3613 269,-679.3613 354,-679.3613 354,-703.3613"/>
<text text-anchor="middle" x="311.5" y="-688.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M285.1022,-703.418C245.6561,-721.3471 175.6397,-752.7979 173,-751.3613"/>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M270.8644,-679.2757C265.5921,-676.7842 260.477,-673.8342 256,-670.3613 221.9565,-643.9528 196.1874,-599.7539 182.9445,-573.5982"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="186.0415,-571.9645 178.4912,-564.532 179.7586,-575.0507 186.0415,-571.9645"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M743.0093,-703.5372C681.5162,-742.4852 478.3284,-858.7712 311.5,-811.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311.5,-811.3613C247.1375,-792.4492 231.9227,-783.4285 173,-751.3613"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M736.1154,-679.283C728.4487,-675.2352 720.1687,-670.4469 713,-665.3613 695.2972,-652.8025 696.8849,-641.0619 677,-632.3613 583.6398,-591.5114 550.2809,-608.3121 448.5,-613.3613"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M729.6395,-679.236C723.3768,-675.5958 717.3945,-671.0208 713,-665.3613 672.012,-612.5735 718.9483,-571.3892 677,-519.3613 670.5788,-511.3971 661.9555,-505.0651 652.8768,-500.0772"/>
<polygon fill="#0046ff" stroke="#0046ff" points="654.2243,-496.8386 643.711,-495.5266 651.1115,-503.1084 654.2243,-496.8386"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="357,-661.3613 266,-661.3613 266,-637.3613 357,-637.3613 357,-661.3613"/>
<text text-anchor="middle" x="311.5" y="-646.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M273.176,-661.473C267.2244,-664.0231 261.2993,-666.9835 256,-670.3613 212.5347,-698.0661 218.2737,-776.0004 173,-751.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M173,-751.3613C102.6502,-713.0751 65.2113,-617.6734 51.3599,-574.3665"/>
<polygon fill="#ff0000" stroke="#ff0000" points="54.6247,-573.0754 48.3409,-564.5452 47.9337,-575.1322 54.6247,-573.0754"/>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M281.9067,-637.29C273.2961,-633.3066 264.0474,-628.5521 256,-623.3613 232.4458,-608.1682 208.4209,-586.8498 192.3214,-571.5445"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="194.7177,-568.993 185.0915,-564.5672 189.8567,-574.03 194.7177,-568.993"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-265.3613 273,-265.3613 273,-241.3613 350,-241.3613 350,-265.3613"/>
<text text-anchor="middle" x="311.5" y="-250.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M279.9828,-265.4089C271.7898,-269.2523 263.2393,-273.9399 256,-279.3613 211.3896,-312.7692 221.9721,-346.7547 173,-373.3613"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M296.9398,-265.6055C284.5532,-276.7001 267.0613,-294.0704 256,-312.3613 232.8901,-350.5758 194.3773,-478.6096 179.3132,-530.3704"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="175.887,-529.6193 176.4685,-540.1982 182.611,-531.5656 175.887,-529.6193"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M272.92,-241.6619C255.226,-236.2962 234.1842,-229.9153 215.984,-224.3961"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="216.7899,-220.9832 206.2045,-221.4305 214.7584,-227.6819 216.7899,-220.9832"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M425.9009,-505.4394C418.4698,-509.63 410.2571,-514.5013 403,-519.3613 364.1352,-545.3887 358.1488,-574.7952 311.5,-571.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311.5,-571.3613C204.3976,-563.4772 267.3644,-322.0929 173,-373.3613"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#c1ff00" stroke-dasharray="5,2" d="M404.3982,-493.3613C391.1837,-493.3613 376.5756,-493.3613 362.9324,-493.3613"/>
<polygon fill="#c1ff00" stroke="#c1ff00" points="362.7264,-489.8614 352.7264,-493.3613 362.7264,-496.8614 362.7264,-489.8614"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M311.5,-571.3613C282.9733,-569.2614 251.3583,-565.068 225.5446,-561.1538"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="226.0096,-557.6842 215.5922,-559.6154 224.9401,-564.602 226.0096,-557.6842"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M130.3779,-552.3613C120.669,-552.3613 110.2187,-552.3613 100.0736,-552.3613"/>
<polygon fill="#ff0000" stroke="#ff0000" points="100.069,-548.8614 90.0689,-552.3613 100.0689,-555.8614 100.069,-548.8614"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M168.4444,-223.4976C149.6293,-273.6222 77.8137,-464.9436 53.276,-530.3136"/>
<polygon fill="#ff0000" stroke="#ff0000" points="49.8723,-529.4218 49.6348,-540.014 56.4258,-531.8818 49.8723,-529.4218"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M551.8345,-665.3657C521.5266,-672.7372 482.6065,-682.7742 448.5,-693.3613"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M567.3483,-641.361C529.1704,-629.1705 471.3997,-612.2253 448.5,-613.3613"/>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-223.3613 403,-223.3613 403,-199.3613 494,-199.3613 494,-223.3613"/>
<text text-anchor="middle" x="448.5" y="-208.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M418.7504,-199.1183C412.7948,-195.4685 407.1135,-190.9191 403,-185.3613 359.8955,-127.1223 415.4159,-80.2656 367,-26.3613 349.5782,-6.9645 336.2088,-15.6817 311.5,-7.3613"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#00ff7b" stroke-dasharray="5,2" d="M409.2413,-223.3968C393.9192,-228.0941 376.1943,-233.528 360.0801,-238.4681"/>
<polygon fill="#00ff7b" stroke="#00ff7b" points="358.8257,-235.1918 350.2908,-241.4692 360.8775,-241.8844 358.8257,-235.1918"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M444.8272,-223.6653C436.0066,-251.1402 411.0297,-317.925 367,-354.3613 326.8275,-387.6056 295.5085,-358.3305 256,-392.3613 212.5692,-429.7706 188.7958,-495.5623 178.7848,-529.9665"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="175.3136,-529.3862 176.0106,-539.9581 182.0584,-531.259 175.3136,-529.3862"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M425.3068,-199.1981C398.5052,-186.4256 352.783,-168.5456 311.5,-171.3613"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M586.5204,-471.3168C570.5648,-459.4074 546.7052,-440.0156 530,-419.3613 509.2327,-393.6847 518.6021,-376.3909 494,-354.3613 477.6741,-339.7424 468.1832,-344.9954 448.5,-335.3613"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffaf" stroke-dasharray="5,2" d="M550.1578,-486.8027C534.9315,-487.7851 518.3229,-488.8566 503.0269,-489.8434"/>
<polygon fill="#00ffaf" stroke="#00ffaf" points="502.4341,-486.3743 492.6802,-490.5109 502.8848,-493.3598 502.4341,-486.3743"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M562.1316,-495.4135C511.8363,-510.4419 430.2868,-536.1271 403,-552.3613 384.3466,-563.4591 385.2142,-573.5564 367,-585.3613 344.4481,-599.9775 337.795,-614.9105 311.5,-609.3613"/>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M311.5,-609.3613C273.046,-601.2095 231.71,-582.8081 204.3056,-569.1052"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="205.7203,-565.898 195.221,-564.4788 202.5437,-572.1357 205.7203,-565.898"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#0011ff" stroke-dasharray="5,2" d="M575.5539,-495.3996C561.5158,-501.8549 544.4621,-510.3296 530,-519.3613 512.8075,-530.0982 510.8419,-536.0824 494,-547.3613 489.5777,-550.3228 484.8006,-553.2886 480.0617,-556.1019"/>
<polygon fill="#0011ff" stroke="#0011ff" points="478.0049,-553.2482 471.0991,-561.2832 481.5083,-559.3084 478.0049,-553.2482"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M444.5889,-585.7265C435.4427,-612.6817 410.1051,-677.1343 367,-712.3613 346.812,-728.8597 335.6911,-721.6379 311.5,-731.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311.5,-731.3613C282.6465,-742.9586 200.314,-766.2263 173,-751.3613"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#c1ff00" stroke-dasharray="5,2" d="M427.6926,-561.211C404.5247,-547.6823 366.907,-525.7157 340.7757,-510.4566"/>
<polygon fill="#c1ff00" stroke="#c1ff00" points="342.4547,-507.384 332.0543,-505.3638 338.9249,-513.4289 342.4547,-507.384"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M426.8276,-585.5041C399.9507,-599.065 352.6464,-618.0446 311.5,-609.3613"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="358.5,-101.3613 264.5,-101.3613 264.5,-77.3613 358.5,-77.3613 358.5,-101.3613"/>
<text text-anchor="middle" x="311.5" y="-86.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.6186,-77.3291C237.0679,-63.9036 177.4536,-44.4161 173,-47.3613"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M271.9686,-101.3651C266.359,-103.8954 260.855,-106.8782 256,-110.3613 225.529,-132.2218 199.8149,-167.9395 185.4113,-190.5191"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="182.4257,-188.6924 180.1191,-199.0332 188.3708,-192.3879 182.4257,-188.6924"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="367,-943.3613 256,-943.3613 256,-919.3613 367,-919.3613 367,-943.3613"/>
<text text-anchor="middle" x="311.5" y="-928.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M272.2998,-943.404C237.0182,-953.1686 188.42,-963.6172 173,-952.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M173,-952.3613C150.8448,-936.189 140.1849,-935.8386 126,-912.3613 90.7738,-854.0588 58.1769,-644.1939 48.1496,-574.8078"/>
<polygon fill="#ff0000" stroke="#ff0000" points="51.5671,-573.9807 46.6882,-564.5761 44.6374,-574.9705 51.5671,-573.9807"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M269.9454,-919.36C255.6964,-915.2447 239.5745,-910.5886 224.6262,-906.2714"/>
<polygon fill="#ffd300" stroke="#ffd300" points="225.5824,-902.9046 215.0039,-903.4924 223.6401,-909.6297 225.5824,-902.9046"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M296.5771,-919.3267C283.958,-908.3665 266.3287,-891.0756 256,-872.3613 252.2822,-865.6251 196.5291,-645.5398 178.546,-574.3427"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="181.9288,-573.443 176.0873,-564.6041 175.1417,-575.1566 181.9288,-573.443"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1073,-743.3613 994,-743.3613 994,-719.3613 1073,-719.3613 1073,-743.3613"/>
<text text-anchor="middle" x="1033.5" y="-728.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1032.2685,-719.3317C1026.8507,-673.0401 1000.8073,-505.0232 902,-425.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M902,-425.3613C856.8132,-388.9301 651.5185,-316.1977 603.5,-307.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.5,-307.3613C534.0395,-291.6235 552.4969,-230.9883 494,-190.3613 476.0006,-177.8605 466.2105,-184.2681 448.5,-171.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.5,-171.3613C388.7554,-127.8215 423.8134,-73.6622 367,-26.3613 346.9633,-9.6794 336.2088,-15.6817 311.5,-7.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311.5,-7.3613C250.7789,13.0859 226.4426,-12.0198 173,-47.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M173,-47.3613C89.5343,-102.557 54.7274,-439.6141 46.8196,-530.0487"/>
<polygon fill="#ff0000" stroke="#ff0000" points="43.3301,-529.7782 45.969,-540.0391 50.3049,-530.3721 43.3301,-529.7782"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.5,-931.3613C429.7636,-931.4069 385.6446,-945.9399 352.5001,-957.8957"/>
<polygon fill="#ff0000" stroke="#ff0000" points="351.2368,-954.6309 343.0406,-961.3445 353.6346,-961.2074 351.2368,-954.6309"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="#ff9e00" stroke-dasharray="5,2" d="M902,-731.3613C876.116,-729.3244 522.9128,-755.4457 375.4601,-766.5255"/>
<polygon fill="#ff9e00" stroke="#ff9e00" points="374.9158,-763.0565 365.2065,-767.2967 375.4408,-770.0368 374.9158,-763.0565"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M1020.277,-743.5651C1005.72,-756.6264 981.2832,-777.4736 958,-792.3613 760.2493,-918.8059 683.2195,-930.7902 448.5,-931.3613"/>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M448.5,-931.3613C385.0887,-932.9468 374.9311,-891.3613 311.5,-891.3613"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#f6ff00" stroke-dasharray="5,2" d="M994.0457,-743.3626C980.7745,-747.3994 965.7922,-751.9568 951.8291,-756.2041"/>
<polygon fill="#f6ff00" stroke="#f6ff00" points="950.4296,-752.9714 941.881,-759.2302 952.4668,-759.6685 950.4296,-752.9714"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#c1ff00" stroke-dasharray="5,2" d="M603.5,-307.3613C541.6045,-297.2603 548.574,-365.462 494,-396.3613 456.5625,-417.558 438.9824,-405.7788 403,-429.3613 383.5421,-442.1137 385.863,-453.7444 367,-467.3613 362.2469,-470.7925 356.9691,-473.951 351.6127,-476.7953"/>
<polygon fill="#c1ff00" stroke="#c1ff00" points="349.9966,-473.69 342.6026,-481.2781 353.1147,-479.9572 349.9966,-473.69"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#57ff00" stroke-dasharray="5,2" d="M1013.528,-719.211C991.3872,-705.7414 955.4977,-683.9074 930.4296,-668.6568"/>
<polygon fill="#57ff00" stroke="#57ff00" points="932.0915,-665.5711 921.7291,-663.3638 928.4533,-671.5514 932.0915,-665.5711"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff11" stroke-dasharray="5,2" d="M902,-731.3613C866.6303,-728.7945 827.9822,-717.0982 800.1891,-707.0112"/>
<polygon fill="#00ff11" stroke="#00ff11" points="801.0596,-703.6005 790.4669,-703.3877 798.6149,-710.1598 801.0596,-703.6005"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#00ff7b" stroke-dasharray="5,2" d="M603.5,-307.3613C517.6119,-293.1564 417.9832,-274.1961 360.1101,-262.9343"/>
<polygon fill="#00ff7b" stroke="#00ff7b" points="360.6344,-259.4707 350.1493,-260.9917 359.2944,-266.3412 360.6344,-259.4707"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M448.5,-171.3613C399.2919,-135.5001 372.2478,-167.218 311.5,-171.3613"/>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M311.5,-171.3613C276.4739,-173.7502 238.249,-185.5308 210.847,-195.6936"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="209.3654,-192.5126 201.2672,-199.3442 211.8581,-199.0538 209.3654,-192.5126"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#00afff" stroke-dasharray="5,2" d="M902,-731.3613C817.798,-725.2508 793.7222,-737.0844 713,-712.3613 682.4673,-703.0099 650.672,-684.7757 629.2604,-671.041"/>
<polygon fill="#00afff" stroke="#00afff" points="631.0368,-668.0206 620.7537,-665.4692 627.2013,-673.8763 631.0368,-668.0206"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M902,-425.3613C883.0296,-410.1739 736.9325,-446.8368 656.391,-468.6211"/>
<polygon fill="#0046ff" stroke="#0046ff" points="655.1627,-465.3279 646.4315,-471.3293 656.9996,-472.0826 655.1627,-465.3279"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="#5700ff" stroke-dasharray="5,2" d="M448.5,-931.3613C425.296,-931.4177 399.8813,-931.4312 377.3107,-931.4262"/>
<polygon fill="#5700ff" stroke="#5700ff" points="377.1599,-927.9262 367.1587,-931.4226 377.1575,-934.9262 377.1599,-927.9262"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#c100ff" stroke-dasharray="5,2" d="M902,-425.3613C876.7944,-405.182 840.5766,-400.4217 811.2262,-400.582"/>
<polygon fill="#c100ff" stroke="#c100ff" points="811.0723,-397.0846 801.1603,-400.8267 811.2425,-404.0826 811.0723,-397.0846"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M993.7249,-733.0531C967.606,-733.7476 932.7168,-733.8856 902,-731.3613"/>
<path fill="none" stroke="#ff0069" stroke-dasharray="5,2" d="M902,-731.3613C843.7389,-726.5733 859.887,-667.8338 810,-637.3613 763.0494,-608.6824 702.1633,-591.8631 658.6932,-582.7246"/>
<polygon fill="#ff0069" stroke="#ff0069" points="659.3636,-579.2894 648.8668,-580.7269 657.969,-586.149 659.3636,-579.2894"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M721.8747,-406.2083C689.9088,-406.6875 643.7928,-406.9187 603.5,-405.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M603.5,-405.3613C549.8537,-403.2878 543.1136,-376.0426 494,-354.3613 473.9521,-345.511 468.1832,-344.9954 448.5,-335.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.5,-335.3613C391.2984,-307.3634 375.1082,-290.2158 311.5,-293.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M311.5,-293.3613C240.5003,-296.8723 235.4629,-339.4251 173,-373.3613"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M603.5,-405.3613C556.5521,-403.6975 441.9743,-446.1338 403,-472.3613 382.6029,-486.0873 388.2398,-501.9792 367,-514.3613 323.676,-539.6176 266.607,-548.4224 225.5976,-551.3278"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="225.3022,-547.8392 215.5356,-551.9458 225.7314,-554.8261 225.3022,-547.8392"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0046ff" stroke-dasharray="5,2" d="M737.1588,-417.3778C710.3672,-430.6041 667.125,-451.9515 637.1112,-466.7684"/>
<polygon fill="#0046ff" stroke="#0046ff" points="635.2864,-463.7659 627.8689,-471.3311 638.3851,-470.0427 635.2864,-463.7659"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node26"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="346.5,-59.3613 276.5,-59.3613 276.5,-35.3613 346.5,-35.3613 346.5,-59.3613"/>
<text text-anchor="middle" x="311.5" y="-44.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M276.2958,-37.3166C246.3127,-30.9566 203.3853,-27.2675 173,-47.3613"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e4ff" stroke-dasharray="5,2" d="M276.3374,-56.5159C269.0968,-59.4925 261.8931,-63.3641 256,-68.3613 216.66,-101.7204 191.6543,-158.7014 180.2418,-189.7087"/>
<polygon fill="#00e4ff" stroke="#00e4ff" points="176.9349,-188.5621 176.8916,-199.1569 183.5325,-190.9016 176.9349,-188.5621"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modglobal.f90~~AfferentGraph_node27"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="363,-345.3613 260,-345.3613 260,-321.3613 363,-321.3613 363,-345.3613"/>
<text text-anchor="middle" x="311.5" y="-330.9613" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M259.7679,-342.7086C232.8108,-348.9368 199.9399,-358.7248 173,-373.3613"/>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M275.8258,-345.3774C268.6145,-349.0238 261.552,-353.6289 256,-359.3613 207.7547,-409.1739 185.3905,-491.4497 177.0755,-530.4945"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="173.6446,-529.8025 175.0929,-540.2978 180.5057,-531.1901 173.6446,-529.8025"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295.7017,-401.3406C269.0702,-382.6604 214.1245,-351.0183 173,-373.3613"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M278.7789,-425.3917C270.8592,-429.1651 262.742,-433.823 256,-439.3613 224.1188,-465.5506 198.069,-506.5975 184.1049,-531.3461"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="180.9507,-529.8186 179.1975,-540.2674 187.084,-533.1924 180.9507,-529.8186"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M588.4877,-585.4436C551.2123,-615.3811 456.8286,-690.776 448.5,-693.3613"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M448.5,-693.3613C388.1528,-712.0939 370.1291,-707.796 311.5,-731.3613"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M572.3209,-585.3984C541.4289,-596.3654 492.4952,-611.1788 448.5,-613.3613"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M281.5518,-839.2608C273.0215,-835.307 263.905,-830.5757 256,-825.3613 214.7456,-798.1483 216.4092,-774.9857 173,-751.3613"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#ffd300" stroke-dasharray="5,2" d="M269.9454,-863.3626C255.6964,-867.4778 239.5745,-872.134 224.6262,-876.4512"/>
<polygon fill="#ffd300" stroke="#ffd300" points="223.6401,-873.0928 215.0039,-879.2302 225.5824,-879.818 223.6401,-873.0928"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modglobal.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#00ffe4" stroke-dasharray="5,2" d="M296.9398,-839.1171C284.5532,-828.0224 267.0613,-810.6522 256,-792.3613 211.5171,-718.8044 186.6467,-618.0751 177.3174,-574.2325"/>
<polygon fill="#00ffe4" stroke="#00ffe4" points="180.7292,-573.4477 175.2779,-564.3629 173.8741,-574.8643 180.7292,-573.4477"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemodglobalf90AfferentGraph = svgPanZoom('#sourcefilemodglobalf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modglobal.html">modglobal</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modglobal.f90.html#src">modglobal.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file modglobal.f90</span>
<a name="ln-2"></a><span class="c">!!  Declares the global constants</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="c">!&gt;</span>
<a name="ln-5"></a><span class="c">!! \author Jasper Tomas, TU Delft 31 March 2014</span>
<a name="ln-6"></a>
<a name="ln-7"></a><span class="c">!!  Declares the global constants</span>
<a name="ln-8"></a><span class="c">!&gt;</span>
<a name="ln-9"></a><span class="c">!  This file is part of DALES.</span>
<a name="ln-10"></a><span class="c">!</span>
<a name="ln-11"></a><span class="c">! DALES is free software; you can redistribute it and/or modify</span>
<a name="ln-12"></a><span class="c">! it under the terms of the GNU General Public License as published by</span>
<a name="ln-13"></a><span class="c">! the Free Software Foundation; either version 3 of the License, or</span>
<a name="ln-14"></a><span class="c">! (at your option) any later version.</span>
<a name="ln-15"></a><span class="c">!</span>
<a name="ln-16"></a><span class="c">! DALES is distributed in the hope that it will be useful,</span>
<a name="ln-17"></a><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="ln-18"></a><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="ln-19"></a><span class="c">! GNU General Public License for more details.</span>
<a name="ln-20"></a><span class="c">!</span>
<a name="ln-21"></a><span class="c">! You should have received a copy of the GNU General Public License</span>
<a name="ln-22"></a><span class="c">! along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="ln-23"></a><span class="c">!</span>
<a name="ln-24"></a><span class="c">!  Copyright 1993-2009 Delft University of Technology, Wageningen University, Utrecht University, KNMI</span>
<a name="ln-25"></a><span class="c">!</span>
<a name="ln-26"></a><span class="k">module </span><span class="n">modglobal</span>
<a name="ln-27"></a>
<a name="ln-28"></a>   <span class="k">implicit none</span>
<a name="ln-29"></a><span class="k">   save</span>
<a name="ln-30"></a>
<a name="ln-31"></a><span class="k">   </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">poisrcheck</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! switch to check if it is the first (RK) time step</span>
<a name="ln-32"></a>   <span class="c">! Simulation dimensions (parconst.f90)</span>
<a name="ln-33"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">imax</span> <span class="o">=</span> <span class="mi">64</span>
<a name="ln-34"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jtot</span> <span class="o">=</span> <span class="mi">64</span>
<a name="ln-35"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jmax</span>
<a name="ln-36"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">jsen</span>
<a name="ln-37"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">kmax</span> <span class="o">=</span> <span class="mi">96</span>
<a name="ln-38"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">isen</span>
<a name="ln-39"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ib</span>
<a name="ln-40"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ie</span>
<a name="ln-41"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jb</span>
<a name="ln-42"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">je</span>
<a name="ln-43"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jgb</span> <span class="c">! global j range</span>
<a name="ln-44"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jge</span> <span class="c">! global j range</span>
<a name="ln-45"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">offset</span>
<a name="ln-46"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">kb</span>
<a name="ln-47"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ke</span>
<a name="ln-48"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">nsv</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt; Number of additional scalar fields</span>
<a name="ln-49"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">nvar</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-50"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fieldvars</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
<a name="ln-51"></a>
<a name="ln-52"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ih</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-53"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jh</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-54"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">kh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-55"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">ihc</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! used in k-scheme</span>
<a name="ln-56"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">jhc</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! used in k-scheme</span>
<a name="ln-57"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">khc</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">! used in k-scheme</span>
<a name="ln-58"></a>
<a name="ln-59"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nblocks</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">! no. of blocks in IBM</span>
<a name="ln-60"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="k">block</span><span class="p">(:,:)</span>
<a name="ln-61"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nfcts</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="c">! no. of wall facets</span>
<a name="ln-62"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">iplane</span> <span class="c">! ib+iplane is the plane that is stored when lstoreplane=.true.</span>
<a name="ln-63"></a>   <span class="kt">integer</span> <span class="kd">::</span>  <span class="n">nstore</span> <span class="o">=</span> <span class="mi">1002</span> <span class="c">! number of rk steps in inletfile. This should be a multiple of three!</span>
<a name="ln-64"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="kd">::</span> <span class="n">fname_options</span> <span class="o">=</span> <span class="s1">&#39;namoptions&#39;</span>
<a name="ln-65"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">longint</span> <span class="o">=</span> <span class="mi">8</span>
<a name="ln-66"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwarmstart</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;   flag for &quot;cold&quot; or &quot;warm&quot; start</span>
<a name="ln-67"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lstratstart</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-68"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lfielddump</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt; switch to enable the fielddump</span>
<a name="ln-69"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lreadscal</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;   flag for reading scalar pollutant field (warm start)</span>
<a name="ln-70"></a>
<a name="ln-71"></a>   <span class="c">!Switches for boundary conditions</span>
<a name="ln-72"></a>   <span class="c">!momentum (m), temperature (T), humidity (q) and scalars (s)</span>
<a name="ln-73"></a>   <span class="c">!lateral in x/i direction (x), in y/j direction (y) at the top (top) and at the bottom (bot)</span>
<a name="ln-74"></a>   <span class="c">!1 = periodic, &gt;1 special in/outflow conditions</span>
<a name="ln-75"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxm</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-76"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-77"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-78"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCxs</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-79"></a>   
<a name="ln-80"></a>   <span class="c">!y direction is currently alway periodic</span>
<a name="ln-81"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCym</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-82"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCyT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-83"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCyq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-84"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCys</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-85"></a>
<a name="ln-86"></a>   <span class="c">!at the top (top)</span>
<a name="ln-87"></a>   <span class="c">!1 = freeslip, 2 = noslip, 3 = determined by inflow conditions</span>
<a name="ln-88"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtopm</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-89"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtopT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-90"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtopq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-91"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCtops</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-92"></a>
<a name="ln-93"></a>   <span class="c">!at the bottom (bot) !the bottom BC are defacto useless, since they will be covered by a road facet</span>
<a name="ln-94"></a>   <span class="c">!1 = flux, 2 = wall function</span>
<a name="ln-95"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbotm</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-96"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbotT</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-97"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbotq</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-98"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">BCbots</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-99"></a>
<a name="ln-100"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iinletgen</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt;  0: no inletgen, 1: turb. inlet generator (Lund (1998)), 2: read inlet from file</span>
<a name="ln-101"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">idriver</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt;  0: no inlet driver store, 1: Save inlet driver data, 2: read inlet driver data from file</span>
<a name="ln-102"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">linoutflow</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for periodic BC in both horizontal directions (false) or inflow/outflow in i and periodic in j.</span>
<a name="ln-103"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lzerogradtop</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for zero gradient BC&#39;s at top wall (iinletgen 1 and 2 are seperate).</span>
<a name="ln-104"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lzerogradtopscal</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-105"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lbuoyancy</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for buoyancy force in modforces</span>
<a name="ln-106"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltempeq</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for solving temperature equation (either with or without buoyancy term)</span>
<a name="ln-107"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscalrec</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;</span>
<a name="ln-108"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lSIRANEinout</span><span class="o">=</span><span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  </span>
<a name="ln-109"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltempinout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  seperate switch for inflow/outflow BC for temperature (only necessary when linoutflow.eqv..false.).</span>
<a name="ln-110"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lmoistinout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  seperate switch for inflow/outflow BC for moisture (only necessary when linoutflow.eqv..false.).</span>
<a name="ln-111"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lper2inout</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines type of restart: .true. means switching from periodic to in/outflow: inlet profile is read from prof.inp</span>
<a name="ln-112"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">libm</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the Immersed Boundary Method is turned on</span>
<a name="ln-113"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwalldist</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the wall distances should be computed</span>
<a name="ln-114"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lles</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the subgrid model is turned on or constant ekm and ekh are used (DNS)</span>
<a name="ln-115"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">linletRA</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether a Running Average should be used (.true.) in inlet generator</span>
<a name="ln-116"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lfixinlet</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the average inlet profiles can evolve or not (only used when iinletgen=1,2)</span>
<a name="ln-117"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lfixutauin</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether the utau is kept fixed at the inlet (only used when iinletgen=1,2)</span>
<a name="ln-118"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscasrc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!</span>
<a name="ln-119"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscasrcl</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!tg3315</span>
<a name="ln-120"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lydump</span><span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output y-averaged statistics every tsample</span>
<a name="ln-121"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lytdump</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output y- and time- averaged statistics every tstatsdump</span>
<a name="ln-122"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lxydump</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output x- and y-avewraged statistics every tsample</span>
<a name="ln-123"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lxytdump</span>   <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output x-, y- and time-averaged statistics every tstatsdump</span>
<a name="ln-124"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lscasrcr</span>  <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch for network of point sources at lowest level</span>
<a name="ln-125"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltkedump</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!tg3315</span>
<a name="ln-126"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lslicedump</span><span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">!&lt;  switch to output slices in the xy-plane every tstatsdump</span>
<a name="ln-127"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ltdump</span>    <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>      <span class="c">!&lt;  switch to output time-averaged statistics every tstatsdump</span>
<a name="ln-128"></a>
<a name="ln-129"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lreadminl</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for reading mean inlet/recycle plane profiles (used in inletgenerator)</span>
<a name="ln-130"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwallfunc</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether wall functions are used to compute the wall-shear stress</span>
<a name="ln-131"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">luoutflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed outflow rate</span>
<a name="ln-132"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvoutflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed outflow rate</span>
<a name="ln-133"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">luvolflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed volume flow rate</span>
<a name="ln-134"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvvolflowr</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether u-velocity is corrected to get a fixed volume flow rate</span>
<a name="ln-135"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lstoreplane</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether i-plane data is stored.</span>
<a name="ln-136"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lstorexy</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!xy files stored</span>
<a name="ln-137"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lreadmean</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch that determines whether mean variables should be read from means#myid#.#expnr#</span>
<a name="ln-138"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="nb">lstat</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-139"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lEB</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-140"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lwriteEBfiles</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-141"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lconstW</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>  <span class="c">! The evaporated water can be removed from the soil (lconstW=false) or the soil moisture can be assumed as constant in time (lconstW=true)</span>
<a name="ln-142"></a><span class="c">!  logical :: ifixuinf   = .true. !dpdxl relaxed to have Uinf 1. dpdx = (1/dt)*(Uh-Uinf)2. d/dt(dpdx) = 1/tau*(Uh-Uinf)</span>
<a name="ln-143"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ifixuinf</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-144"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lvinf</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!use Vinf instead of Uinf for the fixed velocity at infinity</span>
<a name="ln-145"></a>
<a name="ln-146"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">freestreamav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!</span>
<a name="ln-147"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">freestrtmpav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!</span>
<a name="ln-148"></a>   <span class="c">!&lt;  Global constants modconst.f90</span>
<a name="ln-149"></a>   <span class="c">!&lt; File numbers</span>
<a name="ln-150"></a>
<a name="ln-151"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ifinput</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-152"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ifoutput</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-153"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ifnamopt</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-154"></a>
<a name="ln-155"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">pi</span> <span class="o">=</span> <span class="mf">3.141592653589793116</span>
<a name="ln-156"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">grav</span> <span class="o">=</span> <span class="mf">9.81</span> <span class="c">!&lt;    *gravity acceleration.</span>
<a name="ln-157"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rd</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">7.04</span> <span class="c">!&lt;    *gas constant for dry air.</span>
<a name="ln-158"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rv</span> <span class="o">=</span> <span class="mi">46</span><span class="mf">1.5</span> <span class="c">!&lt;    *gas constant for water vapor.</span>
<a name="ln-159"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">cp</span> <span class="o">=</span> <span class="mi">100</span><span class="mf">4.</span> <span class="c">!&lt;    *specific heat at constant pressure (dry air).</span>
<a name="ln-160"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rlv</span> <span class="o">=</span> <span class="mf">2.26e6</span> <span class="c">!&lt;    *latent heat for vaporisation.</span>
<a name="ln-161"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rlvi</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">rlv</span> <span class="c">!inverse</span>
<a name="ln-162"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ep</span> <span class="o">=</span> <span class="n">rd</span><span class="o">/</span><span class="n">rv</span> <span class="c">!&lt;    0.622</span>
<a name="ln-163"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ep2</span> <span class="o">=</span> <span class="n">rv</span><span class="o">/</span><span class="n">rd</span> <span class="o">-</span> <span class="mf">1.</span> <span class="c">!&lt;    0.61</span>
<a name="ln-164"></a>   <span class="c">!&lt; real,parameter :: cv       = cp-rd            !&lt;    716.96</span>
<a name="ln-165"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rcp</span> <span class="o">=</span> <span class="n">rd</span><span class="o">/</span><span class="n">cp</span> <span class="c">!&lt;    0.286</span>
<a name="ln-166"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">cpr</span> <span class="o">=</span> <span class="n">cp</span><span class="o">/</span><span class="n">rd</span> <span class="c">!&lt;    3.50</span>
<a name="ln-167"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rlvocp</span> <span class="o">=</span> <span class="n">rlv</span><span class="o">/</span><span class="n">cp</span> <span class="c">!&lt;    2.49</span>
<a name="ln-168"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">mair</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">8.967</span> <span class="c">!&lt; Molar mass of air</span>
<a name="ln-169"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rhoa</span> <span class="o">=</span> <span class="mf">1.2</span> <span class="c">!density of air used in some calculations</span>
<a name="ln-170"></a>
<a name="ln-171"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wfc</span> <span class="o">=</span> <span class="mi">31</span><span class="mf">3.</span> <span class="c">!water content at field capacity (kg/m3)</span>
<a name="ln-172"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wwilt</span> <span class="o">=</span> <span class="mi">17</span><span class="mf">1.</span> <span class="c">!water ocntent at wilting point (kg/m3)</span>
<a name="ln-173"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wgrmax</span> <span class="o">=</span> <span class="mi">45</span><span class="mf">0.</span> <span class="c">!maximum water content (kg/m3)</span>
<a name="ln-174"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">rsmin</span> <span class="o">=</span> <span class="mi">11</span><span class="mf">0.</span> <span class="c">!minimum resistance of soil/plant</span>
<a name="ln-175"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">rsmax</span> <span class="o">=</span> <span class="mi">500</span><span class="mf">0.</span> <span class="c">!maximum resistance of soil/plant</span>
<a name="ln-176"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">GRLAI</span> <span class="o">=</span> <span class="mf">2.</span> <span class="c">!Leave area index of green roof</span>
<a name="ln-177"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">wsoil</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!water content of soil (kg/m3)</span>
<a name="ln-178"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">bldT</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!building internal temperature, currently also ground temperature at a depth equal to floor facet thickness</span>
<a name="ln-179"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">skyLW</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!longwave radiation from the sky</span>
<a name="ln-180"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">gres</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!saturation vapour pressure of green roof</span>
<a name="ln-181"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">grqs</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!saturation humidity of green roof</span>
<a name="ln-182"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">grdqdt</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!gradient of saturation humidity for green roof</span>
<a name="ln-183"></a>
<a name="ln-184"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">numol</span> <span class="o">=</span> <span class="mf">1.5e-5</span> <span class="c">!&lt; kinematic viscosity for couette flow Re=5000 (Re=Uinf*H/(2*nu)) H=1, Uinf=1</span>
<a name="ln-185"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">numoli</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">numol</span> <span class="c">!&lt; 1/numol</span>
<a name="ln-186"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">prandtlmol</span> <span class="o">=</span> <span class="mf">0.71</span> <span class="c">!&lt; Prandtl number (for air at 300K). Fluid property!</span>
<a name="ln-187"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">prandtlmoli</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">prandtlmol</span> <span class="c">!&lt; Inverse of Prandtl number</span>
<a name="ln-188"></a>
<a name="ln-189"></a>   <span class="kt">integer</span>         <span class="kd">::</span> <span class="n">iwallmom</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">iwalltemp</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iwallmoist</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">iwallscal</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-190"></a>
<a name="ln-191"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">rhow</span> <span class="o">=</span> <span class="mf">0.998e3</span> <span class="c">!&lt;    * Density of water</span>
<a name="ln-192"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">pref0</span> <span class="o">=</span> <span class="mf">1.e5</span> <span class="c">!&lt;    *standard pressure used in exner function.</span>
<a name="ln-193"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">tmelt</span> <span class="o">=</span> <span class="mi">27</span><span class="mf">3.16</span> <span class="c">!&lt;    *temperature of melting of ice.</span>
<a name="ln-194"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">es0</span> <span class="o">=</span> <span class="mi">61</span><span class="mf">0.78</span> <span class="c">!&lt;    * constants used for computation</span>
<a name="ln-195"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">at</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">7.27</span> <span class="c">!&lt;    * of saturation mixing ratio</span>
<a name="ln-196"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">bt</span> <span class="o">=</span> <span class="mi">3</span><span class="mf">5.86</span> <span class="c">!&lt;    * using Tetens Formula.</span>
<a name="ln-197"></a>   <span class="c">!      real,parameter :: ekmin    = 1.e-6            !&lt;    *minimum value for k-coefficient.</span>
<a name="ln-198"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">ekmin</span> <span class="o">=</span> <span class="mf">1.e-12</span> <span class="c">!&lt;    *minimum value for k-coefficient.</span>
<a name="ln-199"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">e12min</span> <span class="o">=</span> <span class="mf">5.e-5</span> <span class="c">!&lt;    *minimum value for TKE.</span>
<a name="ln-200"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">fkar</span> <span class="o">=</span> <span class="mf">0.41</span> <span class="c">!&lt;  0.41   *Von Karman constant</span>
<a name="ln-201"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">eps1</span> <span class="o">=</span> <span class="mf">1.e-10</span> <span class="c">!&lt;    *very small number*</span>
<a name="ln-202"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">epscloud</span> <span class="o">=</span> <span class="mf">1.e-5</span> <span class="c">!&lt;    *limit for cloud calculation 0.01 g/kg</span>
<a name="ln-203"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">boltz</span> <span class="o">=</span> <span class="mf">5.67e-8</span> <span class="c">!&lt;    *Stefan-Boltzmann constant</span>
<a name="ln-204"></a>
<a name="ln-205"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lprofforc</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  nudge flow to a profile !</span>
<a name="ln-206"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lcoriol</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch for coriolis force</span>
<a name="ln-207"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">igrw_damp</span> <span class="o">=</span> <span class="mi">2</span> <span class="c">!&lt; switch to enable gravity wave damping</span>
<a name="ln-208"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">geodamptime</span> <span class="o">=</span> <span class="mi">720</span><span class="mf">0.</span> <span class="c">!&lt; time scale for nudging to geowind in sponge layer, prevents oscillations</span>
<a name="ln-209"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">uflowrate</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c">!&lt; fixed flow rate used for u-velocity correction</span>
<a name="ln-210"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">vflowrate</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c">!&lt; fixed flow rate used for v-velocity correction</span>
<a name="ln-211"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">Uinf</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt; fixed U_inf (used in inlet generator), also in conjunction with ifixuinf</span>
<a name="ln-212"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">Vinf</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!fixed V_inf</span>
<a name="ln-213"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">inletav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt; averaging interval for inlet generator</span>
<a name="ln-214"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">totinletav</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt; averaging interval for inlet generator (used in Running Average)</span>
<a name="ln-215"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om22</span> <span class="c">!&lt;    *2.*omega_earth*cos(lat)</span>
<a name="ln-216"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om23</span> <span class="c">!&lt;    *2.*omega_earth*sin(lat)</span>
<a name="ln-217"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om22_gs</span> <span class="c">!&lt;    *2.*omega_earth*cos(lat)</span>
<a name="ln-218"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">om23_gs</span> <span class="c">!&lt;    *2.*omega_earth*sin(lat)</span>
<a name="ln-219"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">xlat</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">2.</span> <span class="c">!&lt;    *latitude  in degrees.</span>
<a name="ln-220"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">xlon</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt;    *longitude in degrees.</span>
<a name="ln-221"></a>
<a name="ln-222"></a>   <span class="c">!scalar source in fluid domain</span>
<a name="ln-223"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">xSa</span><span class="p">(:)</span>
<a name="ln-224"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">ySa</span><span class="p">(:)</span>
<a name="ln-225"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zSa</span><span class="p">(:)</span>
<a name="ln-226"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">xS</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">yS</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">zS</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-227"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">SS</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-228"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">sigS</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-229"></a>
<a name="ln-230"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lnudge</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>                   <span class="c">!&lt; switch for applying nudging at the top of the domain</span>
<a name="ln-231"></a>  <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tnudge</span> <span class="o">=</span> <span class="mi">5</span><span class="mf">0.</span>                       <span class="c">!&lt; time scale for nudging</span>
<a name="ln-232"></a>  <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nnudge</span> <span class="o">=</span> <span class="mi">10</span>
<a name="ln-233"></a>
<a name="ln-234"></a>  <span class="c">!chemistry</span>
<a name="ln-235"></a>  <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lchem</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>    <span class="c">! switch for basic chemistry</span>
<a name="ln-236"></a>  <span class="kt">real</span>    <span class="kd">::</span> <span class="n">k1</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">JNO2</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">! k1 = rate constant (O3 + NO -&gt; NO2 + 02 ), JNO2 = NO2 photolysis rate</span>
<a name="ln-237"></a>
<a name="ln-238"></a>   <span class="c">! Poisson solver</span>
<a name="ln-239"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">POISS_FFT</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-240"></a>                         <span class="n">POISS_CYC</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-241"></a>
<a name="ln-242"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ipoiss</span>   <span class="o">=</span> <span class="n">POISS_CYC</span>
<a name="ln-243"></a>
<a name="ln-244"></a>   <span class="c">!Advection scheme</span>
<a name="ln-245"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">iadv_upw</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c">!&lt; first order upwind scheme</span>
<a name="ln-246"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">iadv_cd2</span> <span class="o">=</span> <span class="mi">2</span>  <span class="c">!&lt; second order central difference scheme</span>
<a name="ln-247"></a>   <span class="kt">integer</span><span class="p">,</span> <span class="k">parameter</span> <span class="kd">::</span> <span class="n">iadv_kappa</span> <span class="o">=</span> <span class="mi">7</span>  <span class="c">!&lt; Kappa scheme</span>
<a name="ln-248"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iadv_mom</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">iadv_tke</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iadv_thl</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iadv_qt</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">iadv_sv</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-249"></a>
<a name="ln-250"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lmoist</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;   switch to calculate moisture fields</span>
<a name="ln-251"></a>   <span class="c">! Global variables (modvar.f90)</span>
<a name="ln-252"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">xday</span> <span class="o">=</span> <span class="mf">1.</span> <span class="c">!&lt;     * day number</span>
<a name="ln-253"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">xtime</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt;     * GMT time</span>
<a name="ln-254"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">runtime</span> <span class="o">=</span> <span class="mi">30</span><span class="mf">0.</span> <span class="c">!&lt;     * simulation time in secs</span>
<a name="ln-255"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dtmax</span> <span class="o">=</span> <span class="mi">2</span><span class="mf">0.</span> <span class="c">!&lt;     * maximum time integration interval</span>
<a name="ln-256"></a>
<a name="ln-257"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">trestart</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.</span> <span class="c">!&lt;     * each trestart sec. a restart file is written to disk. bss116: per default do not write restart files</span>
<a name="ln-258"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tfielddump</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.</span> <span class="c">!&lt; Time step for field outputs</span>
<a name="ln-259"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tsample</span> <span class="o">=</span> <span class="mf">5.</span> <span class="c">!&lt;    Sample time steps for statistics</span>
<a name="ln-260"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tstatsdump</span> <span class="o">=</span> <span class="mi">1000</span><span class="mf">0.</span> <span class="c">!&lt; Time step for statistics outputs tg3315</span>
<a name="ln-261"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tnextrestart</span> <span class="c">!&lt;     * each trestart sec. a restart file is written to disk</span>
<a name="ln-262"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tscale</span> <span class="c">!       timescale: domain height*Uinf/utau**2</span>
<a name="ln-263"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tnextfielddump</span> <span class="c">!&lt;</span>
<a name="ln-264"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">90</span><span class="p">)</span> <span class="kd">::</span> <span class="n">startfile</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span> <span class="c">!&lt;    * name of the restart file</span>
<a name="ln-265"></a>
<a name="ln-266"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">totavtime</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!&lt;    * the total time over which the values are averaged in meansXXX.XXX</span>
<a name="ln-267"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dtEB</span> <span class="o">=</span> <span class="mi">1</span><span class="mf">0.</span> <span class="c">!time interval between calculations of facet energy balance</span>
<a name="ln-268"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">tEB</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!time of last calculation of facet energy balance</span>
<a name="ln-269"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">tnextEB</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!time for next calculation of facet energy balance</span>
<a name="ln-270"></a>
<a name="ln-271"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">thres</span> <span class="o">=</span> <span class="mf">5.e-3</span> <span class="c">!&lt;     * threshold value for inversion height calculations</span>
<a name="ln-272"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dqt</span> <span class="c">!&lt;     * applied gradient of qt at top of model</span>
<a name="ln-273"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dtheta</span> <span class="c">!&lt;     * applied gradient of theta at top of model</span>
<a name="ln-274"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dsv</span><span class="p">(:)</span> <span class="c">!&lt;     * applied gradient of sv(n) at top of model</span>
<a name="ln-275"></a>
<a name="ln-276"></a>   <span class="kt">real</span> <span class="kd">::</span>  <span class="n">dt</span> <span class="c">!&lt;     * time integration interval</span>
<a name="ln-277"></a>   <span class="c">!      integer(kind=longint) :: timee             !&lt;     * elapsed time since the &quot;cold&quot; start</span>
<a name="ln-278"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">timee</span> <span class="c">!&lt;     * elapsed time since the &quot;cold&quot; start</span>
<a name="ln-279"></a>   <span class="c">!      integer(kind=longint) :: btime             !&lt;     * time of (re)start</span>
<a name="ln-280"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">btime</span> <span class="c">!&lt;     * time of (re)start</span>
<a name="ln-281"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">runavtime</span> <span class="c">!&lt;     * time of starting running average</span>
<a name="ln-282"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntimee</span> <span class="c">!&lt;     * number of timesteps since the cold start</span>
<a name="ln-283"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ntrun</span> <span class="c">!&lt;     * number of timesteps since the start of the run</span>
<a name="ln-284"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">timeleft</span>
<a name="ln-285"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">ladaptive</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;    * adaptive timestepping on or off</span>
<a name="ln-286"></a>
<a name="ln-287"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tdriverstart</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">!&lt;     * time at which to start recording inlet driver file (only necessary if idriver == 1)                                                                            </span>
<a name="ln-288"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">tdriverdump</span>         <span class="c">!&lt;     * time in inlet driver simulation at which data dumps are made (idriver == 1)</span>
<a name="ln-289"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">dtdriver</span> <span class="o">=</span> <span class="mf">0.1</span>      <span class="c">!&lt;     * time frequency at which inlet driver data dumps are made (idriver == 1)</span>
<a name="ln-290"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">driverstore</span>         <span class="c">!&lt;     * number of stored driver steps for inlet (automatically calculated)</span>
<a name="ln-291"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">driverjobnr</span>         <span class="c">!&lt;     * Job number of the driver inlet generation run (idriver == 2)</span>
<a name="ln-292"></a>
<a name="ln-293"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">courant</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span>
<a name="ln-294"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">diffnr</span> <span class="o">=</span> <span class="mf">0.25</span>
<a name="ln-295"></a>   <span class="kt">real</span>    <span class="kd">::</span> <span class="n">dt_lim</span>
<a name="ln-296"></a>
<a name="ln-297"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">rk3step</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-298"></a>
<a name="ln-299"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iexpnr</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!&lt;     * number of the experiment</span>
<a name="ln-300"></a>
<a name="ln-301"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="n">cexpnr</span>
<a name="ln-302"></a>
<a name="ln-303"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">thlsrc</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-304"></a>
<a name="ln-305"></a>   <span class="c">! modphsgrd.f90</span>
<a name="ln-306"></a>
<a name="ln-307"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dy</span> <span class="c">!&lt;  grid spacing in y-direction</span>
<a name="ln-308"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dy2</span> <span class="c">!&lt;  grid spacing in y-direction squared</span>
<a name="ln-309"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dz</span> <span class="c">!&lt;  grid spacing in z-direction</span>
<a name="ln-310"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dyi</span> <span class="c">!&lt;  1/dy</span>
<a name="ln-311"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dyiq</span> <span class="c">!&lt;  1/(dy*4)</span>
<a name="ln-312"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dyi5</span> <span class="c">!&lt;  1/(dy*2)</span>
<a name="ln-313"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">dy2i</span> <span class="c">!&lt;  (1/dy)**2</span>
<a name="ln-314"></a>   
<a name="ln-315"></a>   <span class="kt">integer</span> <span class="kd">::</span> <span class="n">nwalllayers</span> <span class="o">=</span> <span class="mi">3</span>
<a name="ln-316"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">AM</span><span class="p">(:,:),</span> <span class="n">BM</span><span class="p">(:,:),</span> <span class="n">CM</span><span class="p">(:,:),</span> <span class="n">DM</span><span class="p">(:,:),</span> <span class="n">EM</span><span class="p">(:,:),</span> <span class="n">FM</span><span class="p">(:,:),</span> <span class="n">GM</span><span class="p">(:,:),</span> <span class="n">HM</span><span class="p">(:,:),</span> <span class="n">inAM</span><span class="p">(:,:),</span><span class="n">IDM</span><span class="p">(:,:)</span> <span class="c">!matrices for the facet energy balance</span>
<a name="ln-317"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>   <span class="kd">::</span> <span class="n">bb</span><span class="p">(:),</span><span class="n">w</span><span class="p">(:),</span><span class="n">dumv</span><span class="p">(:),</span><span class="n">Tdash</span><span class="p">(:)</span> <span class="c">!vector for the facet energy balance</span>
<a name="ln-318"></a>
<a name="ln-319"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">rslabs</span>
<a name="ln-320"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzf</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level</span>
<a name="ln-321"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfc</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level (extra ghost nodes (used in k-scheme)</span>
<a name="ln-322"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfci</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzfc</span>
<a name="ln-323"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzf2</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level squared</span>
<a name="ln-324"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzh</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of half level</span>
<a name="ln-325"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zh</span><span class="p">(:)</span> <span class="c">!&lt;  height of half level [m]</span>
<a name="ln-326"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zf</span><span class="p">(:)</span> <span class="c">!&lt;  height of full level [m]</span>
<a name="ln-327"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfi</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzf</span>
<a name="ln-328"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfiq</span><span class="p">(:)</span> <span class="c">!&lt;  0.25*(1/dzf)</span>
<a name="ln-329"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzfi5</span><span class="p">(:)</span> <span class="c">!&lt;  0.5*(1/dzf)</span>
<a name="ln-330"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzhi</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzh</span>
<a name="ln-331"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzhci</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzh (extra ghost nodes (used in k-scheme)</span>
<a name="ln-332"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzhiq</span><span class="p">(:)</span> <span class="c">!&lt;  0.25*(1/dzh)</span>
<a name="ln-333"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dzh2i</span><span class="p">(:)</span> <span class="c">!&lt;  1/dzh^2</span>
<a name="ln-334"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zhi</span><span class="p">(:)</span> <span class="c">!&lt;  1/zh</span>
<a name="ln-335"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">zfi</span><span class="p">(:)</span> <span class="c">!&lt;  1/zf</span>
<a name="ln-336"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxf</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level</span>
<a name="ln-337"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfc</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level (extra ghost nodes (used in k-scheme)</span>
<a name="ln-338"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfci</span><span class="p">(:)</span> <span class="c">!&lt;  1/dxfc</span>
<a name="ln-339"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxf2</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of full level squared</span>
<a name="ln-340"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfi</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxf</span>
<a name="ln-341"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfiq</span><span class="p">(:)</span> <span class="c">!&lt;  = 0.25*(1/dxf)</span>
<a name="ln-342"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxfi5</span><span class="p">(:)</span> <span class="c">!&lt;  = 0.5*(1/dxf)</span>
<a name="ln-343"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxh</span><span class="p">(:)</span> <span class="c">!&lt;  thickness of half level</span>
<a name="ln-344"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxhi</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxh</span>
<a name="ln-345"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxhci</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxh (with extra ghost nodes (used in k-scheme))</span>
<a name="ln-346"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxhiq</span><span class="p">(:)</span> <span class="c">!&lt;  = 0.25*(1/dxh)</span>
<a name="ln-347"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">dxh2i</span><span class="p">(:)</span> <span class="c">!&lt;  = 1/dxh^2</span>
<a name="ln-348"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">xh</span><span class="p">(:)</span> <span class="c">!&lt;  height of half level [m]</span>
<a name="ln-349"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">xf</span><span class="p">(:)</span> <span class="c">!&lt;  height of full level [m]</span>
<a name="ln-350"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">xsize</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="c">!&lt;  domain size in x-direction</span>
<a name="ln-351"></a>   <span class="kt">real</span> <span class="kd">::</span> <span class="n">ysize</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.</span> <span class="c">!&lt;  domain size in y-direction</span>
<a name="ln-352"></a>   <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">delta</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!&lt;  (dx*dy*dz)**(1/3)</span>
<a name="ln-353"></a>
<a name="ln-354"></a>   <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lmomsubs</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span> <span class="c">!&lt;  switch to apply subsidence on the momentum or not</span>
<a name="ln-355"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="kd">::</span> <span class="n">author</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">version</span> <span class="o">=</span> <span class="s1">&#39;DALES U&#39;</span>
<a name="ln-356"></a><span class="k">contains</span>
<a name="ln-357"></a>
<a name="ln-358"></a>   <span class="c">!&gt; Initialize global settings.</span>
<a name="ln-359"></a>   <span class="c">!!</span>
<a name="ln-360"></a>   <span class="c">!! Set courant number, calculate the grid sizes (both computational and physical), and set the coriolis parameter</span>
<a name="ln-361"></a>   <span class="k">subroutine </span><span class="n">initglobal</span>
<a name="ln-362"></a>      <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">nprocs</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">my_real</span><span class="p">,</span> <span class="n">mpierr</span>
<a name="ln-363"></a>      <span class="k">implicit none</span>
<a name="ln-364"></a>
<a name="ln-365"></a><span class="k">      </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">advarr</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<a name="ln-366"></a>      <span class="kt">real </span><span class="n">phi</span><span class="p">,</span> <span class="n">colat</span><span class="p">,</span> <span class="n">silat</span><span class="p">,</span> <span class="n">omega</span><span class="p">,</span> <span class="n">omega_gs</span>
<a name="ln-367"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">n</span>
<a name="ln-368"></a>      <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-369"></a>
<a name="ln-370"></a>      <span class="c">!timestepping</span>
<a name="ln-371"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">courant</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-372"></a><span class="k">         select case</span> <span class="p">(</span><span class="n">iadv_mom</span><span class="p">)</span>
<a name="ln-373"></a>         <span class="k">case</span> <span class="p">(</span><span class="n">iadv_cd2</span><span class="p">)</span>
<a name="ln-374"></a>            <span class="n">courant</span> <span class="o">=</span> <span class="mf">1.5</span>
<a name="ln-375"></a>         <span class="k">case </span><span class="n">default</span>
<a name="ln-376"></a>            <span class="n">courant</span> <span class="o">=</span> <span class="mf">1.4</span>
<a name="ln-377"></a>         <span class="k">end select</span>
<a name="ln-378"></a><span class="k">         if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-379"></a><span class="k">            </span><span class="n">courant</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<a name="ln-380"></a>         <span class="n">elseif</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_upw</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_upw</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-381"></a><span class="k">            </span><span class="n">courant</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<a name="ln-382"></a>         <span class="n">elseif</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">((</span><span class="o">/</span><span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="o">/</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-383"></a><span class="k">            </span><span class="n">courant</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="n">courant</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">)</span>
<a name="ln-384"></a>         <span class="k">end if</span>
<a name="ln-385"></a><span class="k">      end if</span>
<a name="ln-386"></a>
<a name="ln-387"></a>      <span class="c">! phsgrid</span>
<a name="ln-388"></a>
<a name="ln-389"></a>      <span class="n">jmax</span> <span class="o">=</span> <span class="n">jtot</span><span class="o">/</span><span class="n">nprocs</span>
<a name="ln-390"></a>      <span class="n">isen</span> <span class="o">=</span> <span class="n">imax</span><span class="o">/</span><span class="n">nprocs</span>
<a name="ln-391"></a>      <span class="n">jsen</span> <span class="o">=</span> <span class="n">jmax</span>
<a name="ln-392"></a>      <span class="c">!set the number of ghost cells. NB: This switch has to run in order of required ghost cells</span>
<a name="ln-393"></a>      <span class="n">advarr</span> <span class="o">=</span> <span class="p">(</span><span class="o">/</span><span class="n">iadv_mom</span><span class="p">,</span> <span class="n">iadv_tke</span><span class="p">,</span> <span class="n">iadv_thl</span><span class="p">,</span> <span class="n">iadv_qt</span><span class="o">/</span><span class="p">)</span>
<a name="ln-394"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">advarr</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-395"></a><span class="k">         </span><span class="n">ih</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-396"></a>         <span class="n">jh</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-397"></a>         <span class="c">! ih = 1</span>
<a name="ln-398"></a>         <span class="c">! jh = 1</span>
<a name="ln-399"></a>         <span class="n">kh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-400"></a>      <span class="n">elseif</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">advarr</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_cd2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-401"></a><span class="k">         </span><span class="n">ih</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-402"></a>         <span class="n">jh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-403"></a>         <span class="n">kh</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-404"></a>         <span class="n">ihc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-405"></a>         <span class="n">jhc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-406"></a>         <span class="n">khc</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-407"></a>      <span class="k">end if</span>
<a name="ln-408"></a>
<a name="ln-409"></a>      <span class="c">! J. Tomas added this for using only kappa scheme for sv(:)</span>
<a name="ln-410"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-411"></a><span class="k">         </span><span class="n">ihc</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-412"></a>         <span class="n">jhc</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-413"></a>         <span class="n">khc</span> <span class="o">=</span> <span class="mi">2</span>
<a name="ln-414"></a>      <span class="k">end if</span>
<a name="ln-415"></a>
<a name="ln-416"></a><span class="k">      </span><span class="n">offset</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-417"></a>      <span class="n">ib</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-418"></a>      <span class="n">ie</span> <span class="o">=</span> <span class="n">imax</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-419"></a>      <span class="n">jb</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-420"></a>      <span class="n">je</span> <span class="o">=</span> <span class="n">jmax</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-421"></a>      <span class="n">jgb</span> <span class="o">=</span> <span class="n">jb</span> <span class="c">! global j range (starting at the same as j as the processor j range)</span>
<a name="ln-422"></a>      <span class="n">jge</span> <span class="o">=</span> <span class="n">jtot</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span> <span class="c">! global j range</span>
<a name="ln-423"></a>      <span class="n">kb</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-424"></a>      <span class="n">ke</span> <span class="o">=</span> <span class="n">kmax</span> <span class="o">-</span> <span class="n">offset</span>
<a name="ln-425"></a>
<a name="ln-426"></a>      <span class="c">! Global constants</span>
<a name="ln-427"></a>
<a name="ln-428"></a>      <span class="c">! Select advection scheme for scalars. If not set in the options file, the momentum scheme is used</span>
<a name="ln-429"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iadv_tke</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">iadv_tke</span> <span class="o">=</span> <span class="n">iadv_mom</span>
<a name="ln-430"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iadv_thl</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">iadv_thl</span> <span class="o">=</span> <span class="n">iadv_mom</span>
<a name="ln-431"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">iadv_qt</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">iadv_qt</span> <span class="o">=</span> <span class="n">iadv_mom</span>
<a name="ln-432"></a>
<a name="ln-433"></a>      <span class="c">!CvH remove where</span>
<a name="ln-434"></a>      <span class="c">!where (iadv_sv&lt;0)  iadv_sv  = iadv_mom</span>
<a name="ln-435"></a>
<a name="ln-436"></a>      <span class="c">!tg3315 added - only uses kappa advection scheme...</span>
<a name="ln-437"></a>      <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nsv</span>
<a name="ln-438"></a>         <span class="n">iadv_sv</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">iadv_kappa</span>
<a name="ln-439"></a>      <span class="k">end do</span>
<a name="ln-440"></a>      <span class="c">!ends here</span>
<a name="ln-441"></a>
<a name="ln-442"></a>      <span class="n">phi</span> <span class="o">=</span> <span class="n">xlat</span><span class="o">*</span><span class="n">pi</span><span class="o">/</span><span class="mi">18</span><span class="mf">0.</span>
<a name="ln-443"></a>      <span class="n">colat</span> <span class="o">=</span> <span class="nb">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="ln-444"></a>      <span class="n">silat</span> <span class="o">=</span> <span class="nb">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span>
<a name="ln-445"></a>
<a name="ln-446"></a>      <span class="n">omega</span> <span class="o">=</span> <span class="mf">7.292e-5</span>
<a name="ln-447"></a>      <span class="n">omega_gs</span> <span class="o">=</span> <span class="mf">7.292e-5</span>
<a name="ln-448"></a>      <span class="n">om22</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">colat</span>
<a name="ln-449"></a>      <span class="n">om23</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega</span><span class="o">*</span><span class="n">silat</span>
<a name="ln-450"></a>      <span class="n">om22_gs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega_gs</span><span class="o">*</span><span class="n">colat</span>
<a name="ln-451"></a>      <span class="n">om23_gs</span> <span class="o">=</span> <span class="mf">2.</span><span class="o">*</span><span class="n">omega_gs</span><span class="o">*</span><span class="n">silat</span>
<a name="ln-452"></a>
<a name="ln-453"></a>      <span class="c">! Variables</span>
<a name="ln-454"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dsv</span><span class="p">(</span><span class="n">nsv</span><span class="p">))</span>
<a name="ln-455"></a>      <span class="k">write</span> <span class="p">(</span><span class="n">cexpnr</span><span class="p">,</span> <span class="s1">&#39;(i3.3)&#39;</span><span class="p">)</span> <span class="n">iexpnr</span>
<a name="ln-456"></a>
<a name="ln-457"></a>      <span class="c">! Create the physical grid variables</span>
<a name="ln-458"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzf</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-459"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzf2</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-460"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfi</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-461"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfiq</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-462"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfi5</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-463"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-464"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzhi</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-465"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzhiq</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-466"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dzh2i</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-467"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-468"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">zf</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-469"></a>
<a name="ln-470"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxf</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-471"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxf2</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-472"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfi</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-473"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfiq</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-474"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfi5</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-475"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxh</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-476"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxhi</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-477"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxhiq</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-478"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">dxh2i</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-479"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">xh</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-480"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">xf</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">))</span>
<a name="ln-481"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">delta</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">,</span> <span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">))</span>
<a name="ln-482"></a>
<a name="ln-483"></a>      <span class="n">rslabs</span> <span class="o">=</span> <span class="kt">real</span><span class="p">(</span><span class="n">imax</span><span class="o">*</span><span class="n">jtot</span><span class="p">)</span>
<a name="ln-484"></a>
<a name="ln-485"></a>      <span class="n">dy</span> <span class="o">=</span> <span class="n">ysize</span><span class="o">/</span><span class="nb">float</span><span class="p">(</span><span class="n">jtot</span><span class="p">)</span>
<a name="ln-486"></a>
<a name="ln-487"></a>      <span class="c">! MPI</span>
<a name="ln-488"></a>
<a name="ln-489"></a>      <span class="c">! Note, that the loop for reading zf and calculating zh</span>
<a name="ln-490"></a>      <span class="c">! has been split so that reading is only done on PE 1</span>
<a name="ln-491"></a>
<a name="ln-492"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-493"></a><span class="k">         open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;prof.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-494"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-495"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-496"></a>
<a name="ln-497"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-498"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-499"></a>         <span class="k">end do</span>
<a name="ln-500"></a><span class="k">         close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-501"></a>
<a name="ln-502"></a>         <span class="c">! J. Tomas: Read the x-coordinates of the cell centers from xgrid.inp.XXX</span>
<a name="ln-503"></a>         <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;xgrid.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-504"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-505"></a>         <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a72)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-506"></a>
<a name="ln-507"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-508"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-509"></a>         <span class="k">end do</span>
<a name="ln-510"></a><span class="k">         close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-511"></a>
<a name="ln-512"></a>      <span class="k">end if</span> <span class="c">! end if myid==0</span>
<a name="ln-513"></a>
<a name="ln-514"></a>      <span class="c">! MPI broadcast kmax elements from zf</span>
<a name="ln-515"></a>      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">zf</span><span class="p">,</span> <span class="n">kmax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-516"></a>      <span class="c">! MPI broadcast imax elements from xf</span>
<a name="ln-517"></a>      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">xf</span><span class="p">,</span> <span class="n">imax</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-518"></a>
<a name="ln-519"></a>      <span class="n">zh</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-520"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-521"></a>         <span class="n">zh</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">))</span>
<a name="ln-522"></a>      <span class="k">end do</span>
<a name="ln-523"></a><span class="k">      </span><span class="n">zf</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">=</span> <span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">zh</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">-</span> <span class="n">zf</span><span class="p">(</span><span class="n">ke</span><span class="p">))</span>
<a name="ln-524"></a>
<a name="ln-525"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span>
<a name="ln-526"></a>         <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span>
<a name="ln-527"></a>      <span class="k">end do</span>
<a name="ln-528"></a><span class="k">      </span><span class="n">dzf</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzf</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-529"></a>      <span class="n">dzf</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
<a name="ln-530"></a>
<a name="ln-531"></a>      <span class="n">dzh</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">zf</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
<a name="ln-532"></a>      <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
<a name="ln-533"></a>         <span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">-</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-534"></a>      <span class="k">end do</span>
<a name="ln-535"></a>
<a name="ln-536"></a>      <span class="c">! j. tomas: same trick for x-direction...</span>
<a name="ln-537"></a>      <span class="n">xh</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.0</span>
<a name="ln-538"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-539"></a>         <span class="n">xh</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
<a name="ln-540"></a>      <span class="k">end do</span>
<a name="ln-541"></a><span class="k">      </span><span class="n">xf</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">=</span> <span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span> <span class="o">+</span> <span class="mf">2.0</span><span class="o">*</span><span class="p">(</span><span class="n">xh</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">-</span> <span class="n">xf</span><span class="p">(</span><span class="n">ie</span><span class="p">))</span>
<a name="ln-542"></a>
<a name="ln-543"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span><span class="p">,</span> <span class="n">ie</span>
<a name="ln-544"></a>         <span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<a name="ln-545"></a>      <span class="k">end do</span>
<a name="ln-546"></a><span class="k">      </span><span class="n">dxf</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxf</span><span class="p">(</span><span class="n">ie</span><span class="p">)</span>
<a name="ln-547"></a>      <span class="n">dxf</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxf</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span>
<a name="ln-548"></a>
<a name="ln-549"></a>      <span class="n">dxh</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">xf</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span>
<a name="ln-550"></a>      <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span>
<a name="ln-551"></a>         <span class="n">dxh</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">-</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-552"></a>      <span class="k">end do</span>
<a name="ln-553"></a>
<a name="ln-554"></a><span class="k">      do </span><span class="n">k</span> <span class="o">=</span> <span class="n">kb</span><span class="p">,</span> <span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span>
<a name="ln-555"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">,</span> <span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span>
<a name="ln-556"></a>            <span class="n">delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">*</span><span class="n">dy</span><span class="o">*</span><span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">))</span><span class="o">**</span><span class="p">(</span><span class="mf">1.</span><span class="o">/</span><span class="mf">3.</span><span class="p">)</span>
<a name="ln-557"></a>         <span class="k">end do</span>
<a name="ln-558"></a><span class="k">      end do</span>
<a name="ln-559"></a>
<a name="ln-560"></a>      <span class="c">!--------------------------------------------------</span>
<a name="ln-561"></a>      <span class="c">! *** Check whether the grid is equidistant *****</span>
<a name="ln-562"></a>      <span class="c">!--------------------------------------------------</span>
<a name="ln-563"></a>      
<a name="ln-564"></a>      <span class="c">!if (myid == 0) then</span>
<a name="ln-565"></a>      <span class="c">!do k=kb,ke+kh</span>
<a name="ln-566"></a>      <span class="c">!if (.not.(dzf(k).eq.dzf(1)))</span>
<a name="ln-567"></a>      <span class="c">!      write (6, *) &amp;</span>
<a name="ln-568"></a>      <span class="c">!      &#39;WARNING, You are working with a non-equidistant grid!!!!&#39;</span>
<a name="ln-569"></a>      <span class="c">!end if</span>
<a name="ln-570"></a>      <span class="c">!end do</span>
<a name="ln-571"></a>      <span class="c">!end if ! end if myid==0</span>
<a name="ln-572"></a>
<a name="ln-573"></a>      <span class="n">dzhi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dzh</span>
<a name="ln-574"></a>      <span class="n">dzfi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dzf</span>
<a name="ln-575"></a>      <span class="n">dzf2</span> <span class="o">=</span> <span class="n">dzf</span><span class="o">*</span><span class="n">dzf</span>
<a name="ln-576"></a>      <span class="n">dxhi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dxh</span>
<a name="ln-577"></a>      <span class="n">dxfi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dxf</span>
<a name="ln-578"></a>      <span class="n">dxf2</span> <span class="o">=</span> <span class="n">dxf</span><span class="o">*</span><span class="n">dxf</span>
<a name="ln-579"></a>      <span class="n">dyi</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dy</span>
<a name="ln-580"></a>      <span class="n">dy2</span> <span class="o">=</span> <span class="n">dy</span><span class="o">*</span><span class="n">dy</span>
<a name="ln-581"></a>
<a name="ln-582"></a>      <span class="n">dzhiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dzhi</span>
<a name="ln-583"></a>      <span class="n">dzfiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dzfi</span>
<a name="ln-584"></a>      <span class="n">dxhiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dxhi</span>
<a name="ln-585"></a>      <span class="n">dxfiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dxfi</span>
<a name="ln-586"></a>      <span class="n">dyiq</span> <span class="o">=</span> <span class="mf">0.25</span><span class="o">*</span><span class="n">dyi</span>
<a name="ln-587"></a>
<a name="ln-588"></a>      <span class="n">dzh2i</span> <span class="o">=</span> <span class="n">dzhi</span><span class="o">*</span><span class="n">dzhi</span>
<a name="ln-589"></a>      <span class="n">dxh2i</span> <span class="o">=</span> <span class="n">dxhi</span><span class="o">*</span><span class="n">dxhi</span>
<a name="ln-590"></a>      <span class="n">dy2i</span> <span class="o">=</span> <span class="n">dyi</span><span class="o">*</span><span class="n">dyi</span>
<a name="ln-591"></a>
<a name="ln-592"></a>      <span class="n">dzfi5</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dzfi</span>
<a name="ln-593"></a>      <span class="n">dxfi5</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dxfi</span>
<a name="ln-594"></a>      <span class="n">dyi5</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">dyi</span>
<a name="ln-595"></a>
<a name="ln-596"></a>      <span class="c">! Grid used in kappa scheme advection (extra ghost nodes)</span>
<a name="ln-597"></a>      <span class="k">if</span> <span class="p">(</span><span class="nb">any</span><span class="p">(</span><span class="n">iadv_sv</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nsv</span><span class="p">)</span> <span class="o">==</span> <span class="n">iadv_kappa</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-598"></a><span class="k">         allocate</span> <span class="p">(</span><span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">khc</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">))</span>
<a name="ln-599"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ihc</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">))</span>
<a name="ln-600"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dzfci</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">khc</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">))</span>
<a name="ln-601"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dxfci</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ihc</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">))</span>
<a name="ln-602"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">))</span>
<a name="ln-603"></a>         <span class="k">allocate</span> <span class="p">(</span><span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">))</span>
<a name="ln-604"></a>
<a name="ln-605"></a>         <span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzf</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-606"></a>         <span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">khc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzfc</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-607"></a>         <span class="n">dzfc</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzfc</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-608"></a>
<a name="ln-609"></a>         <span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxf</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-610"></a>         <span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ihc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxfc</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-611"></a>         <span class="n">dxfc</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxfc</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-612"></a>
<a name="ln-613"></a>         <span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzhi</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-614"></a>         <span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzhci</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span>
<a name="ln-615"></a>         <span class="n">dzhci</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">khc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dzhci</span><span class="p">(</span><span class="n">ke</span> <span class="o">+</span> <span class="n">kh</span><span class="p">)</span>
<a name="ln-616"></a>
<a name="ln-617"></a>         <span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxhi</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-618"></a>         <span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxhci</span><span class="p">(</span><span class="n">ib</span><span class="p">)</span>
<a name="ln-619"></a>         <span class="n">dxhci</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ihc</span><span class="p">)</span> <span class="o">=</span> <span class="n">dxhci</span><span class="p">(</span><span class="n">ie</span> <span class="o">+</span> <span class="n">ih</span><span class="p">)</span>
<a name="ln-620"></a>
<a name="ln-621"></a>         <span class="n">dzfci</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dzfc</span>
<a name="ln-622"></a>         <span class="n">dxfci</span> <span class="o">=</span> <span class="mf">1.</span><span class="o">/</span><span class="n">dxfc</span>
<a name="ln-623"></a>      <span class="k">end if</span>
<a name="ln-624"></a>
<a name="ln-625"></a><span class="k">      if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-626"></a>
<a name="ln-627"></a><span class="k">         write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;lev    dz     zf      zh       dzh    delta(ib,k)&#39;</span>
<a name="ln-628"></a>         <span class="k">do </span><span class="n">k</span> <span class="o">=</span> <span class="n">ke</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">kb</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-629"></a>            <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(i4,5f8.5)&#39;</span><span class="p">)</span> <span class="n">k</span><span class="p">,</span> <span class="n">dzf</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">zf</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">zh</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">dzh</span><span class="p">(</span><span class="n">k</span><span class="p">),</span> <span class="n">delta</span><span class="p">(</span><span class="n">ib</span><span class="p">,</span> <span class="n">k</span><span class="p">)</span>
<a name="ln-630"></a>         <span class="k">end do</span>
<a name="ln-631"></a>         <span class="c">! same for x:</span>
<a name="ln-632"></a>         <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s1">&#39;lev    dxf     xf      xh       dxh    delta(i,kb)&#39;</span>
<a name="ln-633"></a>         <span class="k">do </span><span class="n">i</span> <span class="o">=</span> <span class="n">ie</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ib</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span>
<a name="ln-634"></a>            <span class="k">write</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="s1">&#39;(i4,5f9.5)&#39;</span><span class="p">)</span> <span class="n">i</span><span class="p">,</span> <span class="n">dxf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">xf</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">xh</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">dxh</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="n">delta</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">kb</span><span class="p">)</span>
<a name="ln-635"></a>         <span class="k">end do</span>
<a name="ln-636"></a><span class="k">      end if</span>
<a name="ln-637"></a><span class="k">      </span><span class="n">tnextrestart</span> <span class="o">=</span> <span class="n">trestart</span>
<a name="ln-638"></a>      <span class="n">tnextfielddump</span> <span class="o">=</span> <span class="n">tfielddump</span>
<a name="ln-639"></a><span class="c">!    tnextstatsdump = tstatsdump</span>
<a name="ln-640"></a>      <span class="n">timeleft</span> <span class="o">=</span> <span class="n">runtime</span> <span class="c">! tg3315 previously btime + runtime</span>
<a name="ln-641"></a>
<a name="ln-642"></a>   <span class="k">end subroutine </span><span class="n">initglobal</span>
<a name="ln-643"></a>
<a name="ln-644"></a>   <span class="c">!&gt; Clean up when leaving the run</span>
<a name="ln-645"></a>   <span class="k">subroutine </span><span class="n">exitglobal</span>
<a name="ln-646"></a>      <span class="k">deallocate</span> <span class="p">(</span><span class="n">dsv</span><span class="p">,</span> <span class="n">dzf</span><span class="p">,</span> <span class="n">dzh</span><span class="p">,</span> <span class="n">zh</span><span class="p">,</span> <span class="n">zf</span><span class="p">,</span> <span class="n">delta</span><span class="p">)</span>
<a name="ln-647"></a>   <span class="k">end subroutine </span><span class="n">exitglobal</span>
<a name="ln-648"></a>
<a name="ln-649"></a><span class="k">end module </span><span class="n">modglobal</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>