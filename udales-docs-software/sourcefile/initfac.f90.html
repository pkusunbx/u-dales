<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>initfac.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>initfac.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 2.3% of total for source files.">319 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/initfac.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">initfac.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/initfac.html">initfac</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/initfac.f90.html#src">initfac.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~initfac.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefileinitfacf90EfferentGraph" width="313pt" height="52pt"
 viewBox="0.00 0.00 313.00 52.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~initfac.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 48)">
<title>sourcefile~~initfac.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-48 309,-48 309,4 -4,4"/>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~initfac.f90</title>
<polygon fill="none" stroke="#000000" points="305,-44 239,-44 239,-20 305,-20 305,-44"/>
<text text-anchor="middle" x="272" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">initfac.f90</text>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~initfac.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="77,-44 0,-44 0,-20 77,-20 77,-44"/>
<text text-anchor="middle" x="38.5" y="-29.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.6602,-32.5806C227.3414,-32.7518 214.6207,-32.9158 203,-33 163.0011,-33.2898 152.9991,-33.2684 113,-33 104.7237,-32.9445 95.9305,-32.8542 87.3959,-32.7501"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.2105,-29.2475 77.1659,-32.6176 87.1197,-36.2469 87.2105,-29.2475"/>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~initfac.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-24 113,-24 113,0 203,0 203,-24"/>
<text text-anchor="middle" x="158" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M238.72,-26.1614C230.7843,-24.7692 222.1021,-23.246 213.4667,-21.731"/>
<polygon fill="#ff0000" stroke="#ff0000" points="213.8531,-18.2454 203.3987,-19.9647 212.6435,-25.1401 213.8531,-18.2454"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~initfac.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M112.8222,-19.5611C104.4581,-20.961 95.6884,-22.4287 87.2244,-23.8453"/>
<polygon fill="#00ffff" stroke="#00ffff" points="86.3848,-20.437 77.0997,-25.5398 87.5403,-27.341 86.3848,-20.437"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~initfac.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefileinitfacf90AfferentGraph" width="641pt" height="269pt"
 viewBox="0.00 0.00 641.00 268.94" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~initfac.f90~~AfferentGraph" class="graph" transform="scale(.7376 .7376) rotate(0) translate(4 360.6057)">
<title>sourcefile~~initfac.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-360.6057 865,-360.6057 865,4 -4,4"/>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~initfac.f90</title>
<polygon fill="none" stroke="#000000" points="66,-205 0,-205 0,-181 66,-181 66,-205"/>
<text text-anchor="middle" x="33" y="-190.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">initfac.f90</text>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="323,-222 232,-222 232,-198 323,-198 323,-222"/>
<text text-anchor="middle" x="277.5" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M256.2346,-222.1761C232.6464,-235.6565 197.6598,-255.5639 196,-256 155.5935,-266.6159 140.9508,-271.107 102,-256 80.0023,-247.4682 60.7268,-228.2936 48.1816,-213.3245"/>
<polygon fill="#ff0000" stroke="#ff0000" points="50.5858,-210.7273 41.6032,-205.1091 45.1217,-215.1026 50.5858,-210.7273"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="187.5,-205 110.5,-205 110.5,-181 187.5,-181 187.5,-205"/>
<text text-anchor="middle" x="149" y="-190.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M231.8339,-203.9586C220.7878,-202.4972 208.9398,-200.9298 197.7577,-199.4504"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="198.0903,-195.964 187.7176,-198.1222 197.1722,-202.9036 198.0903,-195.964"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="196,-327 102,-327 102,-303 196,-303 196,-327"/>
<text text-anchor="middle" x="149" y="-312.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M122.2796,-302.8781C115.2662,-299.0087 107.9949,-294.3267 102,-289 77.3847,-267.1285 56.5231,-234.9681 44.3775,-214.004"/>
<polygon fill="#ff0000" stroke="#ff0000" points="47.3922,-212.2245 39.4282,-205.2369 41.2964,-215.6657 47.3922,-212.2245"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="861,-86 782,-86 782,-62 861,-62 861,-86"/>
<text text-anchor="middle" x="821.5" y="-71.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412,-250C269.0412,-252.5374 223.0948,-412.0243 102,-336 59.4211,-309.2686 42.4898,-248.0447 36.273,-215.0433"/>
<polygon fill="#ff0000" stroke="#ff0000" points="39.6946,-214.2881 34.5539,-205.024 32.7955,-215.4719 39.6946,-214.2881"/>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="447.5,-222 376.5,-222 376.5,-198 447.5,-198 447.5,-222"/>
<text text-anchor="middle" x="412" y="-207.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="#00ffa9" stroke-dasharray="5,2" d="M549.5,-210C519.1075,-206.8298 484.7301,-206.83 457.9521,-207.6227"/>
<polygon fill="#00ffa9" stroke="#00ffa9" points="457.5908,-204.1329 447.7171,-207.9747 457.8315,-211.1288 457.5908,-204.1329"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M549.5,-210C486.2836,-202.6305 475.6442,-250.19 412,-250"/>
<path fill="none" stroke="#aa00ff" stroke-dasharray="5,2" d="M412,-250C386.9767,-249.9253 379.6075,-245.1952 359,-231 338.7532,-217.0533 345.3362,-199.2732 323,-189 283.6044,-170.8806 233.6984,-174.3328 197.4457,-180.8655"/>
<polygon fill="#aa00ff" stroke="#aa00ff" points="196.7534,-177.4345 187.6027,-182.7744 198.0862,-184.3064 196.7534,-177.4345"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="190,-41 108,-41 108,-17 190,-17 190,-41"/>
<text text-anchor="middle" x="149" y="-26.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M549.5,-210C439.6924,-198.5463 425.3005,-149.515 323,-108 283.1358,-91.8225 271.1592,-92.8164 232,-75 213.3222,-66.5021 193.1715,-55.3841 177.4025,-46.2073"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="179.0614,-43.1224 168.6686,-41.0628 175.5087,-49.1538 179.0614,-43.1224"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="465,-106 359,-106 359,-82 465,-82 465,-106"/>
<text text-anchor="middle" x="412" y="-91.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M690,-210C629.2939,-224.6312 611.6075,-216.4783 549.5,-210"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M549.5,-210C520.2908,-206.9533 459.7929,-145.7817 429.7401,-113.5288"/>
<polygon fill="#ff0000" stroke="#ff0000" points="432.1484,-110.9777 422.793,-106.005 427.0054,-115.7264 432.1484,-110.9777"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="737,-107 643,-107 643,-83 737,-83 737,-107"/>
<text text-anchor="middle" x="690" y="-92.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M781.6888,-80.3577C770.814,-82.0943 758.8117,-84.0111 747.1741,-85.8695"/>
<polygon fill="#00ffff" stroke="#00ffff" points="746.4014,-82.4485 737.0784,-87.4818 747.5053,-89.3609 746.4014,-82.4485"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="598,-46 501,-46 501,-22 598,-22 598,-46"/>
<text text-anchor="middle" x="549.5" y="-31.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M805.4568,-61.8728C790.8431,-51.6393 768.2136,-37.7628 746,-32 700.7357,-20.2573 647.6102,-21.6625 608.018,-25.5027"/>
<polygon fill="#ff0000" stroke="#ff0000" points="607.5806,-22.0293 598.0004,-26.5539 608.3111,-28.9911 607.5806,-22.0293"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="589,-126 510,-126 510,-102 589,-102 589,-126"/>
<text text-anchor="middle" x="549.5" y="-111.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M815.7158,-86.1638C800.404,-116.5043 755.4546,-194.2243 690,-210"/>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M690,-210C636.4458,-222.9075 586.3654,-166.078 563.1118,-134.2553"/>
<polygon fill="#00ffff" stroke="#00ffff" points="565.918,-132.1618 557.2838,-126.0216 560.2044,-136.2059 565.918,-132.1618"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="746,-65 634,-65 634,-41 746,-41 746,-65"/>
<text text-anchor="middle" x="690" y="-50.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M781.6888,-67.6423C773.6476,-66.3582 764.9898,-64.9756 756.3189,-63.5909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="756.597,-60.091 746.1701,-61.9701 755.493,-67.0034 756.597,-60.091"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="184,-247 114,-247 114,-223 184,-223 184,-247"/>
<text text-anchor="middle" x="149" y="-232.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M115.7591,-222.9645C103.3819,-218.4831 89.1529,-213.3312 76.0231,-208.5773"/>
<polygon fill="#ff0000" stroke="#ff0000" points="76.84,-205.1508 66.2458,-205.0373 74.4569,-211.7327 76.84,-205.1508"/>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M384.7325,-197.9445C376.2877,-193.8639 367.0829,-189.0514 359,-184 341.8108,-173.2578 340.0299,-166.993 323,-156 284.5827,-131.2012 272.2104,-129.7712 232,-108 215.9044,-99.2854 213.7182,-92.5912 196,-88 155.5579,-77.5204 138.7689,-68.165 102,-88 69.4352,-105.5671 49.7312,-145.9547 40.1424,-171.2075"/>
<polygon fill="#ff0000" stroke="#ff0000" points="36.8251,-170.0897 36.7478,-180.6842 43.4151,-172.4502 36.8251,-170.0897"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="179.5,-163 118.5,-163 118.5,-139 179.5,-139 179.5,-163"/>
<text text-anchor="middle" x="149" y="-148.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M118.2187,-162.145C105.2393,-166.8444 89.908,-172.3954 75.8529,-177.4843"/>
<polygon fill="#ff0000" stroke="#ff0000" points="74.582,-174.222 66.3709,-180.9174 76.9651,-180.8039 74.582,-174.222"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="194,-121 104,-121 104,-97 194,-97 194,-121"/>
<text text-anchor="middle" x="149" y="-106.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M117.914,-121.1897C112.4473,-123.8053 106.9336,-126.767 102,-130 83.1727,-142.3374 64.4825,-159.8105 51.3126,-173.2267"/>
<polygon fill="#ff0000" stroke="#ff0000" points="48.6437,-170.9527 44.237,-180.5876 53.6903,-175.8037 48.6437,-170.9527"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M110.3737,-193C99.3734,-193 87.3226,-193 76.0753,-193"/>
<polygon fill="#ff0000" stroke="#ff0000" points="76.0252,-189.5001 66.0251,-193 76.0251,-196.5001 76.0252,-189.5001"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M120.7133,-41.0582C114.0176,-44.8309 107.2932,-49.4817 102,-55 69.3019,-89.0889 48.9107,-141.6956 39.3867,-171.1331"/>
<polygon fill="#ff0000" stroke="#ff0000" points="35.9915,-170.2648 36.3669,-180.853 42.6763,-172.3417 35.9915,-170.2648"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="317.5,-24 237.5,-24 237.5,0 317.5,0 317.5,-24"/>
<text text-anchor="middle" x="277.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M237.1944,-17.3323C225.4639,-18.8842 212.4907,-20.6005 200.1851,-22.2284"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="199.502,-18.7882 190.0474,-23.5696 200.4201,-25.7278 199.502,-18.7882"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~initfac.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="321.5,-66 233.5,-66 233.5,-42 321.5,-42 321.5,-66"/>
<text text-anchor="middle" x="277.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ff00aa" stroke-dasharray="5,2" d="M233.2776,-45.3964C222.6056,-43.3202 211.1145,-41.0845 200.1544,-38.9522"/>
<polygon fill="#ff00aa" stroke="#ff00aa" points="200.7613,-35.5048 190.277,-37.0305 199.4245,-42.3759 200.7613,-35.5048"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M383.2836,-81.9488C375.135,-77.996 366.4571,-73.253 359,-68 340.7566,-55.1488 341.3942,-45.6345 323,-33 320.9293,-31.5777 318.7468,-30.209 316.5042,-28.9001"/>
<polygon fill="#ff0000" stroke="#ff0000" points="318.132,-25.8015 307.6651,-24.1599 314.8237,-31.9705 318.132,-25.8015"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M371.6456,-81.9987C357.9399,-77.9226 342.4498,-73.3159 328.0502,-69.0335"/>
<polygon fill="#00ffff" stroke="#00ffff" points="328.8737,-65.627 318.2908,-66.1311 326.8782,-72.3365 328.8737,-65.627"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M642.7215,-86.1454C615.5586,-81.5079 580.7363,-76.3215 549.5,-74"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M549.5,-74C487.9157,-69.423 473.0639,-63.2078 412,-54"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M412,-54C378.9685,-49.0192 342.9063,-37.4017 316.4453,-27.6449"/>
<polygon fill="#ff0000" stroke="#ff0000" points="317.3923,-24.2617 306.8003,-24.0144 314.9262,-30.8129 317.3923,-24.2617"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M412,-54C385.8365,-50.0548 356.4833,-49.6021 331.89,-50.3231"/>
<polygon fill="#00ffff" stroke="#00ffff" points="331.5299,-46.8338 321.6646,-50.6972 331.7859,-53.8292 331.5299,-46.8338"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M549.5,-74C522.9651,-72.0279 493.7697,-75.4682 469.1326,-80.023"/>
<polygon fill="#ff0000" stroke="#ff0000" points="468.3711,-76.6055 459.2277,-81.9579 469.7132,-83.4756 468.3711,-76.6055"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M656.3581,-82.9039C648.9473,-80.0952 641.1714,-77.0358 634,-74 616.9187,-66.7692 598.2486,-58.0229 582.8121,-50.5551"/>
<polygon fill="#ff0000" stroke="#ff0000" points="584.1844,-47.3304 573.6618,-46.0956 581.1177,-53.6229 584.1844,-47.3304"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M642.8247,-101.3796C628.84,-103.2707 613.4829,-105.3475 599.3355,-107.2607"/>
<polygon fill="#00ffff" stroke="#00ffff" points="598.7254,-103.8112 589.2847,-108.6199 599.6636,-110.7481 598.7254,-103.8112"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M521.6748,-46.1419C500.8011,-55.2504 472.0139,-67.8121 449.1698,-77.7804"/>
<polygon fill="#ff0000" stroke="#ff0000" points="447.5494,-74.6688 439.7838,-81.8762 450.349,-81.0845 447.5494,-74.6688"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M509.7293,-108.2152C498.994,-106.6537 487.1047,-104.9243 475.4219,-103.225"/>
<polygon fill="#ff0000" stroke="#ff0000" points="475.6422,-99.7203 465.2426,-101.7444 474.6346,-106.6474 475.6422,-99.7203"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~initfac.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M633.6628,-45.3815C625.3043,-44.2511 616.6721,-43.0838 608.2654,-41.9469"/>
<polygon fill="#ff0000" stroke="#ff0000" points="608.5354,-38.4517 598.1565,-40.5799 607.5973,-45.3885 608.5354,-38.4517"/>
</g>
</g>
</svg>
</div><script>var pansourcefileinitfacf90AfferentGraph = svgPanZoom('#sourcefileinitfacf90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/initfac.html">initfac</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/initfac.f90.html#src">initfac.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!!&gt; \file b2f.f90</span>
<a name="ln-2"></a><span class="c">!!  \author Ivo Suter</span>
<a name="ln-3"></a><span class="c">!</span>
<a name="ln-4"></a><span class="c">!   reads the necessary input files to deal with facets</span>
<a name="ln-5"></a><span class="c">!</span>
<a name="ln-6"></a><span class="c">!   WARNING: if walls with more than 3 layers (4 points) are to be considered, this file needs to be changed</span>
<a name="ln-7"></a><span class="c">!            e.g. walltypes needs to read 7+4*nlayers columns, offsets in reading facet properties also change accordingly</span>
<a name="ln-8"></a>   <span class="k">module </span><span class="n">initfac</span>
<a name="ln-9"></a>      <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">ifinput</span><span class="p">,</span> <span class="n">nblocks</span><span class="p">,</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">cexpnr</span><span class="p">,</span> <span class="n">libm</span><span class="p">,</span> <span class="n">bldT</span><span class="p">,</span> <span class="n">rsmin</span><span class="p">,</span> <span class="n">wsoil</span><span class="p">,</span> <span class="n">wfc</span><span class="p">,&amp;</span>
<a name="ln-10"></a>                          <span class="n">nwalllayers</span><span class="p">,</span> <span class="k">block</span><span class="p">,</span><span class="n">lEB</span>
<a name="ln-11"></a>      <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span><span class="n">myid</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">,</span> <span class="n">MPI_INTEGER</span><span class="p">,</span> <span class="n">MPI_DOUBLE_PRECISION</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nprocs</span><span class="p">,</span> <span class="n">cmyid</span><span class="p">,</span> <span class="n">MPI_REAL8</span><span class="p">,</span> <span class="n">MPI_REAL4</span><span class="p">,</span> <span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">mpi_logical</span>
<a name="ln-12"></a>      <span class="k">use </span><span class="n">netcdf</span>
<a name="ln-13"></a>      <span class="k">implicit none</span>
<a name="ln-14"></a><span class="k">      public</span> <span class="kd">::</span> <span class="n">readfacetfiles</span><span class="p">,</span><span class="n">qsat</span><span class="p">,</span><span class="n">dqsatdT</span>
<a name="ln-15"></a>      <span class="k">save</span>
<a name="ln-16"></a>
<a name="ln-17"></a>      <span class="c">!integer, allocatable :: block(:, :) !block coordinates and facet Nr corresponding to block faces</span>
<a name="ln-18"></a>      <span class="c">!facet properties</span>
<a name="ln-19"></a>      <span class="kt">logical</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">faclGR</span><span class="p">(:)</span> <span class="c">!logic array, is it a green (vegetated) facet?</span>
<a name="ln-20"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facz0</span><span class="p">(:)</span> <span class="c">!roughness for momentum on facets</span>
<a name="ln-21"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facz0h</span><span class="p">(:)</span> <span class="c">!roughness for heat and moisture on facets</span>
<a name="ln-22"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facalb</span><span class="p">(:)</span> <span class="c">!facet shortwave albedo</span>
<a name="ln-23"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facem</span><span class="p">(:)</span> <span class="c">!facet longwave emissivity of all 5 faces of the blocks</span>
<a name="ln-24"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facdi</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!inverse facet thickness</span>
<a name="ln-25"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facd</span><span class="p">(:,:)</span> <span class="c">!facet thickness</span>
<a name="ln-26"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faccp</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!facet specific heat capacity</span>
<a name="ln-27"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faclami</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!inverse facet heat conductivity</span>
<a name="ln-28"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fackappa</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!facet heat diffusivity (lambda/(rho cp))</span>
<a name="ln-29"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faca</span><span class="p">(:)</span> <span class="c">!facet area</span>
<a name="ln-30"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">facain</span><span class="p">(:)</span> <span class="c">!facet area as sum of indeces</span>
<a name="ln-31"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">facets</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!facet orientation, walltype, block and building Nr</span>
<a name="ln-32"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">walltypes</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!the defined wall and rooftypes with properties</span>
<a name="ln-33"></a>      <span class="c">!radiation</span>
<a name="ln-34"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">vf</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!viewfactors between facets</span>
<a name="ln-35"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">svf</span><span class="p">(:)</span> <span class="c">!sky-viewfactor of facets</span>
<a name="ln-36"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">netsw</span><span class="p">(:)</span> <span class="c">!net shortwave radiation on facets</span>
<a name="ln-37"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facLWin</span><span class="p">(:)</span> <span class="c">!incoming longwave on facets [W/m2]</span>
<a name="ln-38"></a>      <span class="c">!temperature</span>
<a name="ln-39"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">Tfacinit</span><span class="p">(:)</span> <span class="c">!initial facet temperatures</span>
<a name="ln-40"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facT</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!wall temperatures on surfaces and between layers (1=outdoors,end=indoors)</span>
<a name="ln-41"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facTdash</span><span class="p">(:,</span> <span class="p">:)</span><span class="c">!temperature gradient dT/dz</span>
<a name="ln-42"></a>      <span class="c">!fluxes</span>
<a name="ln-43"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facef</span><span class="p">(:)</span> <span class="c">!evaporative flux on facets [W/m2] (single processor)</span>
<a name="ln-44"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facefi</span><span class="p">(:)</span> <span class="c">!time integrated latent heat flux [J/m2] (used in modEB)</span>
<a name="ln-45"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facefsum</span><span class="p">(:)</span> <span class="c">!evaporative flux on facets [W/m2] (sum over all processors)</span>
<a name="ln-46"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachf</span><span class="p">(:)</span> <span class="c">!heat flux on facets [Km/s] (single processor)</span>
<a name="ln-47"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachfi</span><span class="p">(:)</span> <span class="c">!time integrated heat flux [Km]</span>
<a name="ln-48"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachfsum</span><span class="p">(:)</span> <span class="c">!heat flux on facets [Km/s] (sum over all processors)</span>
<a name="ln-49"></a>      <span class="c">!GR</span>
<a name="ln-50"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facf</span><span class="p">(:,</span> <span class="p">:)</span> <span class="c">!dependence of stomatal resistance/soil resistance</span>
<a name="ln-51"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">fachurel</span><span class="p">(:)</span> <span class="c">!relative humidity at ground surface</span>
<a name="ln-52"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facwsoil</span><span class="p">(:)</span> <span class="c">!soil moisture of facets</span>
<a name="ln-53"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">faccth</span><span class="p">(:)</span> <span class="c">!sum of all transfer coefficients of the facet, used in Penman Moneith, unused</span>
<a name="ln-54"></a>      <span class="kt">real</span><span class="p">,</span> <span class="k">allocatable</span>    <span class="kd">::</span> <span class="n">facqsat</span><span class="p">(:)</span> <span class="c">!saturation absoulute humidity at facet temperature</span>
<a name="ln-55"></a>
<a name="ln-56"></a>      <span class="c">!misc</span>
<a name="ln-57"></a>      <span class="kt">integer</span><span class="p">,</span> <span class="k">allocatable</span> <span class="kd">::</span> <span class="n">typeloc</span><span class="p">(:)</span> <span class="c">!array to match the walltype to sequential integers for indexing</span>
<a name="ln-58"></a>      <span class="kt">integer</span>              <span class="kd">::</span> <span class="n">nwalltypes</span> <span class="o">=</span> <span class="mi">0</span> <span class="c">!number of different walltypes, will be determined automatically</span>
<a name="ln-59"></a>      <span class="kt">character</span><span class="p">(</span><span class="mi">80</span><span class="p">)</span>        <span class="kd">::</span> <span class="n">chmess</span> <span class="c">!dummy character string</span>
<a name="ln-60"></a>      <span class="kt">integer</span>              <span class="kd">::</span> <span class="n">nwallprops</span>
<a name="ln-61"></a>
<a name="ln-62"></a>   <span class="k">contains</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="k">      subroutine </span><span class="n">readfacetfiles</span>
<a name="ln-65"></a>      <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span><span class="p">:</span> <span class="k">block</span><span class="p">,</span> <span class="n">cexpnr</span><span class="p">,</span> <span class="n">iwalltemp</span>
<a name="ln-66"></a>      <span class="k">implicit none</span>
<a name="ln-67"></a>
<a name="ln-68"></a>      <span class="c">!use modglobal, only:block</span>
<a name="ln-69"></a>      <span class="c">!read initial&amp;unchangeable facet values from files</span>
<a name="ln-70"></a>      <span class="c">!read blocks and facet Nr corresponding to block faces (Order: Top, West, East, North, South)</span>
<a name="ln-71"></a>      <span class="c">!define facets with properties and initial temperature</span>
<a name="ln-72"></a>      <span class="c">!read facets.inp.xxx facetarea.inp.xxx vf.inp.xxx walltypes.inp.xxx</span>
<a name="ln-73"></a>      <span class="c">!read netsw.inp.xxx (if sun is not constant, K needs to be calculated at every EB-timestep)</span>
<a name="ln-74"></a>      <span class="c">!read tfacinit.inp.xxx</span>
<a name="ln-75"></a>      <span class="c">!use modglobal, only : nblocks, nfcts, cexpnr, ifinput</span>
<a name="ln-76"></a>      <span class="kt">character</span> <span class="p">(</span><span class="nb">len</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span> <span class="kd">::</span> <span class="n">FILE_VF</span> <span class="o">=</span> <span class="s1">&#39;vf.nc.inp.xxx&#39;</span>
<a name="ln-77"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ncid</span><span class="p">,</span> <span class="n">varid</span>
<a name="ln-78"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">k</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">io</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-79"></a>      <span class="kt">integer</span> <span class="kd">::</span> <span class="n">iret</span>
<a name="ln-80"></a>
<a name="ln-81"></a>      <span class="k">if</span> <span class="p">(.</span><span class="nb">not</span><span class="p">.(</span><span class="n">nfcts</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">))</span> <span class="k">return</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="k">      </span><span class="n">nwallprops</span> <span class="o">=</span> <span class="mi">6</span> <span class="o">+</span> <span class="mi">4</span><span class="o">*</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-84"></a>      <span class="c">!allocate (block(nblocks, 11))</span>
<a name="ln-85"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faclGR</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-86"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facz0</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span> <span class="c">!0 is the default value (e.g. for internal walls)</span>
<a name="ln-87"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facz0h</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-88"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facalb</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-89"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facem</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-90"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-91"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-92"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-93"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="p">))</span>
<a name="ln-94"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-95"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faca</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-96"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facain</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-97"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<a name="ln-98"></a>
<a name="ln-99"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span> <span class="k">then</span>
<a name="ln-100"></a><span class="k">        allocate</span> <span class="p">(</span><span class="n">vf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-101"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">svf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-102"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">netsw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-103"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">facLWin</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-104"></a>      <span class="k">end if</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="k">      allocate</span> <span class="p">(</span><span class="n">Tfacinit</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-107"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-108"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facTdash</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-109"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-110"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facefi</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-111"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facefsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-112"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-113"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachfi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-114"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachfsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-115"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<a name="ln-116"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">fachurel</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-117"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facwsoil</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-118"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">faccth</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-119"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">facqsat</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">))</span>
<a name="ln-120"></a>
<a name="ln-121"></a>      <span class="c">!block = 0;</span>
<a name="ln-122"></a>      <span class="n">faclGR</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.;</span> <span class="n">facz0</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facz0h</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facalb</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facem</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facd</span><span class="o">=</span><span class="mf">0.</span><span class="p">;</span> <span class="n">facdi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">faccp</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-123"></a>      <span class="n">faclami</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fackappa</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">faca</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facain</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">facets</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-124"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span> <span class="k">then</span>
<a name="ln-125"></a><span class="k">        </span><span class="n">vf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">svf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">netsw</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facLWin</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-126"></a>      <span class="k">end if</span>
<a name="ln-127"></a><span class="k">      </span><span class="n">Tfacinit</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facT</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facTdash</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-128"></a>      <span class="n">facef</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facefi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facefsum</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachfi</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachfsum</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-129"></a>      <span class="n">facf</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">fachurel</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facwsoil</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">faccth</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span> <span class="n">facqsat</span> <span class="o">=</span> <span class="mf">0.</span><span class="p">;</span>
<a name="ln-130"></a>
<a name="ln-131"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="n">libm</span><span class="p">)</span> <span class="k">then</span> <span class="c">! read blocks corner coordinates and facet-Nr correspoinding to the block sides</span>
<a name="ln-132"></a>      <span class="c">!   open (ifinput, file=&#39;blocks.inp.&#39;//cexpnr)</span>
<a name="ln-133"></a>      <span class="c">!   read (ifinput, &#39;(a80)&#39;) chmess</span>
<a name="ln-134"></a>      <span class="c">!   read (ifinput, &#39;(a80)&#39;) chmess</span>
<a name="ln-135"></a>      <span class="c">!   do n = 1, nblocks</span>
<a name="ln-136"></a>      <span class="c">!     blockfile is :ilow iheigh jlow jheigh klow kheigh facTop facWest facEast facNorth facSouth</span>
<a name="ln-137"></a>      <span class="c">!     read (ifinput, *) &amp;</span>
<a name="ln-138"></a>      <span class="c">!         block(n, 1), &amp;</span>
<a name="ln-139"></a>      <span class="c">!         block(n, 2), &amp;</span>
<a name="ln-140"></a>      <span class="c">!         block(n, 3), &amp;</span>
<a name="ln-141"></a>      <span class="c">!         block(n, 4), &amp;</span>
<a name="ln-142"></a>      <span class="c">!         block(n, 5), &amp;</span>
<a name="ln-143"></a>      <span class="c">!         block(n, 6), &amp;</span>
<a name="ln-144"></a>      <span class="c">!         block(n, 7), &amp;</span>
<a name="ln-145"></a>      <span class="c">!         block(n, 8), &amp;</span>
<a name="ln-146"></a>      <span class="c">!         block(n, 9), &amp;</span>
<a name="ln-147"></a>      <span class="c">!         block(n, 10), &amp;</span>
<a name="ln-148"></a>      <span class="c">!         block(n, 11)</span>
<a name="ln-149"></a>      <span class="c">!   end do</span>
<a name="ln-150"></a>      <span class="c">!   close (ifinput)</span>
<a name="ln-151"></a>
<a name="ln-152"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-153"></a>        <span class="c">! read facet areas</span>
<a name="ln-154"></a>          <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;facetarea.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-155"></a>          <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-156"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-157"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-158"></a>              <span class="n">faca</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-159"></a>          <span class="k">end do</span>
<a name="ln-160"></a><span class="k">          close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-161"></a>          <span class="k">write</span> <span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="s2">&quot;faca&quot;</span><span class="p">,</span> <span class="n">faca</span>
<a name="ln-162"></a>        <span class="k">end if</span> <span class="c">!lEB</span>
<a name="ln-163"></a>
<a name="ln-164"></a>        <span class="c">! read wall &amp; (green) roof types</span>
<a name="ln-165"></a>        <span class="c">! read once to determine number of types, allocate, read again</span>
<a name="ln-166"></a>        <span class="n">nwalltypes</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span> <span class="c">!3 lines as headers</span>
<a name="ln-167"></a>        <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;walltypes.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-168"></a>        <span class="k">do</span>
<a name="ln-169"></a><span class="k">          read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">iostat</span><span class="o">=</span><span class="n">io</span><span class="p">)</span>
<a name="ln-170"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">io</span> <span class="o">/=</span> <span class="mi">0</span><span class="p">)</span> <span class="k">exit</span>
<a name="ln-171"></a><span class="k">          </span><span class="n">nwalltypes</span> <span class="o">=</span> <span class="n">nwalltypes</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-172"></a>        <span class="k">end do</span>
<a name="ln-173"></a><span class="k">        close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-174"></a>      <span class="k">end if</span> <span class="c">!(myid == 0 .and. libm)</span>
<a name="ln-175"></a>
<a name="ln-176"></a>      <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-177"></a>      <span class="k">allocate</span> <span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="n">nwallprops</span><span class="p">))</span>
<a name="ln-178"></a>
<a name="ln-179"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-180"></a><span class="k">        </span><span class="n">walltypes</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-181"></a>        <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;walltypes.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-182"></a>        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-183"></a>        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-184"></a>        <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-185"></a>
<a name="ln-186"></a>        <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalltypes</span>
<a name="ln-187"></a>          <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">m</span><span class="p">),</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nwallprops</span><span class="p">)</span>
<a name="ln-188"></a>        <span class="k">end do</span>
<a name="ln-189"></a><span class="k">        close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-190"></a>      <span class="k">end if</span> <span class="c">!myid==0</span>
<a name="ln-191"></a>
<a name="ln-192"></a>        <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-193"></a>        <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">walltypes</span><span class="p">,</span> <span class="n">nwallprops</span><span class="o">*</span><span class="n">nwalltypes</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-194"></a>
<a name="ln-195"></a>        <span class="c">!create an array mapping walltypes to sequential integers for indexing</span>
<a name="ln-196"></a>        <span class="c">!e.g. lets assume walltype -3,-1,1,2,3 and 5 are defined.</span>
<a name="ln-197"></a>        <span class="c">!index: [-3,-2,-1,0,1,2,3,4,5]  -&gt; [-3,-2,-1,0,1,2,3,4,5]</span>
<a name="ln-198"></a>        <span class="c">!value: [ 0, 0, 0,0,0,0,0,0,0]  -&gt; [ 1, 0, 2,0,3,4,5,0,6]</span>
<a name="ln-199"></a>        <span class="k">allocate</span> <span class="p">(</span><span class="n">typeloc</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="nb">minval</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">))):</span><span class="nb">int</span><span class="p">(</span><span class="nb">maxval</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(:,</span> <span class="mi">1</span><span class="p">)))))</span>
<a name="ln-200"></a>
<a name="ln-201"></a>        <span class="k">if</span> <span class="p">(</span><span class="n">myid</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">0</span><span class="p">)</span> <span class="k">then</span>  <span class="c">!all the read processes just need to be done on one processor</span>
<a name="ln-202"></a>          <span class="n">typeloc</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-203"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalltypes</span>
<a name="ln-204"></a>            <span class="n">typeloc</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span> <span class="o">=</span> <span class="n">n</span>
<a name="ln-205"></a>          <span class="k">end do</span>
<a name="ln-206"></a>
<a name="ln-207"></a>          <span class="c">! read the facets</span>
<a name="ln-208"></a>          <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;facets.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-209"></a>          <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-210"></a>          <span class="c">!orientation, walltype, block in block.inp, original block/building</span>
<a name="ln-211"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-212"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-213"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-214"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-215"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="p">&amp;</span>
<a name="ln-216"></a>              <span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<a name="ln-217"></a>          <span class="k">end do</span>
<a name="ln-218"></a><span class="k">          close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-219"></a>
<a name="ln-220"></a>          <span class="c">! calculate the number of indeces per facet in both dimensions (~area)</span>
<a name="ln-221"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-222"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">1</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-223"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-224"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">2</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-225"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-226"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">3</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-227"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">3</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-228"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">4</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-229"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-230"></a>            <span class="k">else if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="p">.</span><span class="n">eq</span><span class="p">.</span> <span class="mi">5</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-231"></a><span class="k">              </span><span class="n">facain</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">6</span><span class="p">)</span> <span class="o">-</span> <span class="k">block</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">3</span><span class="p">),</span> <span class="mi">5</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-232"></a>            <span class="k">end if</span>
<a name="ln-233"></a><span class="k">          end do</span>
<a name="ln-234"></a>
<a name="ln-235"></a>          <span class="c">! assign the facet properties to their own arrays</span>
<a name="ln-236"></a>          <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-237"></a>            <span class="n">i</span> <span class="o">=</span> <span class="n">typeloc</span><span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<a name="ln-238"></a>            <span class="n">faclGR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">-</span> <span class="mf">1.00</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0D-5</span><span class="p">)</span> <span class="c">!logic for green surface, conversion from real to logical</span>
<a name="ln-239"></a>            <span class="n">facz0</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>  <span class="c">!surface momentum roughness</span>
<a name="ln-240"></a>            <span class="n">facz0h</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span> <span class="c">!surface heat &amp; moisture roughness</span>
<a name="ln-241"></a>            <span class="n">facalb</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span> <span class="c">!surface shortwave albedo</span>
<a name="ln-242"></a>            <span class="n">facem</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="mi">6</span><span class="p">)</span>  <span class="c">!surface longwave emissivity</span>
<a name="ln-243"></a>
<a name="ln-244"></a>            <span class="k">if</span> <span class="p">(</span><span class="n">facets</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="n">lt</span><span class="p">.</span> <span class="o">-</span><span class="mi">100</span><span class="p">)</span> <span class="k">then</span> <span class="c">!it&#39;s a bounding wall</span>
<a name="ln-245"></a>              <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalllayers</span> <span class="c">!bounding walls don&#39;t need properties</span>
<a name="ln-246"></a>                <span class="n">facdi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">!bounding walls have no energy balance</span>
<a name="ln-247"></a>                <span class="n">facd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>       <span class="c">!bounding walls have no thickness</span>
<a name="ln-248"></a>                <span class="n">faclami</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span> <span class="c">!bounding walls have no energy balance</span>
<a name="ln-249"></a>                <span class="n">faccp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.</span>   <span class="c">!bounding walls have no heat capacity</span>
<a name="ln-250"></a>              <span class="k">end do</span>
<a name="ln-251"></a><span class="k">            else</span>
<a name="ln-252"></a><span class="k">              do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nwalllayers</span> <span class="c">!for all layers</span>
<a name="ln-253"></a>                <span class="n">facdi</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span> <span class="o">+</span> <span class="mi">6</span><span class="p">)</span> <span class="c">!inverse of facet thickness of layer j</span>
<a name="ln-254"></a>                <span class="n">facd</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span> <span class="c">!facet thickness of layer j</span>
<a name="ln-255"></a>                <span class="n">faclami</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">12</span><span class="p">)</span> <span class="c">!inverse of heat conductivity of layer j</span>
<a name="ln-256"></a>                <span class="n">faccp</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">9</span><span class="p">)</span> <span class="c">!specific heat capacity of layer j</span>
<a name="ln-257"></a>              <span class="k">end do</span>
<a name="ln-258"></a><span class="k">            end if</span>
<a name="ln-259"></a>
<a name="ln-260"></a><span class="k">            do </span><span class="n">j</span><span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span>
<a name="ln-261"></a>              <span class="n">fackappa</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">walltypes</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="o">+</span><span class="mi">15</span><span class="p">)</span> <span class="c">!heat duffusivity of layer 1</span>
<a name="ln-262"></a>            <span class="k">end do</span>
<a name="ln-263"></a><span class="k">          end do</span>
<a name="ln-264"></a>
<a name="ln-265"></a>          <span class="c">!give some dummy values for block internal facets (i.e. facets with walltype 0)</span>
<a name="ln-266"></a>          <span class="n">facz0</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00999</span><span class="p">;</span> <span class="n">facz0h</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00999</span><span class="p">;</span> <span class="n">facalb</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facem</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.999</span><span class="p">;</span> <span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">0.999</span><span class="p">;</span> <span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.</span><span class="p">;</span> <span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.</span>
<a name="ln-267"></a>          <span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mi">99</span><span class="mf">9.</span><span class="p">;</span> <span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.999</span><span class="p">;</span> <span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00000999</span><span class="p">;</span> <span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00000999</span><span class="p">;</span> <span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.00000999</span><span class="p">;</span> <span class="n">faclGR</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-268"></a>
<a name="ln-269"></a>          <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-270"></a>            <span class="c">! read viewfactors between facets</span>
<a name="ln-271"></a>            <span class="c">! Open the file. NF90_NOWRITE tells netCDF we want read-only access to</span>
<a name="ln-272"></a>            <span class="c">! the file.</span>
<a name="ln-273"></a>            <span class="n">FILE_VF</span> <span class="o">=</span> <span class="s1">&#39;vf.nc.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span>
<a name="ln-274"></a>            <span class="n">iret</span> <span class="o">=</span> <span class="n">nf90_open</span><span class="p">(</span><span class="n">FILE_VF</span><span class="p">,</span> <span class="n">NF90_NOWRITE</span><span class="p">,</span> <span class="n">ncid</span><span class="p">)</span> <span class="c">! Get the varid of the data variable, based on its name.</span>
<a name="ln-275"></a>            <span class="n">iret</span> <span class="o">=</span> <span class="n">nf90_inq_varid</span><span class="p">(</span><span class="n">ncid</span><span class="p">,</span> <span class="s2">&quot;view factor&quot;</span><span class="p">,</span> <span class="n">varid</span><span class="p">)</span>
<a name="ln-276"></a>            <span class="c">! Read the data.</span>
<a name="ln-277"></a>            <span class="n">iret</span> <span class="o">=</span> <span class="n">nf90_get_var</span><span class="p">(</span><span class="n">ncid</span><span class="p">,</span> <span class="n">varid</span><span class="p">,</span> <span class="n">vf</span><span class="p">)</span>
<a name="ln-278"></a>            <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s2">&quot;vf(1,6),vf(1,7),vf(6,1),vf(7,1)&quot;</span><span class="p">,</span><span class="n">vf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">),</span><span class="n">vf</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">7</span><span class="p">),</span><span class="n">vf</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span><span class="n">vf</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-279"></a>
<a name="ln-280"></a>            <span class="c">! read skyviewfactors</span>
<a name="ln-281"></a>            <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;svf.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-282"></a>            <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-283"></a>            <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-284"></a>              <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-285"></a>                <span class="n">svf</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-286"></a>              <span class="k">end do</span>
<a name="ln-287"></a><span class="k">              close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-288"></a>
<a name="ln-289"></a>              <span class="c">! read net shortwave radiation</span>
<a name="ln-290"></a>              <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;netsw.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-291"></a>              <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-292"></a>              <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-293"></a>                <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-294"></a>                  <span class="n">netsw</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-295"></a>              <span class="k">end do</span>
<a name="ln-296"></a><span class="k">              close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-297"></a>            <span class="k">end if</span> <span class="c">!lEB</span>
<a name="ln-298"></a>
<a name="ln-299"></a>            <span class="k">if</span> <span class="p">((</span><span class="n">lEB</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">iwalltemp</span> <span class="o">==</span> <span class="mi">2</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-300"></a>              <span class="c">! read initial facet temepratures</span>
<a name="ln-301"></a>              <span class="k">open</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="k">file</span><span class="o">=</span><span class="s1">&#39;Tfacinit.inp.&#39;</span><span class="o">//</span><span class="n">cexpnr</span><span class="p">)</span>
<a name="ln-302"></a>              <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="s1">&#39;(a80)&#39;</span><span class="p">)</span> <span class="n">chmess</span>
<a name="ln-303"></a>              <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-304"></a>                <span class="k">read</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">,</span> <span class="o">*</span><span class="p">)</span> <span class="p">&amp;</span>
<a name="ln-305"></a>                  <span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<a name="ln-306"></a>              <span class="k">end do</span>
<a name="ln-307"></a><span class="k">              close</span> <span class="p">(</span><span class="n">ifinput</span><span class="p">)</span>
<a name="ln-308"></a>
<a name="ln-309"></a>              <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-310"></a>                <span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="c">!building surfaces is given an initial temperature</span>
<a name="ln-311"></a>                <span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">bldT</span> <span class="c">!inner most layer has the same temperature as the building interior</span>
<a name="ln-312"></a>                <span class="k">do </span><span class="n">j</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span><span class="n">nwalllayers</span>
<a name="ln-313"></a>                  <span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="n">j</span><span class="p">)</span> <span class="o">=</span> <span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="p">(</span><span class="n">Tfacinit</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">-</span><span class="n">bldT</span><span class="p">)</span><span class="o">/</span><span class="n">nwalllayers</span><span class="o">*</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span> <span class="c">!scale linearly inside the wall</span>
<a name="ln-314"></a>                <span class="k">end do</span>
<a name="ln-315"></a><span class="k">              end do</span>
<a name="ln-316"></a>
<a name="ln-317"></a><span class="k">              do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span><span class="n">nwalllayers</span>
<a name="ln-318"></a>                 <span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="mi">28</span><span class="mf">8.</span>
<a name="ln-319"></a>              <span class="k">end do</span>
<a name="ln-320"></a><span class="k">              </span><span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">29</span><span class="mf">9.</span>
<a name="ln-321"></a>            <span class="k">end if</span> <span class="c">!((lEB) .or. (iwalltemp == 2))</span>
<a name="ln-322"></a>
<a name="ln-323"></a>            <span class="c">! assign initial soil moisture (only outermost layer)</span>
<a name="ln-324"></a>            <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-325"></a>              <span class="k">if</span> <span class="p">(</span><span class="n">faclGR</span><span class="p">(</span><span class="n">n</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-326"></a><span class="k">                </span><span class="n">facwsoil</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">wsoil</span>
<a name="ln-327"></a>                <span class="n">fachurel</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="p">(</span><span class="mf">1.</span> <span class="o">-</span> <span class="nb">cos</span><span class="p">(</span><span class="mf">3.14159</span><span class="o">*</span><span class="n">wsoil</span><span class="o">/</span><span class="n">wfc</span><span class="p">))</span>
<a name="ln-328"></a>              <span class="k">end if</span>
<a name="ln-329"></a><span class="k">            end do</span>
<a name="ln-330"></a>
<a name="ln-331"></a><span class="k">         end if</span> <span class="c">!(myid .eq. 0)</span>
<a name="ln-332"></a>
<a name="ln-333"></a>         <span class="c">!write (*, *) &quot;starting broadcast of facet properties&quot;</span>
<a name="ln-334"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="k">block</span><span class="p">,</span> <span class="mi">11</span><span class="o">*</span><span class="n">nblocks</span><span class="p">,</span> <span class="n">MPI_INTEGER</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-335"></a>         <span class="c">!many of these are actually only needed on processor 0...</span>
<a name="ln-336"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faclGR</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">mpi_logical</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-337"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facz0</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-338"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facz0h</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-339"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facalb</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-340"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facem</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-341"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facd</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span><span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),(</span><span class="n">nfcts</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-342"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facdi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-343"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faccp</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-344"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faclami</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">nwalllayers</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-345"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fackappa</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-346"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faca</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-347"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facain</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-348"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facets</span><span class="p">,</span> <span class="mi">4</span><span class="o">*</span><span class="n">nfcts</span><span class="p">,</span> <span class="n">MPI_Integer</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-349"></a>         <span class="c">!walltypes is broadcast further up</span>
<a name="ln-350"></a>         <span class="k">if</span> <span class="p">(</span><span class="n">lEB</span> <span class="p">.</span><span class="n">eqv</span><span class="p">.</span> <span class="p">.</span><span class="n">true</span><span class="p">.)</span> <span class="k">then</span>
<a name="ln-351"></a><span class="k">           call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">svf</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-352"></a>           <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">netsw</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-353"></a>         <span class="k">end if</span>
<a name="ln-354"></a>         <span class="c">!facLWin currently not being broadcast..</span>
<a name="ln-355"></a>         <span class="c">!vf currently not being broadcast</span>
<a name="ln-356"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">Tfacinit</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-357"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facT</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-358"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facTdash</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">nwalllayers</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-359"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facef</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-360"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facefi</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-361"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facefsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-362"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-363"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachfi</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-364"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachfsum</span><span class="p">(</span><span class="mi">1</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-365"></a>         <span class="c">! standard plant &amp; soil resistance for grass (Manickathan2018) in s/m</span>
<a name="ln-366"></a>         <span class="n">facf</span><span class="p">(:,</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">20</span><span class="mf">0.</span>
<a name="ln-367"></a>         <span class="n">facf</span><span class="p">(:,</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="mf">0.</span>
<a name="ln-368"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facf</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">,</span> <span class="mi">1</span><span class="p">:</span><span class="mi">5</span><span class="p">),</span> <span class="p">(</span><span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="mi">5</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-369"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">fachurel</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-370"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facwsoil</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-371"></a>         <span class="k">call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">faccth</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-372"></a>         <span class="k">do </span><span class="n">n</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">nfcts</span>
<a name="ln-373"></a>         <span class="n">facqsat</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="o">=</span> <span class="n">qsat</span><span class="p">(</span><span class="n">facT</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
<a name="ln-374"></a>         <span class="k">end do</span>
<a name="ln-375"></a><span class="k">         call </span><span class="n">MPI_BCAST</span><span class="p">(</span><span class="n">facqsat</span><span class="p">(</span><span class="mi">0</span><span class="p">:</span><span class="n">nfcts</span><span class="p">),</span> <span class="n">nfcts</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span><span class="p">)</span>
<a name="ln-376"></a>
<a name="ln-377"></a>
<a name="ln-378"></a>      <span class="k">end subroutine </span><span class="n">readfacetfiles</span>
<a name="ln-379"></a>
<a name="ln-380"></a>      <span class="kt">real </span><span class="k">function </span><span class="n">qsat</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-381"></a>         <span class="k">implicit none</span>
<a name="ln-382"></a><span class="k">         </span><span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T</span>
<a name="ln-383"></a>         <span class="kt">real</span> <span class="kd">::</span> <span class="n">gres</span>
<a name="ln-384"></a>         <span class="n">gres</span> <span class="o">=</span> <span class="mi">61</span><span class="mf">1.00</span><span class="o">*</span><span class="nb">exp</span><span class="p">(</span><span class="mi">1</span><span class="mf">7.27</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">27</span><span class="mf">3.15</span><span class="p">)</span><span class="o">/</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">3</span><span class="mf">5.85</span><span class="p">))</span> <span class="c">![Pa] Bolton 1980</span>
<a name="ln-385"></a>         <span class="n">qsat</span> <span class="o">=</span> <span class="mf">0.62198</span><span class="o">*</span><span class="mf">0.01</span><span class="o">*</span><span class="n">gres</span><span class="o">/</span><span class="p">(</span><span class="mi">1000</span><span class="o">-</span><span class="mf">0.01</span><span class="o">*</span><span class="n">gres</span><span class="p">)</span> <span class="c">![kg/kg] Murphy &amp; Koop 2005 !1000 can be replaced with actual air pressure if desired</span>
<a name="ln-386"></a>      <span class="k">end function </span><span class="n">qsat</span>
<a name="ln-387"></a>
<a name="ln-388"></a>      <span class="kt">real </span><span class="k">function </span><span class="n">dqsatdT</span><span class="p">(</span><span class="n">T</span><span class="p">)</span>
<a name="ln-389"></a>         <span class="k">implicit none</span>
<a name="ln-390"></a><span class="k">         </span><span class="kt">real</span><span class="p">,</span> <span class="k">intent</span><span class="p">(</span><span class="n">in</span><span class="p">)</span> <span class="kd">::</span> <span class="n">T</span>
<a name="ln-391"></a>         <span class="n">dqsatdT</span> <span class="o">=</span> <span class="mf">0.1384832710e-2</span> <span class="o">+</span> <span class="mf">0.7708409674e-4</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.2022064593e-5</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="mf">0.000000036561</span><span class="o">*</span><span class="p">(</span><span class="n">T</span> <span class="o">-</span> <span class="mi">300</span><span class="p">)</span><span class="o">**</span><span class="mi">3</span> <span class="c">!expansion of qsat(T)</span>
<a name="ln-392"></a>      <span class="k">end function </span><span class="n">dqsatdt</span>
<a name="ln-393"></a>
<a name="ln-394"></a>   <span class="k">end module </span><span class="n">initfac</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>