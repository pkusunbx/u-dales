<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modsave.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>modsave.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 0.5% of total for source files.">70 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modsave.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">modsave.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modsave.html">modsave</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modsave.f90.html#src">modsave.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">This file depends on</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modsave.f90~~EfferentGraph Pages: 1 -->
<svg id="sourcefilemodsavef90EfferentGraph" width="486pt" height="307pt"
 viewBox="0.00 0.00 486.00 306.52" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modsave.f90~~EfferentGraph" class="graph" transform="scale(1 1) rotate(0) translate(4 302.516)">
<title>sourcefile~~modsave.f90~~EfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-302.516 482,-302.516 482,4 -4,4"/>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node1" class="node">
<title>sourcefile~modsave.f90</title>
<polygon fill="none" stroke="#000000" points="478,-170 396,-170 396,-146 478,-146 478,-170"/>
<text text-anchor="middle" x="437" y="-155.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modsave.f90</text>
</g>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node2" class="node">
<title>sourcefile~modmpi.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node2"><a xlink:href=".././sourcefile/modmpi.f90.html" xlink:title="modmpi.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="77,-108 0,-108 0,-84 77,-84 77,-108"/>
<text text-anchor="middle" x="38.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modmpi.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge1" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M433.6536,-170.3588C425.8355,-196.4706 403.6385,-256.8343 360,-281 312.9542,-307.0526 289.0876,-300.5775 239,-281 152.8765,-247.3374 81.5015,-157.4213 52.4699,-116.6319"/>
<polygon fill="#ff0000" stroke="#ff0000" points="55.2195,-114.4564 46.6214,-108.2657 49.4824,-118.467 55.2195,-114.4564"/>
</g>
<!-- sourcefile~modibmdata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node3" class="node">
<title>sourcefile~modibmdata.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node3"><a xlink:href=".././sourcefile/modibmdata.f90.html" xlink:title="modibmdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-272 249,-272 249,-248 350,-248 350,-272"/>
<text text-anchor="middle" x="299.5" y="-257.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibmdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modibmdata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge2" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modibmdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M428.4326,-170.1763C415.4987,-187.7229 389.3577,-220.083 360,-239 357.4196,-240.6627 354.6921,-242.211 351.8793,-243.6503"/>
<polygon fill="#ff0000" stroke="#ff0000" points="350.3023,-240.5231 342.6805,-247.8824 353.228,-246.8824 350.3023,-240.5231"/>
</g>
<!-- sourcefile~modinletdata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node4" class="node">
<title>sourcefile~modinletdata.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node4"><a xlink:href=".././sourcefile/modinletdata.f90.html" xlink:title="modinletdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="351.5,-230 247.5,-230 247.5,-206 351.5,-206 351.5,-230"/>
<text text-anchor="middle" x="299.5" y="-215.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinletdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modinletdata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge3" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modinletdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M409.9462,-170.0242C395.1973,-176.5597 376.6125,-184.7629 360,-192 352.6306,-195.2104 344.7454,-198.6187 337.1836,-201.8739"/>
<polygon fill="#ff0000" stroke="#ff0000" points="335.647,-198.7247 327.8415,-205.8889 338.411,-205.1559 335.647,-198.7247"/>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node5" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node5"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-108 113,-108 113,-84 203,-84 203,-108"/>
<text text-anchor="middle" x="158" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge4" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M395.9146,-165.9044C354.9595,-172.0268 290.8611,-176.794 239,-159 214.0316,-150.4332 190.831,-130.6779 175.7164,-115.5558"/>
<polygon fill="#ff0000" stroke="#ff0000" points="178.0425,-112.9256 168.5829,-108.154 173.0022,-117.7832 178.0425,-112.9256"/>
</g>
<!-- sourcefile~modsurfdata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node6" class="node">
<title>sourcefile~modsurfdata.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node6"><a xlink:href=".././sourcefile/modsurfdata.f90.html" xlink:title="modsurfdata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="350,-150 249,-150 249,-126 350,-126 350,-150"/>
<text text-anchor="middle" x="299.5" y="-135.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsurfdata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modsurfdata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge5" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modsurfdata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M395.7455,-151.9993C384.6214,-150.3813 372.3475,-148.596 360.3945,-146.8574"/>
<polygon fill="#ff0000" stroke="#ff0000" points="360.8615,-143.3886 350.4618,-145.4126 359.8538,-150.3157 360.8615,-143.3886"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node7" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node7"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="342,-108 257,-108 257,-84 342,-84 342,-108"/>
<text text-anchor="middle" x="299.5" y="-93.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge6" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M416.5163,-145.9695C401.2446,-137.2793 379.709,-125.6058 360,-117 355.8176,-115.1738 351.4211,-113.3933 346.9866,-111.6909"/>
<polygon fill="#ff0000" stroke="#ff0000" points="347.8795,-108.2894 337.2863,-108.1011 345.45,-114.8543 347.8795,-108.2894"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node8" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node8"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="332.5,-66 266.5,-66 266.5,-42 332.5,-42 332.5,-66"/>
<text text-anchor="middle" x="299.5" y="-51.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge7" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M428.7157,-145.8111C415.9457,-127.8887 389.7881,-94.4519 360,-75 354.5629,-71.4495 348.4575,-68.426 342.2719,-65.8738"/>
<polygon fill="#ff0000" stroke="#ff0000" points="343.1625,-62.4701 332.57,-62.2432 340.7091,-69.0261 343.1625,-62.4701"/>
</g>
<!-- sourcefile~modsubgriddata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_node9" class="node">
<title>sourcefile~modsubgriddata.f90</title>
<g id="a_sourcefile~~modsave.f90~~EfferentGraph_node9"><a xlink:href=".././sourcefile/modsubgriddata.f90.html" xlink:title="modsubgriddata.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="360,-24 239,-24 239,0 360,0 360,-24"/>
<text text-anchor="middle" x="299.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgriddata.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modsubgriddata.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge8" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modsubgriddata.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M432.7136,-145.7728C423.3977,-120.9317 398.9583,-64.2725 360,-33 358.2036,-31.558 356.3017,-30.2119 354.3231,-28.9555"/>
<polygon fill="#ff0000" stroke="#ff0000" points="355.7014,-25.7205 345.2467,-24.0033 352.3487,-31.8654 355.7014,-25.7205"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge9" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#00ff3f" stroke-dasharray="5,2" d="M112.8222,-96C104.4581,-96 95.6884,-96 87.2244,-96"/>
<polygon fill="#00ff3f" stroke="#00ff3f" points="87.0997,-92.5001 77.0997,-96 87.0997,-99.5001 87.0997,-92.5001"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge10" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#003fff" stroke-dasharray="5,2" d="M256.6613,-96C243.0467,-96 227.7899,-96 213.4194,-96"/>
<polygon fill="#003fff" stroke="#003fff" points="213.1484,-92.5001 203.1484,-96 213.1483,-99.5001 213.1484,-92.5001"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge11" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M266.2366,-56.1063C228.7391,-58.8593 166.0791,-64.6024 113,-75 104.3767,-76.6892 95.2979,-78.8856 86.559,-81.2199"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="85.586,-77.8575 76.8793,-83.8943 87.4503,-84.6047 85.586,-77.8575"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modsave.f90~~EfferentGraph_edge12" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#7f00ff" stroke-dasharray="5,2" d="M266.3245,-63.8471C249.0735,-68.9676 227.6238,-75.3343 208.3742,-81.0479"/>
<polygon fill="#7f00ff" stroke="#7f00ff" points="207.133,-77.7654 198.5423,-83.9662 209.1249,-84.476 207.133,-77.7654"/>
</g>
</g>
</svg>
</div><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modsave.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodsavef90AfferentGraph" width="641pt" height="121pt"
 viewBox="0.00 0.00 641.00 121.06" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modsave.f90~~AfferentGraph" class="graph" transform="scale(.8524 .8524) rotate(0) translate(4 138.024)">
<title>sourcefile~~modsave.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-138.024 748,-138.024 748,4 -4,4"/>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modsave.f90</title>
<polygon fill="none" stroke="#000000" points="82,-72.024 0,-72.024 0,-48.024 82,-48.024 82,-72.024"/>
<text text-anchor="middle" x="41" y="-57.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modsave.f90</text>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="202,-134.024 122,-134.024 122,-110.024 202,-110.024 202,-134.024"/>
<text text-anchor="middle" x="162" y="-119.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M138.3827,-109.9226C119.8939,-100.4489 93.9736,-87.1675 73.5228,-76.6886"/>
<polygon fill="#ff0000" stroke="#ff0000" points="75.0535,-73.5402 64.5577,-72.0949 71.8613,-79.77 75.0535,-73.5402"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="206,-72.024 118,-72.024 118,-48.024 206,-48.024 206,-72.024"/>
<text text-anchor="middle" x="162" y="-57.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M117.9739,-60.024C109.7111,-60.024 101.0046,-60.024 92.5375,-60.024"/>
<polygon fill="#ff0000" stroke="#ff0000" points="92.3743,-56.5241 82.3742,-60.024 92.3742,-63.5241 92.3743,-56.5241"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="744,-72.024 665,-72.024 665,-48.024 744,-48.024 744,-72.024"/>
<text text-anchor="middle" x="704.5" y="-57.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M677.4742,-47.9577C651.3547,-37.2288 610.3602,-22.817 573,-20.024"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573,-20.024C510.1016,-15.3217 495.5739,.072 432.5,-.024"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M432.5,-.024C291.6518,-.2383 255.6629,-9.2382 118,-39.024 109.4394,-40.8762 100.4118,-43.0941 91.6696,-45.3841"/>
<polygon fill="#ff0000" stroke="#ff0000" points="90.7149,-42.0164 81.961,-47.9846 92.526,-48.778 90.7149,-42.0164"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="348,-52.024 242,-52.024 242,-28.024 348,-28.024 348,-52.024"/>
<text text-anchor="middle" x="295" y="-37.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M432.5,-.024C396.5194,-.0787 357.2752,-12.8559 329.9572,-23.953"/>
<polygon fill="#ff0000" stroke="#ff0000" points="328.3267,-20.8415 320.4604,-27.9387 331.0357,-27.2961 328.3267,-20.8415"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="620,-114.024 526,-114.024 526,-90.024 620,-90.024 620,-114.024"/>
<text text-anchor="middle" x="573" y="-99.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M666.8174,-72.0595C652.3737,-76.6727 635.7054,-81.9964 620.4619,-86.8651"/>
<polygon fill="#00ffff" stroke="#00ffff" points="619.1492,-83.6101 610.6881,-89.9867 621.279,-90.2782 619.1492,-83.6101"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="481,-94.024 384,-94.024 384,-70.024 481,-70.024 481,-94.024"/>
<text text-anchor="middle" x="432.5" y="-79.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M573,-20.024C528.3591,-16.6866 520.736,-40.4085 481,-61.024 477.8923,-62.6363 474.6336,-64.2345 471.3378,-65.787"/>
<polygon fill="#ff0000" stroke="#ff0000" points="469.6988,-62.6874 462.0465,-70.015 472.5981,-69.0588 469.6988,-62.6874"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="472,-52.024 393,-52.024 393,-28.024 472,-28.024 472,-52.024"/>
<text text-anchor="middle" x="432.5" y="-37.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M573,-20.024C542.608,-17.7519 508.7831,-22.345 481.9386,-27.6994"/>
<polygon fill="#00ffff" stroke="#00ffff" points="481.0849,-24.3021 472.0137,-29.776 482.5186,-31.1537 481.0849,-24.3021"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modsave.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="629,-72.024 517,-72.024 517,-48.024 629,-48.024 629,-72.024"/>
<text text-anchor="middle" x="573" y="-57.624" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M664.6888,-60.024C656.6476,-60.024 647.9898,-60.024 639.3189,-60.024"/>
<polygon fill="#ff0000" stroke="#ff0000" points="639.1702,-56.5241 629.1701,-60.024 639.1701,-63.5241 639.1702,-56.5241"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M275.3754,-52.1234C252.8817,-65.9917 215.8293,-88.836 190.2369,-104.6148"/>
<polygon fill="#ff0000" stroke="#ff0000" points="188.3805,-101.6475 181.7051,-109.875 192.0542,-107.6061 188.3805,-101.6475"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M241.6702,-48.0435C233.3468,-49.2951 224.7367,-50.5899 216.3901,-51.845"/>
<polygon fill="#00ff00" stroke="#00ff00" points="215.7449,-48.4026 206.3766,-53.3508 216.7859,-55.3248 215.7449,-48.4026"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M295,-122.024C267.8028,-118.8963 237.2699,-118.6657 212.3246,-119.3196"/>
<polygon fill="#ff0000" stroke="#ff0000" points="211.8855,-115.8317 202.0019,-119.6481 212.1082,-122.8281 211.8855,-115.8317"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M432.5,-122.024C371.557,-117.494 355.711,-129.0058 295,-122.024"/>
<path fill="none" stroke="#00ff00" stroke-dasharray="5,2" d="M295,-122.024C254.4748,-117.3636 212.6126,-94.2777 186.9401,-77.6388"/>
<polygon fill="#00ff00" stroke="#00ff00" points="188.8272,-74.6905 178.5633,-72.0631 184.9485,-80.5177 188.8272,-74.6905"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.6973,-113.9081C498.5266,-119.4394 463.7045,-124.3435 432.5,-122.024"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M432.5,-122.024C384.4791,-118.4545 338.4801,-82.1603 313.7599,-59.0696"/>
<polygon fill="#ff0000" stroke="#ff0000" points="316.1403,-56.5029 306.506,-52.0948 311.2885,-61.5488 316.1403,-56.5029"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M525.8247,-95.3086C514.7261,-93.7288 502.7632,-92.0259 491.2265,-90.3836"/>
<polygon fill="#ff0000" stroke="#ff0000" points="491.6239,-86.905 481.2304,-88.9607 490.6373,-93.8351 491.6239,-86.905"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#00ffff" stroke-dasharray="5,2" d="M538.3147,-89.9339C531.1849,-87.1938 523.7863,-84.1604 517,-81.024 500.3854,-73.3451 497.4181,-69.1146 481,-61.024 477.7207,-59.408 474.2873,-57.7863 470.8272,-56.1999"/>
<polygon fill="#00ffff" stroke="#00ffff" points="472.2507,-53.0025 461.6935,-52.1109 469.3905,-59.3915 472.2507,-53.0025"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M393.098,-69.9885C377.8515,-65.3314 360.2343,-59.9501 344.1724,-55.0439"/>
<polygon fill="#ff0000" stroke="#ff0000" points="344.994,-51.6353 334.4077,-52.0613 342.949,-58.33 344.994,-51.6353"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M392.7293,-40.024C381.994,-40.024 370.1047,-40.024 358.4219,-40.024"/>
<polygon fill="#ff0000" stroke="#ff0000" points="358.2426,-36.5241 348.2426,-40.024 358.2425,-43.5241 358.2426,-36.5241"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modsave.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M516.6628,-68.8455C508.3043,-70.1543 499.6721,-71.5059 491.2654,-72.8223"/>
<polygon fill="#ff0000" stroke="#ff0000" points="490.4947,-69.4002 481.1565,-74.4052 491.5776,-76.316 490.4947,-69.4002"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemodsavef90AfferentGraph = svgPanZoom('#sourcefilemodsavef90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modsave.html">modsave</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modsave.f90.html#src">modsave.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file modsave.f90</span>
<a name="ln-2"></a><span class="c">!! Writes restart and data files.</span>
<a name="ln-3"></a><span class="c">!&gt; </span>
<a name="ln-4"></a><span class="c">!! modsave.f90 writes the restart and data files</span>
<a name="ln-5"></a><span class="c">!!  \author Jasper Tomas, June 4th 2015</span>
<a name="ln-6"></a><span class="c">!!  \todo documentation</span>
<a name="ln-7"></a><span class="c">!!  \par Revision list</span>
<a name="ln-8"></a><span class="c">!</span>
<a name="ln-9"></a>
<a name="ln-10"></a><span class="k">module </span><span class="n">modsave</span>
<a name="ln-11"></a>
<a name="ln-12"></a>
<a name="ln-13"></a><span class="k">implicit none</span>
<a name="ln-14"></a><span class="c">! private</span>
<a name="ln-15"></a><span class="c">! public :: writerestartfiles, writedatafiles</span>
<a name="ln-16"></a><span class="k">save</span>
<a name="ln-17"></a>
<a name="ln-18"></a><span class="k">contains</span>
<a name="ln-19"></a>
<a name="ln-20"></a>
<a name="ln-21"></a><span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-22"></a>  <span class="k">subroutine </span><span class="n">writerestartfiles</span>
<a name="ln-23"></a>    <span class="k">use </span><span class="n">modsurfdata</span><span class="p">,</span><span class="k">only</span><span class="p">:</span> <span class="n">ustar</span><span class="p">,</span><span class="n">thlflux</span><span class="p">,</span><span class="n">qtflux</span><span class="p">,</span><span class="n">svflux</span><span class="p">,</span><span class="n">dudz</span><span class="p">,</span><span class="n">dvdz</span><span class="p">,</span><span class="n">dthldz</span><span class="p">,</span><span class="n">dqtdz</span><span class="p">,</span><span class="n">ps</span><span class="p">,</span><span class="n">thls</span><span class="p">,</span><span class="n">qts</span><span class="p">,</span><span class="n">thvs</span><span class="p">,</span><span class="n">oblav</span>
<a name="ln-24"></a>
<a name="ln-25"></a>    <span class="k">use </span><span class="n">modfields</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">u0</span><span class="p">,</span><span class="n">v0</span><span class="p">,</span><span class="n">w0</span><span class="p">,</span><span class="n">thl0</span><span class="p">,</span><span class="n">qt0</span><span class="p">,</span><span class="n">ql0</span><span class="p">,</span><span class="n">ql0h</span><span class="p">,</span><span class="n">e120</span><span class="p">,</span><span class="n">dthvdz</span><span class="p">,</span><span class="n">presf</span><span class="p">,</span><span class="n">presh</span><span class="p">,</span><span class="n">sv0</span><span class="p">,</span><span class="n">mindist</span><span class="p">,</span><span class="n">wall</span><span class="p">,&amp;</span>
<a name="ln-26"></a>                          <span class="n">uav</span><span class="p">,</span><span class="n">vav</span><span class="p">,</span><span class="n">wav</span><span class="p">,</span><span class="n">uuav</span><span class="p">,</span><span class="n">vvav</span><span class="p">,</span><span class="n">wwav</span><span class="p">,</span><span class="n">uvav</span><span class="p">,</span><span class="n">uwav</span><span class="p">,</span><span class="n">vwav</span><span class="p">,</span><span class="n">thlav</span><span class="p">,</span><span class="n">thl2av</span><span class="p">,</span><span class="n">qtav</span><span class="p">,</span><span class="n">qlav</span><span class="p">,</span><span class="n">ql2av</span><span class="p">,</span><span class="n">qt2av</span><span class="p">,</span><span class="n">svav</span><span class="p">,</span><span class="n">sv2av</span><span class="p">,</span><span class="n">momthick</span><span class="p">,&amp;</span>
<a name="ln-27"></a>                          <span class="n">friction</span><span class="p">,</span><span class="n">displthick</span><span class="p">,</span><span class="n">pres0</span><span class="p">,</span><span class="n">viscratioav</span><span class="p">,</span><span class="n">thluav</span><span class="p">,</span><span class="n">thlvav</span><span class="p">,</span><span class="n">thlwav</span><span class="p">,</span><span class="n">qtuav</span><span class="p">,</span><span class="n">qtvav</span><span class="p">,</span><span class="n">qtwav</span><span class="p">,</span><span class="n">qluav</span><span class="p">,</span><span class="n">qlvav</span><span class="p">,</span><span class="n">qlwav</span><span class="p">,</span><span class="n">svuav</span><span class="p">,</span><span class="n">svvav</span><span class="p">,</span><span class="n">svwav</span><span class="p">,&amp;</span>
<a name="ln-28"></a>                          <span class="n">upupav</span><span class="p">,</span><span class="n">vpvpav</span><span class="p">,</span><span class="n">wpwpav</span><span class="p">,</span><span class="n">thlpthlpav</span><span class="p">,</span><span class="n">qlpqlpav</span><span class="p">,</span><span class="n">qtpqtpav</span><span class="p">,</span><span class="n">svpsvpav</span><span class="p">,</span><span class="n">upvpav</span><span class="p">,</span><span class="n">upwpav</span><span class="p">,</span><span class="n">vpwpav</span><span class="p">,</span><span class="n">thlpupav</span><span class="p">,</span><span class="n">thlpvpav</span><span class="p">,&amp;</span>
<a name="ln-29"></a>                          <span class="n">thlpwpav</span><span class="p">,</span><span class="n">qlpupav</span><span class="p">,</span><span class="n">qlpvpav</span><span class="p">,</span><span class="n">qlpwpav</span><span class="p">,</span><span class="n">qtpupav</span><span class="p">,</span><span class="n">qtpvpav</span><span class="p">,</span><span class="n">qtpwpav</span><span class="p">,</span><span class="n">svpupav</span><span class="p">,</span><span class="n">svpvpav</span><span class="p">,</span><span class="n">svpwpav</span><span class="p">,</span><span class="n">presav</span><span class="p">,&amp;</span>
<a name="ln-30"></a>                          <span class="n">uusgsav</span><span class="p">,</span><span class="n">vvsgsav</span><span class="p">,</span><span class="n">wwsgsav</span><span class="p">,</span><span class="n">uwsgsav</span><span class="p">,</span><span class="n">thlusgsav</span><span class="p">,</span><span class="n">thlwsgsav</span><span class="p">,</span><span class="n">qlusgsav</span><span class="p">,</span><span class="n">qlwsgsav</span><span class="p">,</span><span class="n">qtusgsav</span><span class="p">,</span><span class="n">qtwsgsav</span><span class="p">,</span><span class="n">svusgsav</span><span class="p">,</span><span class="n">svwsgsav</span><span class="p">,</span><span class="n">tkesgsav</span><span class="p">,&amp;</span>
<a name="ln-31"></a>                          <span class="n">strain2av</span><span class="p">,</span><span class="n">disssgsav</span><span class="p">,</span><span class="n">t_vav</span><span class="p">,</span><span class="n">tvmx</span><span class="p">,</span><span class="n">tvmy</span><span class="p">,</span><span class="n">tvmz</span><span class="p">,</span><span class="n">tsgsmx1</span><span class="p">,</span><span class="n">tsgsmx2</span><span class="p">,</span><span class="n">tsgsmy1</span><span class="p">,</span><span class="n">tsgsmy2</span><span class="p">,</span><span class="n">tsgsmz1</span><span class="p">,&amp;</span>
<a name="ln-32"></a>                          <span class="n">tsgsmz2</span><span class="p">,</span><span class="n">t_sgsav</span><span class="p">,</span><span class="n">nusgsav</span><span class="p">,</span><span class="n">tpm</span><span class="p">,</span><span class="n">t_pav</span><span class="p">,</span><span class="n">ttmx</span><span class="p">,</span><span class="n">ttmy</span><span class="p">,</span><span class="n">ttmz</span><span class="p">,</span><span class="n">t_tav</span><span class="p">,</span><span class="n">p_bav</span><span class="p">,</span><span class="n">d_sgsav</span><span class="p">,</span><span class="n">p_tav</span><span class="p">,</span><span class="n">tkeadv</span>
<a name="ln-33"></a>    <span class="k">use </span><span class="n">modglobal</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">trestart</span><span class="p">,</span><span class="n">tnextrestart</span><span class="p">,</span><span class="n">dt_lim</span><span class="p">,</span><span class="n">timee</span><span class="p">,</span><span class="n">btime</span><span class="p">,</span><span class="n">xh</span><span class="p">,&amp;</span>
<a name="ln-34"></a>                          <span class="n">cexpnr</span><span class="p">,</span><span class="n">ntimee</span><span class="p">,</span><span class="n">rk3step</span><span class="p">,</span><span class="n">ifoutput</span><span class="p">,</span><span class="n">nsv</span><span class="p">,</span><span class="n">timeleft</span><span class="p">,</span><span class="n">dt</span><span class="p">,</span><span class="n">ntrun</span><span class="p">,</span><span class="n">totavtime</span><span class="p">,&amp;</span>
<a name="ln-35"></a>                          <span class="n">iinletgen</span><span class="p">,</span><span class="n">timee</span><span class="p">,</span><span class="n">runavtime</span><span class="p">,</span><span class="n">inletav</span><span class="p">,</span><span class="n">totinletav</span><span class="p">,</span><span class="n">linletRA</span><span class="p">,</span><span class="n">ltempeq</span><span class="p">,</span><span class="n">lmoist</span><span class="p">,</span><span class="n">jgb</span><span class="p">,</span><span class="n">jge</span><span class="p">,&amp;</span>
<a name="ln-36"></a>                          <span class="n">dzf</span><span class="p">,</span><span class="n">dzfi</span><span class="p">,</span><span class="n">dzhi</span><span class="p">,</span><span class="n">dxf</span><span class="p">,</span><span class="n">dxfi</span><span class="p">,</span><span class="n">dyi</span><span class="p">,</span><span class="n">dxhi</span><span class="p">,</span><span class="n">nstore</span><span class="p">,</span><span class="n">numol</span><span class="p">,</span><span class="n">dy2i</span><span class="p">,</span><span class="n">grav</span><span class="p">,</span><span class="n">libm</span><span class="p">,</span><span class="n">jmax</span><span class="p">,</span><span class="n">nblocks</span>
<a name="ln-37"></a>    <span class="k">use </span><span class="n">modmpi</span><span class="p">,</span>    <span class="k">only</span> <span class="p">:</span> <span class="n">cmyid</span><span class="p">,</span><span class="n">myid</span><span class="p">,</span><span class="n">slabsum</span><span class="p">,</span><span class="n">excjs</span>
<a name="ln-38"></a>    <span class="k">use </span><span class="n">modsubgriddata</span><span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="n">ekm</span>
<a name="ln-39"></a>    <span class="k">use </span><span class="n">modibmdata</span><span class="p">,</span>   <span class="k">only</span>  <span class="p">:</span> <span class="n">ibmxforcevol</span>
<a name="ln-40"></a>    <span class="k">use </span><span class="n">initfac</span> <span class="p">,</span> <span class="k">only</span> <span class="p">:</span> <span class="k">block</span>
<a name="ln-41"></a><span class="k">    use </span><span class="n">modinletdata</span><span class="p">,</span> <span class="k">only</span>   <span class="p">:</span> <span class="n">Urec</span><span class="p">,</span><span class="n">Wrec</span><span class="p">,</span><span class="n">Uinl</span><span class="p">,</span><span class="n">Utav</span><span class="p">,</span><span class="n">QLinl</span><span class="p">,</span><span class="n">QTinl</span><span class="p">,</span><span class="n">QLrec</span><span class="p">,</span><span class="n">QTrec</span><span class="p">,</span><span class="n">QTtav</span><span class="p">,</span><span class="n">QLtav</span><span class="p">,</span><span class="n">Ttav</span><span class="p">,</span><span class="n">upupavinl</span><span class="p">,</span><span class="n">vpvpavinl</span><span class="p">,</span><span class="n">wpwpavinl</span><span class="p">,</span><span class="n">upwpavinl</span><span class="p">,&amp;</span>
<a name="ln-42"></a>                               <span class="n">thlpthlpavinl</span><span class="p">,</span><span class="n">thlpupavinl</span><span class="p">,</span><span class="n">thlpwpavinl</span><span class="p">,</span><span class="n">qlpqlpavinl</span><span class="p">,</span><span class="n">qlpupavinl</span><span class="p">,</span><span class="n">qlpwpavinl</span><span class="p">,</span><span class="n">qtpqtpavinl</span><span class="p">,</span><span class="n">qtpupavinl</span><span class="p">,</span><span class="n">qtpwpavinl</span><span class="p">,</span><span class="n">Tinl</span><span class="p">,</span><span class="n">Trec</span><span class="p">,</span><span class="n">nstepread</span>
<a name="ln-43"></a>
<a name="ln-44"></a>    <span class="k">implicit none</span>
<a name="ln-45"></a><span class="k">    </span><span class="kt">logical</span> <span class="kd">::</span> <span class="n">lexitnow</span> <span class="o">=</span> <span class="p">.</span><span class="n">false</span><span class="p">.</span>
<a name="ln-46"></a>    <span class="kt">integer </span><span class="n">imin</span><span class="p">,</span><span class="n">ihour</span>
<a name="ln-47"></a>    <span class="kt">integer </span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">,</span><span class="n">im</span><span class="p">,</span><span class="n">ip</span><span class="p">,</span><span class="n">jm</span><span class="p">,</span><span class="n">jp</span><span class="p">,</span><span class="n">jpp</span><span class="p">,</span><span class="n">km</span><span class="p">,</span><span class="n">kp</span><span class="p">,</span><span class="n">kpp</span><span class="p">,</span><span class="n">il</span><span class="p">,</span><span class="n">iu</span><span class="p">,</span><span class="n">jl</span><span class="p">,</span><span class="n">ju</span><span class="p">,</span><span class="n">kl</span><span class="p">,</span><span class="n">ku</span>
<a name="ln-48"></a>    <span class="kt">character</span><span class="p">(</span><span class="mi">21</span><span class="p">)</span> <span class="n">name</span><span class="p">,</span><span class="n">name2</span><span class="p">,</span><span class="n">name3</span><span class="p">,</span><span class="n">name4</span><span class="p">,</span><span class="n">linkname</span>
<a name="ln-49"></a>
<a name="ln-50"></a>    <span class="k">if</span> <span class="p">(</span><span class="n">timee</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="k">return</span>
<a name="ln-51"></a><span class="c">!    if (rk3step /=3) return</span>
<a name="ln-52"></a>    <span class="k">if</span> <span class="p">((</span><span class="n">iinletgen</span><span class="o">==</span><span class="mi">2</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">nstepread</span><span class="o">==</span><span class="n">nstore</span><span class="p">))</span> <span class="k">then</span>                <span class="c">! This overrules the need for rk3step to be 3 in case of reading inletfiles</span>
<a name="ln-53"></a>      <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Writing restartfiles after reading in new inletfiles&#39;</span>
<a name="ln-54"></a>    <span class="k">else</span>
<a name="ln-55"></a><span class="k">      if</span> <span class="p">(</span><span class="n">rk3step</span> <span class="o">/=</span><span class="mi">3</span><span class="p">)</span> <span class="k">return</span>   <span class="c">! Normal check</span>
<a name="ln-56"></a>    <span class="k">end if</span>
<a name="ln-57"></a>
<a name="ln-58"></a><span class="k">    </span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;exit_now.&#39;</span><span class="o">//</span><span class="n">cexpnr</span>
<a name="ln-59"></a>    <span class="k">inquire</span><span class="p">(</span><span class="k">file</span><span class="o">=</span><span class="nb">trim</span><span class="p">(</span><span class="n">name</span><span class="p">),</span> <span class="n">EXIST</span><span class="o">=</span><span class="n">lexitnow</span><span class="p">)</span>
<a name="ln-60"></a>
<a name="ln-61"></a>    <span class="k">if</span> <span class="p">(((</span><span class="n">timee</span><span class="o">&gt;=</span><span class="n">tnextrestart</span><span class="p">))</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">((</span><span class="n">lexitnow</span><span class="p">)</span> <span class="p">.</span><span class="nb">or</span><span class="p">.</span> <span class="p">(</span><span class="n">nstepread</span> <span class="o">==</span> <span class="n">nstore</span><span class="o">+</span><span class="mi">1</span><span class="p">)))</span> <span class="k">then</span>
<a name="ln-62"></a><span class="k">      </span><span class="n">tnextrestart</span> <span class="o">=</span> <span class="n">tnextrestart</span><span class="o">+</span><span class="n">trestart</span>
<a name="ln-63"></a>    
<a name="ln-64"></a>      <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;initd        _   .&#39;</span>
<a name="ln-65"></a>      <span class="k">write</span> <span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span>  <span class="p">,</span><span class="s1">&#39;(i8.8)&#39;</span><span class="p">)</span> <span class="n">ntrun</span>
<a name="ln-66"></a>      <span class="n">name</span><span class="p">(</span><span class="mi">15</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span><span class="o">=</span> <span class="n">cmyid</span>
<a name="ln-67"></a>      <span class="n">name</span><span class="p">(</span><span class="mi">19</span><span class="p">:</span><span class="mi">21</span><span class="p">)</span><span class="o">=</span> <span class="n">cexpnr</span>
<a name="ln-68"></a>      <span class="k">open</span>  <span class="p">(</span><span class="n">ifoutput</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">,</span><span class="n">status</span><span class="o">=</span><span class="s1">&#39;replace&#39;</span><span class="p">)</span>
<a name="ln-69"></a>
<a name="ln-70"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">mindist</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span>  <span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span>      <span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>   <span class="p">)</span>
<a name="ln-71"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">((((</span><span class="n">wall</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span>  <span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span>      <span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>   <span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
<a name="ln-72"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">u0</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-73"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">v0</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-74"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">w0</span>    <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-75"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">pres0</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-76"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">thl0</span>  <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-77"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">e120</span>  <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-78"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">ekm</span>   <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-79"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">qt0</span>   <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-80"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">ql0</span>   <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-81"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="p">(((</span><span class="n">ql0h</span>  <span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-82"></a>      <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="n">timee</span><span class="p">,</span>  <span class="n">dt</span>
<a name="ln-83"></a>      
<a name="ln-84"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-85"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;-------------------------&#39;</span>
<a name="ln-86"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;Saving initd restart file&#39;</span>
<a name="ln-87"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;ntrun ::: &#39;</span><span class="p">,</span> <span class="n">ntrun</span>
<a name="ln-88"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;timee ::: &#39;</span><span class="p">,</span> <span class="n">timee</span>
<a name="ln-89"></a>        <span class="k">write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span> <span class="s1">&#39;-------------------------&#39;</span>
<a name="ln-90"></a>      <span class="n">endif</span>
<a name="ln-91"></a>      
<a name="ln-92"></a>      <span class="k">close</span> <span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>
<a name="ln-93"></a>
<a name="ln-94"></a>      <span class="k">if</span> <span class="p">(</span><span class="n">nsv</span><span class="o">&gt;</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-95"></a><span class="k">        </span><span class="n">name</span>  <span class="o">=</span> <span class="s1">&#39;inits        _   .&#39;</span>
<a name="ln-96"></a>        <span class="k">write</span> <span class="p">(</span><span class="n">name</span><span class="p">(</span><span class="mi">6</span><span class="p">:</span><span class="mi">13</span><span class="p">)</span> <span class="p">,</span><span class="s1">&#39;(i8.8)&#39;</span><span class="p">)</span> <span class="n">ntrun</span>
<a name="ln-97"></a>        <span class="n">name</span><span class="p">(</span><span class="mi">15</span><span class="p">:</span><span class="mi">17</span><span class="p">)</span> <span class="o">=</span> <span class="n">cmyid</span>
<a name="ln-98"></a>        <span class="n">name</span><span class="p">(</span><span class="mi">19</span><span class="p">:</span><span class="mi">21</span><span class="p">)</span> <span class="o">=</span> <span class="n">cexpnr</span>
<a name="ln-99"></a>        <span class="k">open</span>  <span class="p">(</span><span class="n">ifoutput</span><span class="p">,</span><span class="k">file</span><span class="o">=</span><span class="n">name</span><span class="p">,</span><span class="n">form</span><span class="o">=</span><span class="s1">&#39;unformatted&#39;</span><span class="p">)</span>
<a name="ln-100"></a>        <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span> <span class="p">((((</span><span class="n">sv0</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">,</span><span class="n">n</span><span class="p">),</span><span class="n">i</span><span class="o">=</span><span class="n">ib</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ie</span><span class="o">+</span><span class="n">ih</span><span class="p">),</span><span class="n">j</span><span class="o">=</span><span class="n">jb</span><span class="o">-</span><span class="n">jh</span><span class="p">,</span><span class="n">je</span><span class="o">+</span><span class="n">jh</span><span class="p">),</span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">),</span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nsv</span><span class="p">)</span>
<a name="ln-101"></a>        <span class="k">write</span><span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>  <span class="n">timee</span>
<a name="ln-102"></a>
<a name="ln-103"></a>        <span class="k">close</span> <span class="p">(</span><span class="n">ifoutput</span><span class="p">)</span>
<a name="ln-104"></a>      <span class="k">end if</span>
<a name="ln-105"></a>
<a name="ln-106"></a><span class="k">      if</span> <span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span> <span class="k">then</span>
<a name="ln-107"></a><span class="k">        write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="s1">&#39;(A,F15.7,A,I4)&#39;</span><span class="p">)</span> <span class="s1">&#39;dump at time = &#39;</span><span class="p">,</span><span class="n">timee</span><span class="p">,</span><span class="s1">&#39; unit = &#39;</span><span class="p">,</span><span class="n">ifoutput</span>
<a name="ln-108"></a>      <span class="k">end if</span>
<a name="ln-109"></a>
<a name="ln-110"></a><span class="k">    end if</span>
<a name="ln-111"></a>
<a name="ln-112"></a><span class="k">  end subroutine </span><span class="n">writerestartfiles</span>
<a name="ln-113"></a>
<a name="ln-114"></a><span class="k">end module </span><span class="n">modsave</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>