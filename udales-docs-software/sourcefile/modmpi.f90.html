<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
   
    <meta name="description" content="Documentation for uDALES">
   
    <meta name="author" content="The uDALES Team" >
    <link rel="icon" href="../favicon.png">

    <title>modmpi.f90 &ndash; uDALES</title>

    <link href="../css/bootstrap.min.css" rel="stylesheet">
    <link href="../css/pygments.css" rel="stylesheet">
    <link href="../css/font-awesome.min.css" rel="stylesheet">
    <link href="../css/local.css" rel="stylesheet">
    
    <link  href="../tipuesearch/tipuesearch.css" rel="stylesheet">
    
    

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    
    <script src="../js/jquery-2.1.3.min.js"></script>
    <script src="../js/svg-pan-zoom.min.js"></script>

  </head>

  <body>

    <!-- Fixed navbar -->
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="../index.html">uDALES </a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
        
            <li class="dropdown hidden-xs visible-sm visible-md hidden-lg">
              <a href="#" class="dropdown-toggle"
              data-toggle="dropdown" role="button"
              aria-haspopup="true"
     aria-expanded="false">Contents <span class="caret"></span></a>
        <ul class="dropdown-menu">
          
              
            <li><a href="../lists/files.html">Source Files</a></li>
        
        
        
            <li><a href="../lists/modules.html">Modules</a></li>
        
            
                                
            <li><a href="../lists/procedures.html">Procedures</a></li>
        
               
            <li><a href="../lists/types.html">Derived Types</a></li>
        
        
            <li><a href="../program/dalesurban.html">Program</a></li>
      
            </ul>
            </li>


<li class="visible-xs hidden-sm visible-lg"><a href="../lists/files.html">Source Files</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/modules.html">Modules</a></li>



<li class="visible-xs hidden-sm visible-lg"><a href="../lists/procedures.html">Procedures</a></li>

                             
<li class="visible-xs hidden-sm visible-lg"><a href="../lists/types.html">Derived Types</a></li>


<li class="visible-xs hidden-sm visible-lg"><a href="../program/dalesurban.html">Program</a></li>

          </ul>
        
        <form action="../search.html" class="navbar-form navbar-right" role="search">
        <div class="form-group">
          <input type="text" class="form-control" placeholder="Search" name="q" id="tipue_search_input" autocomplete="off" required>
        </div>
<!--
        <button type="submit" class="btn btn-default">Submit</button>
-->
        </form>
        
        </div><!--/.nav-collapse -->
      </div>
    </nav>

    <div class="container">
    
  
  <div class="row">
    <h1>modmpi.f90
    <small>Source File</small>
    
    </h1>
    
<div class="row">
  <div class="col-lg-12">
<div class="well well-sm">
  <ul class="list-inline" style="margin-bottom:0px;display:inline">
     
     
     
     
    
    
     <li><i class="fa fa-list-ol"></i>
       <a data-toggle="tooltip"
    data-placement="bottom" data-html="true"
    title=" 1.8% of total for source files.">253 statements</a>
     </li> 
     
     
     
    <li><i class="fa fa-code"></i><a href="../src/modmpi.f90"> Source File</a></li>
     
     
  </ul>
  <ol class="breadcrumb in-well text-right">
  
    
  
     <li class="active">modmpi.f90</li>
  </ol>
</div>
</div>
</div>
<script>
  $(function () {
  $('[data-toggle="tooltip"]').tooltip()
  })
</script>

  </div>
  <div class="row">
    <div class="col-md-3 hidden-xs hidden-sm visible-md visible-lg">
    
<div id="sidebar">
  
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-0">Modules</a></h3></div>
  <div id="mods-0" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modmpi.html">modmpi</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modmpi.f90.html#src">modmpi.f90</a>
  </div>
</div>



</div>

    </div>
    <div class="col-md-9" id='text'>
      
      <br>
    
      
    <div class="panel panel-default">
      <div class="panel-heading">
  <h3 class="panel-title">Files dependent on this one</h3>
      </div>
      <div class="panel-body">
  <div class="depgraph"><?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: sourcefile~~modmpi.f90~~AfferentGraph Pages: 1 -->
<svg id="sourcefilemodmpif90AfferentGraph" width="641pt" height="704pt"
 viewBox="0.00 0.00 641.00 704.04" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="sourcefile~~modmpi.f90~~AfferentGraph" class="graph" transform="scale(.5391 .5391) rotate(0) translate(4 1301.9323)">
<title>sourcefile~~modmpi.f90~~AfferentGraph</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-1301.9323 1185,-1301.9323 1185,4 -4,4"/>
<!-- sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node1" class="node">
<title>sourcefile~modmpi.f90</title>
<polygon fill="none" stroke="#000000" points="77,-627.9323 0,-627.9323 0,-603.9323 77,-603.9323 77,-627.9323"/>
<text text-anchor="middle" x="38.5" y="-613.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">modmpi.f90</text>
</g>
<!-- sourcefile~modeb.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node2" class="node">
<title>sourcefile~modeb.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node2"><a xlink:href=".././sourcefile/modeb.f90.html" xlink:title="modEB.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="478,-1297.9323 407,-1297.9323 407,-1273.9323 478,-1273.9323 478,-1297.9323"/>
<text text-anchor="middle" x="442.5" y="-1283.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modEB.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge1" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286,-1245.9323C269.6935,-1230.384 255.1576,-1242.6354 239,-1226.9323 174.6328,-1164.3755 228.9831,-1096.8677 158,-1041.9323"/>
</g>
<!-- sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node6" class="node">
<title>sourcefile~modstat_nc.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node6"><a xlink:href=".././sourcefile/modstat_nc.f90.html" xlink:title="modstat_nc.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="333,-1217.9323 239,-1217.9323 239,-1193.9323 333,-1193.9323 333,-1217.9323"/>
<text text-anchor="middle" x="286" y="-1203.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstat_nc.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge28" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M406.7394,-1275.8457C394.4117,-1271.708 380.7562,-1266.3627 369,-1259.9323 351.2167,-1250.2052 349.9197,-1243.0943 333,-1231.9323 328.5413,-1228.9909 323.7248,-1226.0641 318.9339,-1223.2926"/>
<polygon fill="#fff400" stroke="#fff400" points="320.2857,-1220.0376 309.853,-1218.1914 316.8573,-1226.1406 320.2857,-1220.0376"/>
</g>
<!-- sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node11" class="node">
<title>sourcefile~modglobal.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node11"><a xlink:href=".././sourcefile/modglobal.f90.html" xlink:title="modglobal.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="203,-627.9323 113,-627.9323 113,-603.9323 203,-603.9323 203,-627.9323"/>
<text text-anchor="middle" x="158" y="-613.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modglobal.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge38" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M406.6822,-1286.3389C371.488,-1284.7802 318.4736,-1276.8961 286,-1245.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-1245.9323C269.6935,-1230.384 252.8003,-1244.7426 239,-1226.9323 220.4849,-1203.0371 171.5317,-745.1363 160.3133,-638.1509"/>
<polygon fill="#00ff28" stroke="#00ff28" points="163.7882,-637.7275 159.2671,-628.1458 156.8262,-638.4556 163.7882,-637.7275"/>
</g>
<!-- sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node15" class="node">
<title>sourcefile~initfac.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node15"><a xlink:href=".././sourcefile/initfac.f90.html" xlink:title="initfac.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="319,-975.9323 253,-975.9323 253,-951.9323 319,-951.9323 319,-975.9323"/>
<text text-anchor="middle" x="286" y="-961.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">initfac.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge76" class="edge">
<title>sourcefile~modeb.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M419.8703,-1273.7753C403.0999,-1263.543 381.131,-1247.323 369,-1226.9323 323.0454,-1149.6886 368.5133,-1110.4988 333,-1027.9323 326.0076,-1011.6753 314.2091,-995.629 304.1831,-983.6703"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="306.8039,-981.3502 297.606,-976.0918 301.5172,-985.9383 306.8039,-981.3502"/>
</g>
<!-- sourcefile~wf_gr.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node3" class="node">
<title>sourcefile~wf_gr.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node3"><a xlink:href=".././sourcefile/wf_gr.f90.html" xlink:title="wf_gr.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="473,-1053.9323 412,-1053.9323 412,-1029.9323 473,-1029.9323 473,-1053.9323"/>
<text text-anchor="middle" x="442.5" y="-1039.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_gr.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge2" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286,-1041.9323C236.4856,-1013.9203 202.9893,-1076.7505 158,-1041.9323"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge39" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M411.7219,-1050.3668C378.4281,-1057.6644 324.9011,-1063.94 286,-1041.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-1041.9323C257.4216,-1025.7645 253.3651,-1014.458 239,-984.9323 179.6945,-863.037 163.3528,-697.4493 159.2573,-638.1703"/>
<polygon fill="#00ff28" stroke="#00ff28" points="162.7427,-637.8292 158.6098,-628.0737 155.757,-638.2772 162.7427,-637.8292"/>
</g>
<!-- sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge79" class="edge">
<title>sourcefile~wf_gr.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M411.8534,-1032.7645C398.4261,-1028.3246 382.6514,-1022.524 369,-1015.9323 348.7157,-1006.1378 327.1998,-992.5562 311.1581,-981.7294"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="313.0799,-978.8034 302.8519,-976.0395 309.1239,-984.5784 313.0799,-978.8034"/>
</g>
<!-- sourcefile~scalsource.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node4" class="node">
<title>sourcefile~scalsource.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node4"><a xlink:href=".././sourcefile/scalsource.f90.html" xlink:title="scalsource.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="487.5,-893.9323 397.5,-893.9323 397.5,-869.9323 487.5,-869.9323 487.5,-893.9323"/>
<text text-anchor="middle" x="442.5" y="-879.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">scalsource.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge3" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.3464,-886.4679C364.5569,-891.3664 320.1392,-901.4312 286,-921.9323"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge40" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M397.3363,-879.1402C363.9106,-875.1217 318.6955,-865.3943 286,-841.9323"/>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge80" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M401.0557,-893.9825C390.3173,-897.8014 378.9749,-902.4762 369,-907.9323 351.2167,-917.6595 349.7389,-924.5011 333,-935.9323 327.8748,-939.4324 322.3038,-942.97 316.8486,-946.2978"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="314.6668,-943.5241 307.8762,-951.6568 318.2562,-949.5338 314.6668,-943.5241"/>
</g>
<!-- sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node31" class="node">
<title>sourcefile~modfields.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node31"><a xlink:href=".././sourcefile/modfields.f90.html" xlink:title="modfields.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="328.5,-517.9323 243.5,-517.9323 243.5,-493.9323 328.5,-493.9323 328.5,-517.9323"/>
<text text-anchor="middle" x="286" y="-503.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfields.f90</text>
</a>
</g>
</g>
<!-- sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge98" class="edge">
<title>sourcefile~scalsource.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M419.195,-869.7515C402.2982,-859.6067 380.4769,-843.511 369,-822.9323 305.5242,-709.117 405.9691,-639.9074 333,-531.9323 331.0681,-529.0736 328.7129,-526.4982 326.097,-524.1838"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="327.7704,-521.072 317.6302,-518.0016 323.6425,-526.7253 327.7704,-521.072"/>
</g>
<!-- sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node5" class="node">
<title>sourcefile~modchecksim.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node5"><a xlink:href=".././sourcefile/modchecksim.f90.html" xlink:title="modchecksim.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="496,-577.9323 389,-577.9323 389,-553.9323 496,-553.9323 496,-577.9323"/>
<text text-anchor="middle" x="442.5" y="-563.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchecksim.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge4" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M388.9559,-565.8955C357.888,-564.2294 318.584,-559.2422 286,-545.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286,-545.9323C265.1419,-537.4122 254.4069,-543.3726 239,-526.9323 160.5775,-443.2502 246.1845,-208.6092 158,-281.9323"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge41" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-545.9323C243.9265,-528.7462 197.9476,-570.0435 174.2088,-596.2825"/>
<polygon fill="#00ff28" stroke="#00ff28" points="171.5307,-594.0282 167.5846,-603.8607 176.801,-598.6351 171.5307,-594.0282"/>
</g>
<!-- sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge99" class="edge">
<title>sourcefile~modchecksim.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M407.2296,-553.8479C395.0694,-549.5778 381.3936,-544.6596 369,-539.9323 354.2233,-534.296 338.1076,-527.7805 324.0411,-521.9705"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="325.2495,-518.6826 314.6718,-518.0804 322.5652,-525.1475 325.2495,-518.6826"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge5" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M258.4559,-1193.8979C251.5973,-1190.079 244.6089,-1185.4001 239,-1179.9323 188.0753,-1130.2891 214.3741,-1085.2883 158,-1041.9323"/>
</g>
<!-- sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge42" class="edge">
<title>sourcefile~modstat_nc.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M274.2842,-1193.5973C263.301,-1181.2758 247.3563,-1161.2864 239,-1140.9323 200.4123,-1046.9407 168.2437,-725.8166 160.0308,-638.1816"/>
<polygon fill="#00ff28" stroke="#00ff28" points="163.4991,-637.6763 159.0904,-628.0423 156.529,-638.3229 163.4991,-637.6763"/>
</g>
<!-- sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node7" class="node">
<title>sourcefile~modstatsdump.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node7"><a xlink:href=".././sourcefile/modstatsdump.f90.html" xlink:title="modstatsdump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1066,-559.9323 954,-559.9323 954,-535.9323 1066,-535.9323 1066,-559.9323"/>
<text text-anchor="middle" x="1010" y="-545.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatsdump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge6" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1009.2692,-560.178C1004.1991,-640.4724 971.4055,-1090.8791 869.5,-1169.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5,-1169.9323C843.8861,-1189.8023 316.0473,-1178.0999 286,-1165.9323"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge31" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M869.5,-1169.9323C850.6786,-1184.9765 466.5455,-1247.4765 442.5,-1245.9323"/>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M442.5,-1245.9323C403.5555,-1242.4929 360.6151,-1230.9369 329.5806,-1221.1246"/>
<polygon fill="#fff400" stroke="#fff400" points="330.5347,-1217.7548 319.943,-1218.0125 328.3836,-1224.4161 330.5347,-1217.7548"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge43" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M1000.534,-560.1057C958.7596,-612.2963 784.6624,-813.9575 597.5,-801.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M597.5,-801.9323C560.5942,-803.3525 322.0817,-693.8168 286,-685.9323"/>
</g>
<!-- sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node12" class="node">
<title>sourcefile~modsubgrid.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node12"><a xlink:href=".././sourcefile/modsubgrid.f90.html" xlink:title="modsubgrid.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="918,-447.9323 821,-447.9323 821,-423.9323 918,-423.9323 918,-447.9323"/>
<text text-anchor="middle" x="869.5" y="-433.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsubgrid.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge68" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M994.6966,-535.7332C970.0983,-516.1246 921.6043,-477.4674 892.7224,-454.4441"/>
<polygon fill="#00ff66" stroke="#00ff66" points="894.7858,-451.613 884.7846,-448.1165 890.4224,-457.0867 894.7858,-451.613"/>
</g>
<!-- sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node26" class="node">
<title>sourcefile~modstatistics.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node26"><a xlink:href=".././sourcefile/modstatistics.f90.html" xlink:title="modstatistics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-813.9323 391,-813.9323 391,-789.9323 494,-789.9323 494,-813.9323"/>
<text text-anchor="middle" x="442.5" y="-799.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstatistics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge96" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modstatistics.f90</title>
<path fill="none" stroke="#ff003d" stroke-dasharray="5,2" d="M597.5,-801.9323C566.886,-799.9654 532.8006,-799.7503 504.4064,-800.1168"/>
<polygon fill="#ff003d" stroke="#ff003d" points="504.1639,-796.62 494.2198,-800.276 504.2733,-803.6192 504.1639,-796.62"/>
</g>
<!-- sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge100" class="edge">
<title>sourcefile~modstatsdump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M953.7176,-538.5366C874.0875,-526.6934 724.1224,-509.7271 597.5,-525.9323"/>
</g>
<!-- sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node8" class="node">
<title>sourcefile~modsave.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node8"><a xlink:href=".././sourcefile/modsave.f90.html" xlink:title="modsave.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="483.5,-253.9323 401.5,-253.9323 401.5,-229.9323 483.5,-229.9323 483.5,-253.9323"/>
<text text-anchor="middle" x="442.5" y="-239.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modsave.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge7" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M401.25,-236.3355C380.7702,-233.8315 355.6285,-231.1685 333,-229.9323 291.2844,-227.6534 279.0883,-218.1719 239,-229.9323 197.95,-241.9749 190.0909,-253.6429 158,-281.9323"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge44" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M416.4263,-254.0424C373.4729,-275.2571 287.7475,-323.1257 239,-387.9323 189.986,-453.0932 168.7322,-550.5175 161.3198,-593.8194"/>
<polygon fill="#00ff28" stroke="#00ff28" points="157.8408,-593.4079 159.6896,-603.8402 164.75,-594.532 157.8408,-593.4079"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge82" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M429.2329,-254.2122C411.8042,-271.2869 381.9023,-304.0558 369,-338.9323 322.8861,-463.5837 402.1142,-822.4084 333,-935.9323 330.7218,-939.6743 327.7388,-942.9769 324.379,-945.8768"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="322.0611,-943.2337 316.0095,-951.9302 326.1635,-948.9056 322.0611,-943.2337"/>
</g>
<!-- sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge101" class="edge">
<title>sourcefile~modsave.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M431.8545,-254.191C416.6882,-272.0282 388.5383,-306.5496 369,-338.9323 349.4837,-371.2785 349.7478,-382.0698 333,-415.9323 321.2635,-439.6626 307.1213,-466.5256 297.4357,-484.678"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="294.191,-483.3232 292.5569,-493.7913 300.3623,-486.6271 294.191,-483.3232"/>
</g>
<!-- sourcefile~tstep.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node9" class="node">
<title>sourcefile~tstep.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node9"><a xlink:href=".././sourcefile/tstep.f90.html" xlink:title="tstep.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="627,-657.9323 568,-657.9323 568,-633.9323 627,-633.9323 627,-657.9323"/>
<text text-anchor="middle" x="597.5" y="-643.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">tstep.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge8" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M580.2765,-657.9369C563.9599,-669.1667 538.6507,-686.2191 516,-699.9323 452.1883,-738.5653 428.8914,-736.4637 369,-780.9323 304.1487,-829.0837 289.1833,-844.6403 239,-907.9323 195.764,-962.4622 213.0343,-1084.5245 158,-1041.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M158,-1041.9323C94.0171,-988.074 52.42,-717.6096 41.4199,-638.0057"/>
<polygon fill="#ff0000" stroke="#ff0000" points="44.8862,-637.52 40.0717,-628.0823 37.9499,-638.4625 44.8862,-637.52"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge45" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M567.7538,-657.1841C536.9462,-667.9822 487.152,-683.0634 442.5,-685.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M442.5,-685.9323C373.0876,-690.3921 353.9521,-700.781 286,-685.9323"/>
</g>
<!-- sourcefile~modchem.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node29" class="node">
<title>sourcefile~modchem.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node29"><a xlink:href=".././sourcefile/modchem.f90.html" xlink:title="modchem.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="486,-657.9323 399,-657.9323 399,-633.9323 486,-633.9323 486,-657.9323"/>
<text text-anchor="middle" x="442.5" y="-643.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modchem.f90</text>
</a>
</g>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge97" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modchem.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M567.9808,-645.9323C547.7677,-645.9323 520.3754,-645.9323 496.3409,-645.9323"/>
<polygon fill="#00ff66" stroke="#00ff66" points="496.2767,-642.4324 486.2767,-645.9323 496.2767,-649.4324 496.2767,-642.4324"/>
</g>
<!-- sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge102" class="edge">
<title>sourcefile~tstep.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M591.2176,-633.878C579.4489,-612.5238 551.986,-568.1205 516,-544.9323 487.6377,-526.6566 475.4966,-518.8867 442.5,-525.9323"/>
</g>
<!-- sourcefile~modstartup.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node10" class="node">
<title>sourcefile~modstartup.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node10"><a xlink:href=".././sourcefile/modstartup.f90.html" xlink:title="modstartup.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1057,-59.9323 963,-59.9323 963,-35.9323 1057,-35.9323 1057,-59.9323"/>
<text text-anchor="middle" x="1010" y="-45.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modstartup.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge9" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M962.9956,-43.1724C935.4647,-41.5608 900.1846,-41.5358 869.5,-47.9323"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge46" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M990.6298,-60.1003C964.1032,-76.3645 914.6121,-105.2988 869.5,-123.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M869.5,-123.9323C813.0175,-147.2624 793.1109,-123.7809 732,-123.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M732,-123.9323C691.3584,-124.0331 683.3693,-107.6305 643,-102.9323 521.8326,-88.8309 489.0431,-97.2516 369,-118.9323 310.0023,-129.5878 279.3048,-110.5499 239,-154.9323 223.8899,-171.5711 174.3866,-503.8522 161.2334,-593.7006"/>
<polygon fill="#00ff28" stroke="#00ff28" points="157.7641,-593.2365 159.7824,-603.6373 164.6907,-594.248 157.7641,-593.2365"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge69" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1008.2344,-59.9897C1001.4797,-103.8242 974.7548,-258.1179 918,-371.9323 910.0134,-387.9484 897.8407,-403.9954 887.6885,-416.0147"/>
<polygon fill="#00ff66" stroke="#00ff66" points="884.9773,-413.7987 881.0592,-423.6425 890.2608,-418.3906 884.9773,-413.7987"/>
</g>
<!-- sourcefile~moddriver.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node14" class="node">
<title>sourcefile~moddriver.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node14"><a xlink:href=".././sourcefile/moddriver.f90.html" xlink:title="moddriver.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="641.5,-177.9323 553.5,-177.9323 553.5,-153.9323 641.5,-153.9323 641.5,-177.9323"/>
<text text-anchor="middle" x="597.5" y="-163.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">moddriver.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge72" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M732,-123.9323C713.6549,-123.9778 670.6385,-138.3865 638.1564,-150.3127"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="636.6092,-147.1536 628.4529,-153.9156 639.0458,-153.7159 636.6092,-147.1536"/>
</g>
<!-- sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node16" class="node">
<title>sourcefile~modthermodynamics.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node16"><a xlink:href=".././sourcefile/modthermodynamics.f90.html" xlink:title="modthermodynamics.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="516,-371.9323 369,-371.9323 369,-347.9323 516,-347.9323 516,-371.9323"/>
<text text-anchor="middle" x="442.5" y="-357.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modthermodynamics.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge84" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M1003.402,-60.1065C989.5476,-85.0696 955.5871,-143.2131 918,-184.9323 866.4644,-242.1336 853.3463,-260.4826 785,-295.9323 703.7508,-338.0745 598.8975,-352.7582 526.726,-357.7201"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="526.0784,-354.2542 516.3216,-358.3838 526.5241,-361.24 526.0784,-354.2542"/>
</g>
<!-- sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node18" class="node">
<title>sourcefile~modboundary.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node18"><a xlink:href=".././sourcefile/modboundary.f90.html" xlink:title="modboundary.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="785,-175.9323 679,-175.9323 679,-151.9323 785,-151.9323 785,-175.9323"/>
<text text-anchor="middle" x="732" y="-161.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modboundary.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge88" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M869.5,-123.9323C845.0633,-134.0259 817.2007,-142.6363 792.9756,-149.2539"/>
<polygon fill="#0028ff" stroke="#0028ff" points="791.9428,-145.907 783.1883,-151.8743 793.7533,-152.6689 791.9428,-145.907"/>
</g>
<!-- sourcefile~modinlet.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node19" class="node">
<title>sourcefile~modinlet.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node19"><a xlink:href=".././sourcefile/modinlet.f90.html" xlink:title="modinlet.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="637.5,-135.9323 557.5,-135.9323 557.5,-111.9323 637.5,-111.9323 637.5,-135.9323"/>
<text text-anchor="middle" x="597.5" y="-121.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modinlet.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge89" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M732,-123.9323C704.0887,-124.0015 672.9192,-124.0061 647.6193,-123.9913"/>
<polygon fill="#1400ff" stroke="#1400ff" points="647.5225,-120.4913 637.5201,-123.9842 647.5176,-127.4913 647.5225,-120.4913"/>
</g>
<!-- sourcefile~modpois.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node23" class="node">
<title>sourcefile~modpois.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node23"><a xlink:href=".././sourcefile/modpois.f90.html" xlink:title="modpois.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="909,-175.9323 830,-175.9323 830,-151.9323 909,-151.9323 909,-175.9323"/>
<text text-anchor="middle" x="869.5" y="-161.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modpois.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge93" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M999.5997,-60.1128C983.4514,-78.5309 950.7812,-113.8674 918,-137.9323 913.7294,-141.0674 909.0332,-144.0643 904.2962,-146.8357"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="902.2821,-143.9506 895.2377,-151.8644 905.6797,-150.0708 902.2821,-143.9506"/>
</g>
<!-- sourcefile~modforces.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node25" class="node">
<title>sourcefile~modforces.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node25"><a xlink:href=".././sourcefile/modforces.f90.html" xlink:title="modforces.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="487.5,-211.9323 397.5,-211.9323 397.5,-187.9323 487.5,-187.9323 487.5,-211.9323"/>
<text text-anchor="middle" x="442.5" y="-197.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modforces.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge95" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M869.5,-123.9323C848.1028,-132.7704 839.8717,-129.523 821,-142.9323 800.9587,-157.1727 805.0137,-170.6531 785,-184.9323 764.3743,-199.6482 757.2503,-203.8351 732,-205.9323"/>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M732,-205.9323C650.711,-212.6841 556.167,-208.4667 497.8267,-204.4727"/>
<polygon fill="#ff007a" stroke="#ff007a" points="497.9424,-200.9723 487.7204,-203.7581 497.4486,-207.9548 497.9424,-200.9723"/>
</g>
<!-- sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge103" class="edge">
<title>sourcefile~modstartup.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M1006.8383,-60.3623C997.8642,-93.6317 969.4935,-186.1638 918,-244.9323 871.7686,-297.6954 845.6212,-294.6286 785,-329.9323 761.9786,-343.3392 753.6132,-342.3568 732,-357.9323"/>
</g>
<!-- sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge10" class="edge">
<title>sourcefile~modglobal.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M112.8222,-615.9323C104.4581,-615.9323 95.6884,-615.9323 87.2244,-615.9323"/>
<polygon fill="#ff0000" stroke="#ff0000" points="87.0997,-612.4324 77.0997,-615.9323 87.0997,-619.4324 87.0997,-612.4324"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge11" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M820.7218,-432.7078C794.393,-431.6004 761.3604,-431.23 732,-433.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M732,-433.9323C620.8796,-444.16 622.5748,-339.0104 516,-305.9323 439.8494,-282.2972 221.1303,-233.2281 158,-281.9323"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge48" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M844.9694,-447.9417C803.6972,-467.9781 717.5635,-509.0691 643,-539.9323 587.3899,-562.9504 573.4313,-568.9332 516,-586.9323 451.6074,-607.1132 429.956,-595.9834 369,-624.9323 327.6467,-644.5717 330.7246,-695.7054 286,-685.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-685.9323C246.3318,-677.2642 206.1502,-652.0017 181.6542,-634.3276"/>
<polygon fill="#00ff28" stroke="#00ff28" points="183.4913,-631.3332 173.369,-628.2042 179.3307,-636.9626 183.4913,-631.3332"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge86" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M868.4112,-423.7267C864.384,-385.1934 847.1744,-264.4033 785,-191.9323 781.5728,-187.9376 777.431,-184.4284 772.9908,-181.3687"/>
<polygon fill="#0028ff" stroke="#0028ff" points="774.5583,-178.226 764.1936,-176.0297 770.9265,-184.2101 774.5583,-178.226"/>
</g>
<!-- sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge105" class="edge">
<title>sourcefile~modsubgrid.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M732,-433.9323C659.8805,-440.5703 669.3384,-516.7384 597.5,-525.9323"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M597.5,-525.9323C529.1684,-534.6774 509.8702,-511.547 442.5,-525.9323"/>
</g>
<!-- sourcefile~modibm.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node13" class="node">
<title>sourcefile~modibm.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node13"><a xlink:href=".././sourcefile/modibm.f90.html" xlink:title="modibm.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="481,-973.9323 404,-973.9323 404,-949.9323 481,-949.9323 481,-973.9323"/>
<text text-anchor="middle" x="442.5" y="-959.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modibm.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge12" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.727,-973.9489C331.0911,-998.1084 168.0152,-1049.6348 158,-1041.9323"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge50" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M403.742,-952.2984C391.9864,-948.3317 379.4335,-942.9747 369,-935.9323 322.8053,-904.7519 331.281,-874.4255 286,-841.9323"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge81" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M403.8146,-962.4267C381.2868,-962.7146 352.8217,-963.0784 329.5148,-963.3762"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="329.1635,-959.8803 319.2091,-963.5079 329.253,-966.8798 329.1635,-959.8803"/>
</g>
<!-- sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge107" class="edge">
<title>sourcefile~modibm.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M403.8943,-956.868C390.8502,-953.1836 377.4629,-946.8404 369,-935.9323 313.7495,-864.7183 382.1833,-607.4641 333,-531.9323 331.1682,-529.1192 328.9221,-526.583 326.4145,-524.3017"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="328.3635,-521.3886 318.26,-518.1995 324.1695,-526.9932 328.3635,-521.3886"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge13" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M567.9122,-153.8657C562.4606,-151.2031 556.9364,-148.193 552,-144.9323 497.2561,-108.7722 506.7838,-59.0488 442.5,-45.9323"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge35" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M582.7433,-178.0096C567.045,-190.3317 541.0664,-209.2547 516,-220.9323 508.895,-224.2423 501.1561,-227.1428 493.4541,-229.6466"/>
<polygon fill="#8eff00" stroke="#8eff00" points="492.3086,-226.3367 483.7683,-232.6067 494.3546,-233.0311 492.3086,-226.3367"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge51" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M553.3699,-160.8195C506.1339,-157.0647 429.7873,-156.0101 369,-178.9323 325.1588,-195.4644 318.1771,-209.8737 286,-243.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-243.9323C262.9164,-267.7648 253.9297,-272.3022 239,-301.9323 187.6781,-403.7881 166.8579,-541.0793 160.4043,-593.9329"/>
<polygon fill="#00ff28" stroke="#00ff28" points="156.9256,-593.5474 159.2394,-603.8865 163.8782,-594.3611 156.9256,-593.5474"/>
</g>
<!-- sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge108" class="edge">
<title>sourcefile~moddriver.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M590.7757,-178.083C580.7245,-196.7964 561.9068,-234.061 552,-267.9323 521.8448,-371.0334 587.9285,-427.1486 516,-506.9323 493.4075,-531.9922 475.4966,-518.8867 442.5,-525.9323"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge14" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M263.3575,-976.0677C255.5745,-980.3418 246.8476,-985.2496 239,-989.9323 202.2634,-1011.8537 191.9109,-1068.0124 158,-1041.9323"/>
</g>
<!-- sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge53" class="edge">
<title>sourcefile~initfac.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M280.3,-951.7635C271.0934,-931.9124 252.6086,-891.2297 239,-855.9323 208.4393,-776.6656 177.8763,-680.3624 164.7174,-637.8739"/>
<polygon fill="#00ff28" stroke="#00ff28" points="167.9791,-636.5732 161.6881,-628.0482 161.2897,-638.6356 167.9791,-636.5732"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge15" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M404.819,-347.856C329.7039,-324.0217 167.6605,-273.8999 158,-281.9323"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge54" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M368.645,-371.7243C341.4836,-378.0866 311.2229,-387.671 286,-401.9323"/>
</g>
<!-- sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge109" class="edge">
<title>sourcefile~modthermodynamics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M384.8387,-372.0289C379.2171,-374.472 373.8203,-377.4069 369,-380.9323 332.1086,-407.9136 306.7982,-456.6263 294.5232,-484.6089"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="291.2648,-483.3281 290.5933,-493.9017 297.7119,-486.0547 291.2648,-483.3281"/>
</g>
<!-- sourcefile~advec_2nd.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node17" class="node">
<title>sourcefile~advec_2nd.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node17"><a xlink:href=".././sourcefile/advec_2nd.f90.html" xlink:title="advec_2nd.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="643,-853.9323 552,-853.9323 552,-829.9323 643,-829.9323 643,-853.9323"/>
<text text-anchor="middle" x="597.5" y="-839.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_2nd.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge16" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M584.7177,-854.044C569.5,-867.8244 542.7649,-890.0779 516,-902.9323 485.5854,-917.5396 474.684,-911.8026 442.5,-921.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M442.5,-921.9323C376.1531,-942.8146 345.6298,-886.1237 286,-921.9323"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge55" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M551.9831,-848.2057C475.9355,-857.6773 327.3016,-871.5699 286,-841.9323"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge71" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M589.9979,-854.0982C577.1779,-873.9366 549.1971,-913.306 516,-935.9323 508.3614,-941.1386 499.5672,-945.4176 490.7777,-948.8933"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="489.4895,-945.6376 481.2969,-952.3556 491.8907,-952.2129 489.4895,-945.6376"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge74" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M442.5,-921.9323C410.316,-932.062 401.5921,-932.2047 369,-940.9323 356.0073,-944.4116 341.8976,-948.2855 329.0599,-951.8472"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="327.7786,-948.5706 319.0828,-954.6231 329.655,-955.3145 327.7786,-948.5706"/>
</g>
<!-- sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge110" class="edge">
<title>sourcefile~advec_2nd.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M566.903,-829.6659C561.1426,-826.0494 555.7561,-821.5197 552,-815.9323 484.2131,-715.0968 596.568,-635.881 516,-544.9323 493.6268,-519.6765 475.4966,-518.8867 442.5,-525.9323"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge17" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M702.2011,-151.8292C694.2936,-147.9599 686.0116,-143.2732 679,-137.9323 635.5452,-104.8321 650.211,-60.2676 597.5,-45.9323"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge56" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M717.7903,-176.2509C693.1732,-197.6247 641.0511,-243.0251 597.5,-281.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M597.5,-281.9323C571.0525,-305.5598 476.3563,-309.3739 442.5,-319.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M442.5,-319.9323C410.2895,-329.9775 399.3652,-324.2226 369,-338.9323 327.321,-359.1228 326.3141,-379.1383 286,-401.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-401.9323C211.6887,-443.9488 175.9121,-548.209 163.3963,-593.8933"/>
<polygon fill="#00ff28" stroke="#00ff28" points="159.9787,-593.1281 160.8268,-603.6889 166.7496,-594.9042 159.9787,-593.1281"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge73" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~moddriver.f90</title>
<path fill="none" stroke="#00ffe0" stroke-dasharray="5,2" d="M678.842,-164.7228C669.9756,-164.8546 660.767,-164.9916 651.8708,-165.1238"/>
<polygon fill="#00ffe0" stroke="#00ffe0" points="651.557,-161.628 641.6102,-165.2764 651.6611,-168.6273 651.557,-161.628"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge90" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modinlet.f90</title>
<path fill="none" stroke="#1400ff" stroke-dasharray="5,2" d="M691.6456,-151.931C677.8141,-147.8176 662.1654,-143.1637 647.6542,-138.8481"/>
<polygon fill="#1400ff" stroke="#1400ff" points="648.4088,-135.421 637.826,-135.9252 646.4133,-142.1306 648.4088,-135.421"/>
</g>
<!-- sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge111" class="edge">
<title>sourcefile~modboundary.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M597.5,-281.9323C557.8419,-317.3617 555.3384,-471.1482 516,-506.9323 491.041,-529.6362 475.4966,-518.8867 442.5,-525.9323"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge18" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M580.9465,-111.8322C553.7352,-92.8466 497.106,-57.0741 442.5,-45.9323"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge34" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M563.9186,-136.0808C559.5869,-138.5714 555.4622,-141.5045 552,-144.9323 525.4401,-171.2289 544.5054,-196.7583 516,-220.9323 509.4527,-226.4848 501.5212,-230.572 493.3232,-233.58"/>
<polygon fill="#8eff00" stroke="#8eff00" points="492.1246,-230.2881 483.6438,-236.6385 494.2337,-236.9628 492.1246,-230.2881"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge57" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M557.3068,-121.626C480.2392,-119.6985 312.7982,-128.1144 239,-229.9323 195.8973,-289.4003 168.1538,-520.2567 160.2954,-593.5014"/>
<polygon fill="#00ff28" stroke="#00ff28" points="156.7719,-593.5416 159.2056,-603.8531 163.7334,-594.2745 156.7719,-593.5416"/>
</g>
<!-- sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge112" class="edge">
<title>sourcefile~modinlet.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M561.4304,-135.9584C557.7963,-138.4284 554.5231,-141.3888 552,-144.9323 505.1103,-210.7857 568.6016,-445.5452 516,-506.9323 494.0458,-532.5533 475.4966,-518.8867 442.5,-525.9323"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M442.5,-525.9323C406.4847,-533.6225 365.1324,-527.7185 333.983,-520.3783"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="334.7966,-516.9741 324.2478,-517.96 333.1091,-523.7676 334.7966,-516.9741"/>
</g>
<!-- sourcefile~wfmneutral.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node20" class="node">
<title>sourcefile~wfmneutral.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node20"><a xlink:href=".././sourcefile/wfmneutral.f90.html" xlink:title="wfmneutral.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="489.5,-1137.9323 395.5,-1137.9323 395.5,-1113.9323 489.5,-1113.9323 489.5,-1137.9323"/>
<text text-anchor="middle" x="442.5" y="-1123.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wfmneutral.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge19" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M405.1216,-1137.9564C362.4355,-1151.2988 297.0471,-1170.4058 286,-1165.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286,-1165.9323C264.0697,-1157.0517 257.2935,-1155.9373 239,-1140.9323 195.0443,-1104.8782 202.9591,-1076.7271 158,-1041.9323"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge58" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M410.2264,-1137.9361C374.5816,-1148.863 318.0083,-1158.9019 286,-1126.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-1126.9323C267.9411,-1108.8953 252.6281,-1115.5132 239,-1093.9323 189.8036,-1016.0271 165.5112,-721.7638 159.5083,-638.1903"/>
<polygon fill="#00ff28" stroke="#00ff28" points="162.9877,-637.7731 158.7958,-628.0428 156.0049,-638.2634 162.9877,-637.7731"/>
</g>
<!-- sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge75" class="edge">
<title>sourcefile~wfmneutral.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M395.2064,-1118.8418C385.7683,-1115.7453 376.4739,-1111.303 369,-1104.9323 340.2495,-1080.4258 352.2731,-1060.424 333,-1027.9323 323.9451,-1012.6671 312.1101,-996.5685 302.5817,-984.3359"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="305.0753,-981.847 296.1239,-976.1792 299.5871,-986.1921 305.0753,-981.847"/>
</g>
<!-- sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node21" class="node">
<title>sourcefile~modfielddump.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node21"><a xlink:href=".././sourcefile/modfielddump.f90.html" xlink:title="modfielddump.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="498,-1217.9323 387,-1217.9323 387,-1193.9323 498,-1193.9323 498,-1217.9323"/>
<text text-anchor="middle" x="442.5" y="-1203.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">modfielddump.f90</text>
</a>
</g>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge20" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M386.658,-1195.4856C356.2611,-1188.856 318.3616,-1179.037 286,-1165.9323"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge30" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M386.8833,-1205.9323C372.7439,-1205.9323 357.5257,-1205.9323 343.304,-1205.9323"/>
<polygon fill="#fff400" stroke="#fff400" points="343.1542,-1202.4324 333.1541,-1205.9323 343.1541,-1209.4324 343.1542,-1202.4324"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge59" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M418.1929,-1193.9048C374.8721,-1172.4359 288.5774,-1129.5066 286,-1126.9323"/>
</g>
<!-- sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge113" class="edge">
<title>sourcefile~modfielddump.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M418.4529,-1193.7482C401.4076,-1183.6985 379.7311,-1167.7256 369,-1146.9323 306.2156,-1025.2775 405.9502,-647.7773 333,-531.9323 331.2112,-529.0916 328.996,-526.5357 326.5097,-524.2407"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="328.4833,-521.3453 318.3932,-518.1142 324.2661,-526.9323 328.4833,-521.3453"/>
</g>
<!-- sourcefile~program.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node22" class="node">
<title>sourcefile~program.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node22"><a xlink:href=".././sourcefile/program.f90.html" xlink:title="program.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="1181,-447.9323 1102,-447.9323 1102,-423.9323 1181,-423.9323 1181,-447.9323"/>
<text text-anchor="middle" x="1141.5" y="-433.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">program.f90</text>
</a>
</g>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge21" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1140.877,-423.7621C1137.5104,-362.5601 1119.6144,-88.9165 1066,-26.9323 1048.8061,-7.0543 1033.8062,-19.0692 1010,-7.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M1010,-7.9323C951.1913,19.5793 933.0595,-34.6828 869.5,-47.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M869.5,-47.9323C865.6208,-48.741 735.8699,-86.7845 732,-85.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M732,-85.9323C671.094,-72.52 657.6795,-62.2987 597.5,-45.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M597.5,-45.9323C531.0255,-27.854 509.9982,-59.7046 442.5,-45.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M442.5,-45.9323C348.3521,-26.7224 310.793,-55.0684 239,-118.9323 178.5574,-172.6994 221.5049,-231.8192 158,-281.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M158,-281.9323C105.562,-321.1557 57.7813,-525.6978 43.1064,-593.8286"/>
<polygon fill="#ff0000" stroke="#ff0000" points="39.6241,-593.3775 40.9682,-603.8868 46.4711,-594.8331 39.6241,-593.3775"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge26" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modeb.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M597.5,-1245.9323C576.3893,-1246.0108 525.7462,-1260.0836 488.0577,-1271.5131"/>
<polygon fill="#ff0000" stroke="#ff0000" points="486.832,-1268.2279 478.2947,-1274.502 488.8812,-1274.9213 486.832,-1268.2279"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge27" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modchecksim.f90</title>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M1010,-435.9323C928.3658,-420.4799 813.888,-671.8871 732,-685.9323"/>
<path fill="none" stroke="#ffb700" stroke-dasharray="5,2" d="M732,-685.9323C685.4394,-697.4114 686.3149,-645.5108 643,-624.9323 599.1902,-604.1188 546.4658,-588.9549 506.0811,-579.2154"/>
<polygon fill="#ffb700" stroke="#ffb700" points="506.6294,-575.7487 496.0926,-576.856 505.0201,-582.5612 506.6294,-575.7487"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge29" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M597.5,-1245.9323C528.6116,-1246.1884 511.1218,-1251.9928 442.5,-1245.9323"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge33" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstatsdump.f90</title>
<path fill="none" stroke="#cbff00" stroke-dasharray="5,2" d="M1127.1769,-448.1315C1104.2531,-467.6559 1059.1558,-506.0658 1032.0839,-529.1232"/>
<polygon fill="#cbff00" stroke="#cbff00" points="1029.649,-526.5996 1024.3055,-535.7482 1034.1879,-531.9287 1029.649,-526.5996"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge36" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsave.f90</title>
<path fill="none" stroke="#8eff00" stroke-dasharray="5,2" d="M1010,-435.9323C834.342,-399.5369 815.4459,-317.3565 643,-267.9323 593.3861,-253.7126 534.6204,-247.2503 493.5836,-244.3251"/>
<polygon fill="#8eff00" stroke="#8eff00" points="493.7599,-240.8292 483.5489,-243.6551 493.2935,-247.8137 493.7599,-240.8292"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge37" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modstartup.f90</title>
<path fill="none" stroke="#14ff00" stroke-dasharray="5,2" d="M1137.4203,-423.8948C1118.8236,-369.0239 1041.9415,-142.178 1017.4974,-70.054"/>
<polygon fill="#14ff00" stroke="#14ff00" points="1020.6872,-68.5613 1014.1625,-60.214 1014.0576,-70.8083 1020.6872,-68.5613"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge60" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M732,-685.9323C607.2881,-717.5877 570.9019,-677.6825 442.5,-685.9323"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge67" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modsubgrid.f90</title>
<path fill="none" stroke="#00ff66" stroke-dasharray="5,2" d="M1010,-435.9323C983.4205,-431.1143 953.5449,-430.4647 928.1988,-431.2788"/>
<polygon fill="#00ff66" stroke="#00ff66" points="927.8511,-427.7899 918.0009,-431.6915 928.1343,-434.7841 927.8511,-427.7899"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge70" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modibm.f90</title>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M1141.025,-447.9796C1137.4563,-532.1439 1112.1164,-1031.7945 1010,-1133.9323"/>
<path fill="none" stroke="#00ffa3" stroke-dasharray="5,2" d="M1010,-1133.9323C990.7573,-1153.1791 615.9917,-1023.2356 486.2552,-977.4682"/>
<polygon fill="#00ffa3" stroke="#00ffa3" points="487.2198,-974.097 476.625,-974.0667 484.8884,-980.6974 487.2198,-974.097"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge77" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M1010,-1133.9323C957.9653,-1187.7853 942.5486,-1210.4502 869.5,-1226.9323"/>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M869.5,-1226.9323C692.1177,-1266.9554 684.5111,-1089.2723 516,-1020.9323 498.7564,-1013.9391 391.0029,-988.3596 329.2882,-973.9586"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="329.9662,-970.5229 319.4328,-971.6626 328.3778,-977.3403 329.9662,-970.5229"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge83" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modthermodynamics.f90</title>
<path fill="none" stroke="#00a3ff" stroke-dasharray="5,2" d="M1010,-435.9323C968.7319,-428.4518 959.6768,-452.2361 918,-456.9323 812.371,-468.8347 783.6365,-466.6505 679,-447.9323 621.0037,-437.5575 604.1381,-437.37 552,-409.9323 533.8183,-400.3642 534.2408,-390.3872 516,-380.9323 512.2223,-378.9742 508.2379,-377.1772 504.158,-375.5316"/>
<polygon fill="#00a3ff" stroke="#00a3ff" points="505.1098,-372.1518 494.5166,-371.9622 502.6794,-378.7164 505.1098,-372.1518"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge85" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M1010,-7.9323C986.1938,3.2046 976.4173,-13.2126 954,-26.9323 934.9664,-38.5812 936.2212,-49.0497 918,-61.9323 878.7241,-89.7008 861.7464,-84.3705 821,-109.9323 803.8293,-120.7042 802.1892,-127.1901 785,-137.9323 779.8219,-141.1684 774.1834,-144.3064 768.5792,-147.2167"/>
<polygon fill="#0028ff" stroke="#0028ff" points="766.6438,-144.2714 759.2675,-151.8768 769.7766,-150.5313 766.6438,-144.2714"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge91" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modfielddump.f90</title>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M869.5,-1226.9323C751.336,-1253.8154 718.6835,-1245.9323 597.5,-1245.9323"/>
<path fill="none" stroke="#8e00ff" stroke-dasharray="5,2" d="M597.5,-1245.9323C576.7082,-1246.0096 527.2695,-1232.3315 489.7744,-1220.9513"/>
<polygon fill="#8e00ff" stroke="#8e00ff" points="490.6243,-1217.5512 480.0376,-1217.967 488.5729,-1224.2439 490.6243,-1217.5512"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge92" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modpois.f90</title>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M1101.7541,-439.5997C1075.4953,-441.1265 1040.4384,-441.4498 1010,-435.9323"/>
<path fill="none" stroke="#ff00f4" stroke-dasharray="5,2" d="M1010,-435.9323C910.5373,-417.903 969.3155,-315.0219 918,-227.9323 908.7995,-212.3178 896.4364,-196.0579 886.4953,-183.8346"/>
<polygon fill="#ff00f4" stroke="#ff00f4" points="889.1427,-181.5439 880.0685,-176.0748 883.7515,-186.0089 889.1427,-181.5439"/>
</g>
<!-- sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge94" class="edge">
<title>sourcefile~program.f90&#45;&gt;sourcefile~modforces.f90</title>
<path fill="none" stroke="#ff007a" stroke-dasharray="5,2" d="M1010,-435.9323C955.5684,-424.2592 960.4338,-386.9661 918,-350.9323 838.1023,-283.0852 836.3553,-196.0919 732,-205.9323"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge22" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M844.8598,-151.756C837.0676,-147.634 828.5287,-142.8281 821,-137.9323 804.0071,-126.8822 802.3529,-120.408 785,-109.9323 762.8629,-96.5685 757.253,-91.4934 732,-85.9323"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge61" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M829.5554,-176.1108C826.5732,-177.5649 823.6846,-179.1687 821,-180.9323 801.2849,-193.8845 803.6583,-205.4994 785,-219.9323 728.3807,-263.7296 711.2721,-274.418 643,-295.9323 557.4023,-322.9064 528.1775,-293.2129 442.5,-319.9323"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge87" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modboundary.f90</title>
<path fill="none" stroke="#0028ff" stroke-dasharray="5,2" d="M829.7293,-163.9323C818.994,-163.9323 807.1047,-163.9323 795.4219,-163.9323"/>
<polygon fill="#0028ff" stroke="#0028ff" points="795.2426,-160.4324 785.2426,-163.9323 795.2425,-167.4324 795.2426,-160.4324"/>
</g>
<!-- sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge114" class="edge">
<title>sourcefile~modpois.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M864.872,-175.9812C850.8496,-210.7233 805.2498,-311.563 732,-357.9323"/>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M732,-357.9323C633.4595,-420.3114 622.0852,-458.4832 516,-506.9323 485.3088,-520.949 475.4966,-518.8867 442.5,-525.9323"/>
</g>
<!-- sourcefile~wf_uno.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node24" class="node">
<title>sourcefile~wf_uno.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node24"><a xlink:href=".././sourcefile/wf_uno.f90.html" xlink:title="wf_uno.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="477.5,-1095.9323 407.5,-1095.9323 407.5,-1071.9323 477.5,-1071.9323 477.5,-1095.9323"/>
<text text-anchor="middle" x="442.5" y="-1081.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">wf_uno.f90</text>
</a>
</g>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge23" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286,-1079.9323C235.7967,-1048.2905 204.93,-1078.2525 158,-1041.9323"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge62" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M407.2276,-1092.6891C373.4285,-1098.9867 322.3291,-1102.8296 286,-1079.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-1079.9323C266.1576,-1067.4262 253.0139,-1074.7402 239,-1055.9323 188.5745,-988.257 165.3911,-718.4172 159.5357,-638.4048"/>
<polygon fill="#00ff28" stroke="#00ff28" points="162.998,-637.7497 158.7963,-628.0237 156.0157,-638.2471 162.998,-637.7497"/>
</g>
<!-- sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge78" class="edge">
<title>sourcefile~wf_uno.f90&#45;&gt;sourcefile~initfac.f90</title>
<path fill="none" stroke="#00e0ff" stroke-dasharray="5,2" d="M407.4069,-1078.3696C394.6036,-1075.227 380.4659,-1070.374 369,-1062.9323 352.5914,-1052.2827 320.0085,-1010.1822 300.9113,-984.4353"/>
<polygon fill="#00e0ff" stroke="#00e0ff" points="303.5142,-982.0673 294.7674,-976.0887 297.8768,-986.217 303.5142,-982.0673"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge24" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M397.2129,-197.7721C354.8595,-197.3136 290.5741,-200.6819 239,-220.9323 197.0511,-237.4035 192.2125,-252.5977 158,-281.9323"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge65" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M397.3993,-200.6367C362.1875,-203.6748 314.5889,-213.6717 286,-243.9323"/>
</g>
<!-- sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge117" class="edge">
<title>sourcefile~modforces.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M397.3166,-204.572C386.7374,-207.7062 376.4071,-212.7798 369,-220.9323 309.7352,-286.1611 361.7178,-332.6113 333,-415.9323 324.4703,-440.6802 310.0213,-467.0008 299.3905,-484.7421"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="296.173,-483.2946 293.9392,-493.6513 302.144,-486.9482 296.173,-483.2946"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modmpi.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge25" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modmpi.f90</title>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M427.5237,-814.1163C394.3616,-840.9786 315.3522,-904.3059 286,-921.9323"/>
<path fill="none" stroke="#ff0000" stroke-dasharray="5,2" d="M286,-921.9323C266.3857,-933.711 257.1772,-929.0383 239,-942.9323 193.8328,-977.4566 203.0646,-1076.5904 158,-1041.9323"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge32" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modstat_nc.f90</title>
<path fill="none" stroke="#fff400" stroke-dasharray="5,2" d="M419.1316,-814.0781C402.2016,-824.2045 380.3666,-840.2925 369,-860.9323 300.1728,-985.9114 412.2548,-1061.2916 333,-1179.9323 331.0834,-1182.8013 328.7391,-1185.3841 326.1306,-1187.7035"/>
<polygon fill="#fff400" stroke="#fff400" points="323.6769,-1185.1623 317.6767,-1193.8943 327.8127,-1190.8099 323.6769,-1185.1623"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge66" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M406.9222,-814.0499C363.8603,-828.2504 295.8542,-849.0036 286,-841.9323"/>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M286,-841.9323C213.7576,-790.092 176.8626,-684.0222 163.7239,-638.025"/>
<polygon fill="#00ff28" stroke="#00ff28" points="167.0426,-636.8933 161.016,-628.1795 160.2933,-638.7497 167.0426,-636.8933"/>
</g>
<!-- sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge118" class="edge">
<title>sourcefile~modstatistics.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M434.5753,-789.7617C419.8363,-766.6649 387.9852,-714.5224 369,-666.9323 345.991,-609.2558 371.2222,-580.8717 333,-531.9323 330.6826,-528.9651 327.927,-526.2871 324.9292,-523.8809"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="326.7872,-520.9109 316.5626,-518.1344 322.824,-526.681 326.7872,-520.9109"/>
</g>
<!-- sourcefile~advection.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node27" class="node">
<title>sourcefile~advection.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node27"><a xlink:href=".././sourcefile/advection.f90.html" xlink:title="advection.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="485,-497.9323 400,-497.9323 400,-473.9323 485,-473.9323 485,-497.9323"/>
<text text-anchor="middle" x="442.5" y="-483.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advection.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge47" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M399.8964,-476.6502C389.5025,-473.609 378.614,-469.7409 369,-464.9323 327.5801,-444.2156 326.3141,-379.1383 286,-401.9323"/>
</g>
<!-- sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge104" class="edge">
<title>sourcefile~advection.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M399.7357,-491.3974C380.9312,-493.8006 358.6579,-496.647 338.8282,-499.1811"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="338.1882,-495.7344 328.7126,-500.4738 339.0756,-502.6779 338.1882,-495.7344"/>
</g>
<!-- sourcefile~advec_kappa.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node28" class="node">
<title>sourcefile~advec_kappa.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node28"><a xlink:href=".././sourcefile/advec_kappa.f90.html" xlink:title="advec_kappa.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="494,-455.9323 391,-455.9323 391,-431.9323 494,-431.9323 494,-455.9323"/>
<text text-anchor="middle" x="442.5" y="-441.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_kappa.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge63" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M400.2405,-431.8248C354.7708,-418.9105 288.5636,-400.4828 286,-401.9323"/>
</g>
<!-- sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge115" class="edge">
<title>sourcefile~advec_kappa.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M395.4229,-456.0142C386.5503,-458.6755 377.4183,-461.6811 369,-464.9323 351.2454,-471.7892 332.1561,-481.0757 316.7661,-489.0768"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="314.9161,-486.0955 307.7067,-493.8592 318.1841,-492.2859 314.9161,-486.0955"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge64" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M409.6058,-658.0453C371.0209,-671.5983 309.356,-691.036 286,-685.9323"/>
</g>
<!-- sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge116" class="edge">
<title>sourcefile~modchem.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M424.2408,-633.7508C408.4927,-622.6964 385.7152,-605.3499 369,-586.9323 349.3657,-565.2984 354.4111,-551.8094 333,-531.9323 329.6812,-528.8513 325.9302,-526.0036 322.0305,-523.4116"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="323.7307,-520.3493 313.3657,-518.1542 320.0995,-526.3339 323.7307,-520.3493"/>
</g>
<!-- sourcefile~advec_upw.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_node30" class="node">
<title>sourcefile~advec_upw.f90</title>
<g id="a_sourcefile~~modmpi.f90~~AfferentGraph_node30"><a xlink:href=".././sourcefile/advec_upw.f90.html" xlink:title="advec_upw.f90">
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="488,-413.9323 397,-413.9323 397,-389.9323 488,-389.9323 488,-413.9323"/>
<text text-anchor="middle" x="442.5" y="-399.5323" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">advec_upw.f90</text>
</a>
</g>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge49" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M396.6682,-390.5762C363.7501,-385.0056 319.4667,-383.0099 286,-401.9323"/>
</g>
<!-- sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge106" class="edge">
<title>sourcefile~advec_upw.f90&#45;&gt;sourcefile~modfields.f90</title>
<path fill="none" stroke="#cc00ff" stroke-dasharray="5,2" d="M396.7078,-411.1311C387.1763,-414.0963 377.4641,-417.952 369,-422.9323 341.2797,-439.243 316.1918,-466.9898 301.0267,-485.8719"/>
<polygon fill="#cc00ff" stroke="#cc00ff" points="298.1894,-483.8184 294.7834,-493.8509 303.7023,-488.1321 298.1894,-483.8184"/>
</g>
<!-- sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90 -->
<g id="sourcefile~~modmpi.f90~~AfferentGraph_edge52" class="edge">
<title>sourcefile~modfields.f90&#45;&gt;sourcefile~modglobal.f90</title>
<path fill="none" stroke="#00ff28" stroke-dasharray="5,2" d="M260.7418,-518.1072C253.4444,-522.0936 245.6586,-526.8237 239,-531.9323 214.2747,-550.9022 190.0171,-577.4043 174.5928,-595.5371"/>
<polygon fill="#00ff28" stroke="#00ff28" points="171.4988,-593.7808 167.767,-603.6967 176.8679,-598.2722 171.4988,-593.7808"/>
</g>
</g>
</svg>
</div><script>var pansourcefilemodmpif90AfferentGraph = svgPanZoom('#sourcefilemodmpif90AfferentGraph', {zoomEnabled: true,controlIconsEnabled: true, fit: true, center: true,}); </script><div><a type="button" class="graph-help" data-toggle="modal" href="#graph-help-text">Help</a></div><div class="modal fade" id="graph-help-text" tabindex="-1" role="dialog"><div class="modal-dialog modal-lg" role="document"><div class="modal-content"><div class="modal-header"><button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="modal-title" id="-graph-help-label">Graph Key</h4></div><div class="modal-body">
    <p>Nodes of different colours represent the following: </p>
    <?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.40.1 (20161225.0304)
 -->
<!-- Title: Graph Key Pages: 1 -->
<svg width="202pt" height="32pt"
 viewBox="0.00 0.00 201.50 32.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 28)">
<title>Graph Key</title>
<polygon fill="#ffffff" stroke="transparent" points="-4,4 -4,-28 197.5,-28 197.5,4 -4,4"/>
<!-- Source File -->
<g id="node1" class="node">
<title>Source File</title>
<polygon fill="#f0ad4e" stroke="#f0ad4e" points="71,-24 0,-24 0,0 71,0 71,-24"/>
<text text-anchor="middle" x="35.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#ffffff">Source File</text>
</g>
<!-- This Page&#39;s Entity -->
<g id="node2" class="node">
<title>This Page&#39;s Entity</title>
<polygon fill="none" stroke="#000000" points="193.5,-24 89.5,-24 89.5,0 193.5,0 193.5,-24"/>
<text text-anchor="middle" x="141.5" y="-9.6" font-family="Helvetica,sans-Serif" font-size="10.50" fill="#000000">This Page&#39;s Entity</text>
</g>
</g>
</svg>

    
    <p>Solid arrows point from a file to a file which it depends on. A file
    is dependent upon another if the latter must be compiled before the former
    can be. Where possible, edges connecting nodes are given different colours to make them easier to distinguish in large graphs.
    </p>
    </div></div></div></div>
      </div>
    </div>
      
      <br>

    <section class="visible-xs visible-sm hidden-md">
      
<h3>Contents</h3>
 







<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title"><a data-toggle="collapse" href="#mods-1">Modules</a></h3></div>
  <div id="mods-1" class="panel-collapse collapse">
    <div class="list-group">
      
      <a class="list-group-item" href="../module/modmpi.html">modmpi</a>
      
    </div>
  </div>
</div>
















<div class="panel panel-primary">
  <div class="panel-heading text-left"><h3 class="panel-title">Source Code</h3></div>
  <div class="list-group">
    <a class="list-group-item" href="../sourcefile/modmpi.f90.html#src">modmpi.f90</a>
  </div>
</div>



    </section>
    <br class="visible-xs visible-sm hidden-md">

    <section>
      <h2><span class="anchor" id="src"></span>Source Code</h2>
    <div class="hl"><pre><span></span><a name="ln-1"></a><span class="c">!&gt; \file modmpi.f90</span>
<a name="ln-2"></a><span class="c">!!  Layer to deal with the parallelization.</span>
<a name="ln-3"></a>
<a name="ln-4"></a><span class="c">!&gt;</span>
<a name="ln-5"></a><span class="c">!!  Layer to deal with the parallelization.</span>
<a name="ln-6"></a><span class="c">!&gt;</span>
<a name="ln-7"></a><span class="c">!!  \author Matthieu Pourquie, TU Delft</span>
<a name="ln-8"></a><span class="c">!!  \par Revision list</span>
<a name="ln-9"></a><span class="c">!!  \todo Documentation</span>
<a name="ln-10"></a><span class="c">!!  \todo 2D/3D parallelization</span>
<a name="ln-11"></a><span class="c">!!  \todo Include interfaces for MPI_ALLREDUCE, MPI_ALLTOALL, MPI_BCAST,</span>
<a name="ln-12"></a><span class="c">!! MPI_SENDRECV to get rid of pure mpi calls in the code</span>
<a name="ln-13"></a><span class="c">!  This file is part of DALES.</span>
<a name="ln-14"></a><span class="c">!</span>
<a name="ln-15"></a><span class="c">! DALES is free software; you can redistribute it and/or modify</span>
<a name="ln-16"></a><span class="c">! it under the terms of the GNU General Public License as published by</span>
<a name="ln-17"></a><span class="c">! the Free Software Foundation; either version 3 of the License, or</span>
<a name="ln-18"></a><span class="c">! (at your option) any later version.</span>
<a name="ln-19"></a><span class="c">!</span>
<a name="ln-20"></a><span class="c">! DALES is distributed in the hope that it will be useful,</span>
<a name="ln-21"></a><span class="c">! but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<a name="ln-22"></a><span class="c">! MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<a name="ln-23"></a><span class="c">! GNU General Public License for more details.</span>
<a name="ln-24"></a><span class="c">!</span>
<a name="ln-25"></a><span class="c">! You should have received a copy of the GNU General Public License</span>
<a name="ln-26"></a><span class="c">! along with this program.  If not, see &lt;http://www.gnu.org/licenses/&gt;.</span>
<a name="ln-27"></a><span class="c">!</span>
<a name="ln-28"></a><span class="c">!  Copyright 1993-2009 Delft University of Technology, Wageningen University, Utrecht University, KNMI</span>
<a name="ln-29"></a><span class="c">!</span>
<a name="ln-30"></a>
<a name="ln-31"></a>
<a name="ln-32"></a>
<a name="ln-33"></a><span class="k">module </span><span class="n">modmpi</span>
<a name="ln-34"></a><span class="k">use </span><span class="n">mpi</span>
<a name="ln-35"></a><span class="k">implicit none</span>
<a name="ln-36"></a><span class="k">save</span>
<a name="ln-37"></a><span class="k">  </span><span class="kt">integer </span><span class="n">comm3d</span>
<a name="ln-38"></a>  <span class="kt">integer </span><span class="n">nbrtop</span>
<a name="ln-39"></a>  <span class="kt">integer </span><span class="n">nbrbottom</span>
<a name="ln-40"></a>  <span class="kt">integer </span><span class="n">myid</span>
<a name="ln-41"></a>  <span class="kt">integer </span><span class="n">nprocs</span>
<a name="ln-42"></a>  <span class="kt">integer </span><span class="n">mpierr</span>
<a name="ln-43"></a>  <span class="kt">integer </span><span class="n">my_real</span>
<a name="ln-44"></a>  <span class="kt">real    </span><span class="n">CPU_program</span>    <span class="c">!end time</span>
<a name="ln-45"></a>  <span class="kt">real    </span><span class="n">CPU_program0</span>   <span class="c">!start time</span>
<a name="ln-46"></a>
<a name="ln-47"></a>   <span class="kt">character</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span> <span class="kd">::</span> <span class="n">cmyid</span>
<a name="ln-48"></a>
<a name="ln-49"></a><span class="k">contains</span>
<a name="ln-50"></a><span class="k">  subroutine </span><span class="n">initmpi</span>
<a name="ln-51"></a>    <span class="k">implicit none</span>
<a name="ln-52"></a><span class="k">    </span><span class="kt">integer </span><span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-53"></a>    <span class="kt">logical </span><span class="n">periods</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-54"></a>    <span class="kt">integer </span><span class="n">periods2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<a name="ln-55"></a>
<a name="ln-56"></a>    <span class="k">call </span><span class="n">MPI_INIT</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-57"></a>    <span class="n">MY_REAL</span> <span class="o">=</span> <span class="n">MPI_DOUBLE_PRECISION</span>  <span class="c">!MPI_REAL8 should be the same..</span>
<a name="ln-58"></a>    <span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-59"></a>    <span class="k">call </span><span class="n">MPI_COMM_SIZE</span><span class="p">(</span> <span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="n">nprocs</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-60"></a><span class="c">! Specify the # procs in each direction.</span>
<a name="ln-61"></a><span class="c">! specifying a 0 means that MPI will try to find a useful # procs in</span>
<a name="ln-62"></a><span class="c">! the corresponding  direction,</span>
<a name="ln-63"></a>
<a name="ln-64"></a><span class="c">! specifying 1 means only 1 processor in this direction, meaning that</span>
<a name="ln-65"></a><span class="c">! we have in fact a grid of (at most) 2 dimensions left. This is used</span>
<a name="ln-66"></a><span class="c">! when we want the array index range in 1 particular direction to be</span>
<a name="ln-67"></a><span class="c">! present on all processors in the grid</span>
<a name="ln-68"></a>
<a name="ln-69"></a>    <span class="n">dims</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-70"></a>
<a name="ln-71"></a>
<a name="ln-72"></a><span class="c">! directions 1 and 2 are chosen periodic</span>
<a name="ln-73"></a>
<a name="ln-74"></a>
<a name="ln-75"></a>    <span class="n">periods</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="p">.</span><span class="n">true</span><span class="p">.</span>
<a name="ln-76"></a><span class="c">! Soares 20080115</span>
<a name="ln-77"></a>    <span class="n">periods2</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span>
<a name="ln-78"></a>
<a name="ln-79"></a><span class="c">! find suitable # procs in each direction</span>
<a name="ln-80"></a>
<a name="ln-81"></a>    <span class="k">call </span><span class="n">MPI_DIMS_CREATE</span><span class="p">(</span> <span class="n">nprocs</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-82"></a>
<a name="ln-83"></a><span class="c">! create the Cartesian communicator, denoted by the integer comm3d</span>
<a name="ln-84"></a>
<a name="ln-85"></a>    <span class="c">! BUG - Thijs, Harm</span>
<a name="ln-86"></a>    <span class="c">!call MPI_CART_CREATE(MPI_COMM_WORLD, 1, dims, periods,.false., &amp;</span>
<a name="ln-87"></a>    <span class="c">!                    comm3d, ierr )</span>
<a name="ln-88"></a>
<a name="ln-89"></a>    <span class="k">call </span><span class="n">MPI_CART_CREATE</span><span class="p">(</span><span class="n">MPI_COMM_WORLD</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dims</span><span class="p">,</span> <span class="n">periods</span><span class="p">,.</span><span class="n">true</span><span class="p">.,</span> <span class="p">&amp;</span>
<a name="ln-90"></a>                        <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-91"></a>
<a name="ln-92"></a><span class="c">! Soares 20080115</span>
<a name="ln-93"></a><span class="c">!     call MPI_CART_CREATE(MPI_COMM_WORLD, 1, dims, periods2,1, &amp;</span>
<a name="ln-94"></a><span class="c">!                         comm3d, mpierr )</span>
<a name="ln-95"></a>
<a name="ln-96"></a><span class="c">! Get my processor number in this communicator</span>
<a name="ln-97"></a>
<a name="ln-98"></a>    <span class="k">call </span><span class="n">MPI_COMM_RANK</span><span class="p">(</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">myid</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-99"></a>
<a name="ln-100"></a>
<a name="ln-101"></a><span class="c">! when applying boundary conditions, we need to know which processors</span>
<a name="ln-102"></a><span class="c">! are neighbours in all 3 directions</span>
<a name="ln-103"></a>
<a name="ln-104"></a>
<a name="ln-105"></a><span class="c">! these are determined with the aid of the MPI routine MPI_CART_SHIFT,</span>
<a name="ln-106"></a>
<a name="ln-107"></a>    <span class="k">call </span><span class="n">MPI_CART_SHIFT</span><span class="p">(</span> <span class="n">comm3d</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">,</span> <span class="n">nbrbottom</span><span class="p">,</span> <span class="n">nbrtop</span><span class="p">,</span>   <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-108"></a>
<a name="ln-109"></a><span class="c">! determine some useful MPI datatypes for sending/receiving data</span>
<a name="ln-110"></a>
<a name="ln-111"></a>     <span class="k">write</span><span class="p">(</span><span class="n">cmyid</span><span class="p">,</span><span class="s1">&#39;(i3.3)&#39;</span><span class="p">)</span> <span class="n">myid</span>
<a name="ln-112"></a>
<a name="ln-113"></a>    <span class="k">if</span><span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-114"></a><span class="k">      </span><span class="n">CPU_program0</span> <span class="o">=</span> <span class="n">MPI_Wtime</span><span class="p">()</span>
<a name="ln-115"></a>    <span class="k">end if</span>
<a name="ln-116"></a>
<a name="ln-117"></a><span class="k">    write</span><span class="p">(</span><span class="o">*</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;nprocs = &#39;</span><span class="p">,</span> <span class="n">nprocs</span>
<a name="ln-118"></a>  <span class="k">end subroutine </span><span class="n">initmpi</span>
<a name="ln-119"></a>
<a name="ln-120"></a><span class="c">!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span>
<a name="ln-121"></a>
<a name="ln-122"></a>  <span class="k">subroutine </span><span class="n">exitmpi</span>
<a name="ln-123"></a>    <span class="k">implicit none</span>
<a name="ln-124"></a>
<a name="ln-125"></a>
<a name="ln-126"></a><span class="k">    if</span><span class="p">(</span><span class="n">myid</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span><span class="k">then</span>
<a name="ln-127"></a><span class="k">      </span><span class="n">CPU_program</span> <span class="o">=</span> <span class="n">MPI_Wtime</span><span class="p">()</span> <span class="o">-</span> <span class="n">CPU_program0</span>
<a name="ln-128"></a>      <span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="o">*</span><span class="p">)</span><span class="s1">&#39;TOTAL CPU time = &#39;</span><span class="p">,</span> <span class="n">CPU_program</span>
<a name="ln-129"></a>    <span class="k">end if</span>
<a name="ln-130"></a>
<a name="ln-131"></a><span class="k">    call </span><span class="n">MPI_Comm_free</span><span class="p">(</span> <span class="n">comm3d</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-132"></a>    <span class="k">call </span><span class="n">MPI_FINALIZE</span><span class="p">(</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-133"></a>  <span class="k">end subroutine </span><span class="n">exitmpi</span>
<a name="ln-134"></a>
<a name="ln-135"></a>  <span class="k">subroutine </span><span class="n">barrou</span><span class="p">()</span>
<a name="ln-136"></a>    <span class="k">implicit none</span>
<a name="ln-137"></a><span class="k">    call </span><span class="n">MPI_BARRIER</span><span class="p">(</span><span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-138"></a>
<a name="ln-139"></a>  <span class="k">return</span>
<a name="ln-140"></a><span class="k">  end subroutine </span><span class="n">barrou</span>
<a name="ln-141"></a>
<a name="ln-142"></a>
<a name="ln-143"></a>
<a name="ln-144"></a>  <span class="k">subroutine </span><span class="n">excj</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="p">)</span>
<a name="ln-145"></a>    <span class="k">implicit none</span>
<a name="ln-146"></a>
<a name="ln-147"></a><span class="k">  </span><span class="kt">integer </span><span class="n">sx</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">ez</span>
<a name="ln-148"></a>  <span class="kt">real </span><span class="n">a</span><span class="p">(</span><span class="n">sx</span><span class="p">:</span><span class="n">ex</span><span class="p">,</span> <span class="n">sy</span><span class="p">:</span><span class="n">ey</span><span class="p">,</span> <span class="n">sz</span><span class="p">:</span><span class="n">ez</span><span class="p">)</span>
<a name="ln-149"></a>  <span class="kt">integer </span><span class="n">iiget</span><span class="p">,</span> <span class="n">status</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">)</span>
<a name="ln-150"></a>  <span class="kt">integer </span><span class="n">ii</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-151"></a>  <span class="kt">real</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span>
<a name="ln-152"></a>  <span class="n">iiget</span> <span class="o">=</span> <span class="p">(</span><span class="n">ex</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ez</span> <span class="o">-</span> <span class="n">sz</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-153"></a>
<a name="ln-154"></a>  <span class="k">allocate</span><span class="p">(</span> <span class="n">buffj1</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span>
<a name="ln-155"></a>            <span class="n">buffj2</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span>
<a name="ln-156"></a>            <span class="n">buffj3</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span>
<a name="ln-157"></a>            <span class="n">buffj4</span><span class="p">(</span><span class="n">iiget</span><span class="p">))</span>
<a name="ln-158"></a>
<a name="ln-159"></a>
<a name="ln-160"></a>
<a name="ln-161"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-162"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-163"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span>
<a name="ln-164"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">sz</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-165"></a>      <span class="n">buffj1</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-166"></a>    <span class="n">enddo</span>
<a name="ln-167"></a>    <span class="n">enddo</span>
<a name="ln-168"></a>  <span class="n">endif</span>
<a name="ln-169"></a>  <span class="k">call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span>  <span class="n">buffj1</span><span class="p">,</span>  <span class="n">ii</span>    <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrtop</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-170"></a>                      <span class="n">buffj2</span><span class="p">,</span>  <span class="n">iiget</span> <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrbottom</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span>      <span class="p">&amp;</span>
<a name="ln-171"></a>                      <span class="n">comm3d</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-172"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-173"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-174"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span>
<a name="ln-175"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">sz</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-176"></a>      <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">buffj2</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-177"></a>    <span class="n">enddo</span>
<a name="ln-178"></a>    <span class="n">enddo</span>
<a name="ln-179"></a>  <span class="n">endif</span>
<a name="ln-180"></a>
<a name="ln-181"></a><span class="c">!   call barrou()</span>
<a name="ln-182"></a>
<a name="ln-183"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-184"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-185"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span>
<a name="ln-186"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">sz</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-187"></a>      <span class="n">buffj3</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-188"></a>    <span class="n">enddo</span>
<a name="ln-189"></a>    <span class="n">enddo</span>
<a name="ln-190"></a>  <span class="n">endif</span>
<a name="ln-191"></a>  <span class="k">call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span>  <span class="n">buffj3</span><span class="p">,</span>  <span class="n">ii</span>    <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrbottom</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-192"></a>                          <span class="n">buffj4</span><span class="p">,</span>  <span class="n">iiget</span> <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrtop</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-193"></a>                          <span class="n">comm3d</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-194"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-195"></a><span class="k">    do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-196"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="p">,</span><span class="n">ex</span>
<a name="ln-197"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="n">sz</span> <span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-198"></a>      <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">buffj4</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-199"></a>    <span class="n">enddo</span>
<a name="ln-200"></a>    <span class="n">enddo</span>
<a name="ln-201"></a>  <span class="n">endif</span>
<a name="ln-202"></a>
<a name="ln-203"></a><span class="c">!   call barrou()</span>
<a name="ln-204"></a>  <span class="k">deallocate</span> <span class="p">(</span><span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span><span class="p">)</span>
<a name="ln-205"></a>
<a name="ln-206"></a>  <span class="k">return</span>
<a name="ln-207"></a><span class="k">  end subroutine </span><span class="n">excj</span>
<a name="ln-208"></a>
<a name="ln-209"></a>  <span class="c">! tg3315 - does some transfer of ghost cell information in the y-direction.</span>
<a name="ln-210"></a>  <span class="c">! nbrbottom is cpu below and nbrtop is cpu above</span>
<a name="ln-211"></a>  <span class="c">! MPI_PROC_NULL = -2???</span>
<a name="ln-212"></a>  <span class="k">subroutine </span><span class="n">excjs</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">sx</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span><span class="n">ez</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">)</span>
<a name="ln-213"></a>    <span class="k">implicit none</span>
<a name="ln-214"></a><span class="k">  </span><span class="kt">integer </span><span class="n">sx</span><span class="p">,</span> <span class="n">ex</span><span class="p">,</span> <span class="n">sy</span><span class="p">,</span> <span class="n">ey</span><span class="p">,</span> <span class="n">sz</span><span class="p">,</span> <span class="n">ez</span><span class="p">,</span> <span class="n">ih</span><span class="p">,</span> <span class="n">jh</span>
<a name="ln-215"></a>  <span class="kt">real </span><span class="n">a</span><span class="p">(</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">:</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span><span class="p">,</span> <span class="n">sy</span><span class="o">-</span><span class="n">jh</span><span class="p">:</span><span class="n">ey</span><span class="o">+</span><span class="n">jh</span><span class="p">,</span> <span class="n">sz</span><span class="p">:</span><span class="n">ez</span><span class="p">)</span>
<a name="ln-216"></a>  <span class="kt">integer </span><span class="n">status</span><span class="p">(</span><span class="n">MPI_STATUS_SIZE</span><span class="p">),</span> <span class="n">iiget</span>
<a name="ln-217"></a>  <span class="kt">integer </span><span class="n">ii</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span>
<a name="ln-218"></a>  <span class="kt">real</span><span class="p">,</span><span class="k">allocatable</span><span class="p">,</span> <span class="k">dimension</span><span class="p">(:)</span> <span class="kd">::</span> <span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span>
<a name="ln-219"></a>  <span class="n">iiget</span> <span class="o">=</span> <span class="n">jh</span><span class="o">*</span><span class="p">(</span><span class="n">ex</span> <span class="o">-</span> <span class="n">sx</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">+</span> <span class="mi">2</span><span class="o">*</span><span class="n">ih</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ez</span> <span class="o">-</span> <span class="n">sz</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
<a name="ln-220"></a>
<a name="ln-221"></a>  <span class="k">allocate</span><span class="p">(</span> <span class="n">buffj1</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span>
<a name="ln-222"></a>            <span class="n">buffj2</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span>
<a name="ln-223"></a>            <span class="n">buffj3</span><span class="p">(</span><span class="n">iiget</span><span class="p">),&amp;</span>
<a name="ln-224"></a>            <span class="n">buffj4</span><span class="p">(</span><span class="n">iiget</span><span class="p">))</span>
<a name="ln-225"></a>
<a name="ln-226"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-227"></a><span class="k">    </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-228"></a>    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span>
<a name="ln-229"></a>    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-230"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span>
<a name="ln-231"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-232"></a>      <span class="n">buffj1</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="o">-</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="c">! tg3315 buffj1 is je-jhc ghost cells on myid</span>
<a name="ln-233"></a>    <span class="n">enddo</span>
<a name="ln-234"></a>    <span class="n">enddo</span>
<a name="ln-235"></a>    <span class="n">enddo</span>
<a name="ln-236"></a>  <span class="n">endif</span>
<a name="ln-237"></a>
<a name="ln-238"></a>  <span class="k">call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span>  <span class="n">buffj1</span><span class="p">,</span>  <span class="n">ii</span>    <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrtop</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-239"></a>                           <span class="n">buffj2</span><span class="p">,</span>  <span class="n">iiget</span> <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrbottom</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-240"></a>                           <span class="n">comm3d</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-241"></a>
<a name="ln-242"></a>  <span class="c">! tg3315 sends this to nbrtop and pulls buffj2 from nbrbottom! send and receive process that is good for executing chain shifts.</span>
<a name="ln-243"></a>
<a name="ln-244"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-245"></a><span class="k">    </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-246"></a>    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span>
<a name="ln-247"></a>    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-248"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span>
<a name="ln-249"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-250"></a>      <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="o">-</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">buffj2</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="c">! set the previous ghost cells to buffj2 (last cells of nbrbottom I think)</span>
<a name="ln-251"></a>    <span class="n">enddo</span>
<a name="ln-252"></a>    <span class="n">enddo</span>
<a name="ln-253"></a>    <span class="n">enddo</span>
<a name="ln-254"></a>  <span class="n">endif</span>
<a name="ln-255"></a>
<a name="ln-256"></a><span class="c">!   call barrou()</span>
<a name="ln-257"></a>
<a name="ln-258"></a>  <span class="c">! repeats this process for other way round</span>
<a name="ln-259"></a>
<a name="ln-260"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrbottom</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-261"></a><span class="k">    </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-262"></a>    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span>
<a name="ln-263"></a>    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-264"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span>
<a name="ln-265"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-266"></a>      <span class="n">buffj3</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span> <span class="o">=</span> <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">sy</span><span class="o">+</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="n">k</span><span class="p">)</span>
<a name="ln-267"></a>    <span class="n">enddo</span>
<a name="ln-268"></a>    <span class="n">enddo</span>
<a name="ln-269"></a>    <span class="n">enddo</span>
<a name="ln-270"></a>  <span class="n">endif</span>
<a name="ln-271"></a>  <span class="k">call </span><span class="n">MPI_SENDRECV</span><span class="p">(</span>  <span class="n">buffj3</span><span class="p">,</span>  <span class="n">ii</span>    <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrbottom</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-272"></a>                          <span class="n">buffj4</span><span class="p">,</span>  <span class="n">iiget</span> <span class="p">,</span> <span class="n">MY_REAL</span><span class="p">,</span> <span class="n">nbrtop</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-273"></a>                          <span class="n">comm3d</span><span class="p">,</span> <span class="n">status</span><span class="p">,</span> <span class="n">mpierr</span> <span class="p">)</span>
<a name="ln-274"></a>  <span class="k">if</span><span class="p">(</span><span class="n">nbrtop</span><span class="o">/=</span><span class="n">MPI_PROC_NULL</span><span class="p">)</span><span class="k">then</span>
<a name="ln-275"></a><span class="k">    </span><span class="n">ii</span> <span class="o">=</span> <span class="mi">0</span>
<a name="ln-276"></a>    <span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">jh</span>
<a name="ln-277"></a>    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">sz</span><span class="p">,</span><span class="n">ez</span>
<a name="ln-278"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">sx</span><span class="o">-</span><span class="n">ih</span><span class="p">,</span><span class="n">ex</span><span class="o">+</span><span class="n">ih</span>
<a name="ln-279"></a>      <span class="n">ii</span> <span class="o">=</span> <span class="n">ii</span> <span class="o">+</span> <span class="mi">1</span>
<a name="ln-280"></a>      <span class="n">a</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">ey</span><span class="o">+</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="n">buffj4</span><span class="p">(</span><span class="n">ii</span><span class="p">)</span>
<a name="ln-281"></a>    <span class="n">enddo</span>
<a name="ln-282"></a>    <span class="n">enddo</span>
<a name="ln-283"></a>    <span class="n">enddo</span>
<a name="ln-284"></a>  <span class="n">endif</span>
<a name="ln-285"></a>
<a name="ln-286"></a><span class="c">!   call barrou()</span>
<a name="ln-287"></a>  <span class="k">deallocate</span> <span class="p">(</span><span class="n">buffj1</span><span class="p">,</span><span class="n">buffj2</span><span class="p">,</span><span class="n">buffj3</span><span class="p">,</span><span class="n">buffj4</span><span class="p">)</span>
<a name="ln-288"></a>
<a name="ln-289"></a>  <span class="k">return</span>
<a name="ln-290"></a><span class="k">  end subroutine </span><span class="n">excjs</span>
<a name="ln-291"></a>
<a name="ln-292"></a>  <span class="k">subroutine </span><span class="n">slabsum</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">ks</span><span class="p">,</span><span class="n">kf</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="p">)</span>
<a name="ln-293"></a>    <span class="k">implicit none</span>
<a name="ln-294"></a>
<a name="ln-295"></a><span class="k">    </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ks</span><span class="p">,</span><span class="n">kf</span>
<a name="ln-296"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span>
<a name="ln-297"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">aver</span><span class="p">(</span><span class="n">ks</span><span class="p">:</span><span class="n">kf</span><span class="p">)</span>
<a name="ln-298"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">var</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-299"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">averl</span><span class="p">(</span><span class="n">ks</span><span class="p">:</span><span class="n">kf</span><span class="p">)</span>
<a name="ln-300"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">avers</span><span class="p">(</span><span class="n">ks</span><span class="p">:</span><span class="n">kf</span><span class="p">)</span>
<a name="ln-301"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">k</span>
<a name="ln-302"></a>
<a name="ln-303"></a>    <span class="n">averl</span>       <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-304"></a>    <span class="n">avers</span>       <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-305"></a>
<a name="ln-306"></a>    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span>
<a name="ln-307"></a>      <span class="n">averl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ibs</span><span class="p">:</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">:</span><span class="n">jes</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-308"></a>    <span class="n">enddo</span>
<a name="ln-309"></a>
<a name="ln-310"></a>    <span class="k">call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">averl</span><span class="p">,</span> <span class="n">avers</span><span class="p">,</span> <span class="n">kf</span><span class="o">-</span><span class="n">ks</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  <span class="n">MY_REAL</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-311"></a>                          <span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-312"></a>
<a name="ln-313"></a>    <span class="n">aver</span> <span class="o">=</span> <span class="n">aver</span> <span class="o">+</span> <span class="n">avers</span>
<a name="ln-314"></a>
<a name="ln-315"></a>    <span class="k">return</span>
<a name="ln-316"></a><span class="k">  end subroutine </span><span class="n">slabsum</span>
<a name="ln-317"></a>
<a name="ln-318"></a>  <span class="k">subroutine </span><span class="n">avexy_ibm</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span><span class="p">,</span><span class="n">II</span><span class="p">,</span><span class="n">IIs</span><span class="p">,</span><span class="n">lnan</span><span class="p">)</span>
<a name="ln-319"></a>    <span class="k">implicit none</span>
<a name="ln-320"></a>
<a name="ln-321"></a><span class="k">    </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ih</span><span class="p">,</span><span class="n">jh</span><span class="p">,</span><span class="n">kh</span>
<a name="ln-322"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">aver</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-323"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-324"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-325"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">IIs</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-326"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">IId</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-327"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">averl</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-328"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">avers</span><span class="p">(</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="p">)</span>
<a name="ln-329"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">k</span>
<a name="ln-330"></a>    <span class="kt">logical</span> <span class="kd">::</span> <span class="n">lnan</span>
<a name="ln-331"></a>
<a name="ln-332"></a>    <span class="n">averl</span>       <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-333"></a>    <span class="n">avers</span>       <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-334"></a>
<a name="ln-335"></a>    <span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="o">+</span><span class="n">kh</span>
<a name="ln-336"></a>      <span class="n">averl</span><span class="p">(</span><span class="n">k</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">*</span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">k</span><span class="p">))</span>
<a name="ln-337"></a>    <span class="n">enddo</span>
<a name="ln-338"></a>
<a name="ln-339"></a>    <span class="n">IId</span> <span class="o">=</span> <span class="n">IIs</span>
<a name="ln-340"></a>
<a name="ln-341"></a>    <span class="c">! tg3315 22.03.19 - if not calculating stats and all blocks on lowest layer...</span>
<a name="ln-342"></a>    <span class="c">! should not be necessary but value at kb is used in modthermo so reasonable value must</span>
<a name="ln-343"></a>    <span class="c">! be assigned. Potentially should leave as before and only account for in modthermo...</span>
<a name="ln-344"></a>    <span class="k">if</span> <span class="p">((.</span><span class="nb">not</span><span class="p">.</span> <span class="n">lnan</span><span class="p">)</span> <span class="p">.</span><span class="nb">and</span><span class="p">.</span> <span class="p">(</span><span class="n">IId</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span><span class="o">==</span><span class="mi">0</span><span class="p">))</span> <span class="k">then</span>
<a name="ln-345"></a><span class="k">      </span><span class="n">averl</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">))</span>
<a name="ln-346"></a>      <span class="n">IId</span><span class="p">(</span><span class="n">kb</span><span class="p">)</span> <span class="o">=</span> <span class="n">IId</span><span class="p">(</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-347"></a>    <span class="k">end if</span>
<a name="ln-348"></a>
<a name="ln-349"></a><span class="k">    call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">averl</span><span class="p">,</span> <span class="n">avers</span><span class="p">,</span> <span class="n">ke</span><span class="o">+</span><span class="n">kh</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  <span class="n">MY_REAL</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-350"></a>                          <span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-351"></a>
<a name="ln-352"></a>    <span class="k">where</span> <span class="p">(</span><span class="n">IId</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-353"></a>      <span class="n">aver</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.</span>
<a name="ln-354"></a>    <span class="n">elsewhere</span>
<a name="ln-355"></a>      <span class="n">aver</span> <span class="o">=</span> <span class="n">avers</span><span class="o">/</span><span class="n">IId</span>
<a name="ln-356"></a>    <span class="n">endwhere</span>
<a name="ln-357"></a>
<a name="ln-358"></a>    <span class="k">return</span>
<a name="ln-359"></a><span class="k">  end subroutine </span><span class="n">avexy_ibm</span>
<a name="ln-360"></a>
<a name="ln-361"></a>  <span class="k">subroutine </span><span class="n">slabsumi</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">iis</span><span class="p">,</span><span class="n">iif</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span><span class="p">)</span>
<a name="ln-362"></a>    <span class="k">implicit none</span>
<a name="ln-363"></a>
<a name="ln-364"></a><span class="k">    </span><span class="kt">integer</span> <span class="kd">::</span> <span class="n">iis</span><span class="p">,</span><span class="n">iif</span>
<a name="ln-365"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span><span class="p">,</span><span class="n">jbs</span><span class="p">,</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">,</span><span class="n">kes</span>
<a name="ln-366"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">aver</span><span class="p">(</span><span class="n">iis</span><span class="p">:</span><span class="n">iif</span><span class="p">)</span>
<a name="ln-367"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">var</span> <span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-368"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">averl</span><span class="p">(</span><span class="n">iis</span><span class="p">:</span><span class="n">iif</span><span class="p">)</span>
<a name="ln-369"></a>    <span class="kt">real</span>    <span class="kd">::</span> <span class="n">avers</span><span class="p">(</span><span class="n">iis</span><span class="p">:</span><span class="n">iif</span><span class="p">)</span>
<a name="ln-370"></a>    <span class="kt">integer</span> <span class="kd">::</span> <span class="n">i</span>
<a name="ln-371"></a>
<a name="ln-372"></a>    <span class="n">averl</span>       <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-373"></a>    <span class="n">avers</span>       <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-374"></a>
<a name="ln-375"></a>    <span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="n">ibs</span><span class="p">,</span><span class="n">ies</span>
<a name="ln-376"></a>      <span class="n">averl</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">jbs</span><span class="p">:</span><span class="n">jes</span><span class="p">,</span><span class="n">kbs</span><span class="p">:</span><span class="n">kes</span><span class="p">))</span>
<a name="ln-377"></a>    <span class="n">enddo</span>
<a name="ln-378"></a>
<a name="ln-379"></a>    <span class="k">call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">averl</span><span class="p">,</span> <span class="n">avers</span><span class="p">,</span> <span class="n">iif</span><span class="o">-</span><span class="n">iis</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span>  <span class="n">MY_REAL</span><span class="p">,</span> <span class="p">&amp;</span>
<a name="ln-380"></a>                          <span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-381"></a>
<a name="ln-382"></a>    <span class="n">aver</span> <span class="o">=</span> <span class="n">aver</span> <span class="o">+</span> <span class="n">avers</span>
<a name="ln-383"></a>
<a name="ln-384"></a>    <span class="k">return</span>
<a name="ln-385"></a><span class="k">  end subroutine </span><span class="n">slabsumi</span>
<a name="ln-386"></a>
<a name="ln-387"></a>  <span class="c">!Could make this so it has cases like if the input is 1,2 or 3D...</span>
<a name="ln-388"></a>  <span class="k">subroutine </span><span class="n">avey_ibm</span><span class="p">(</span><span class="n">aver</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">II</span><span class="p">,</span><span class="n">IIt</span><span class="p">)</span>
<a name="ln-389"></a>  <span class="k">implicit none</span>
<a name="ln-390"></a><span class="k">  </span><span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>
<a name="ln-391"></a>  <span class="kt">real</span>                    <span class="kd">::</span> <span class="n">aver</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-392"></a>  <span class="kt">real</span>                    <span class="kd">::</span> <span class="n">avero</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-393"></a>  <span class="kt">real</span>                    <span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-394"></a>  <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-395"></a>  <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">IIt</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-396"></a>  <span class="kt">logical</span>                 <span class="kd">::</span> <span class="n">lytdump</span><span class="p">,</span><span class="n">lnan</span>
<a name="ln-397"></a>
<a name="ln-398"></a>  <span class="n">avero</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-399"></a>  <span class="n">aver</span>  <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-400"></a>
<a name="ln-401"></a>  <span class="n">avero</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="o">*</span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span> <span class="nb">DIM</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-402"></a>
<a name="ln-403"></a>  <span class="k">call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">avero</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span> <span class="n">aver</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span> <span class="p">(</span><span class="n">ke</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ie</span><span class="o">-</span><span class="n">ib</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span><span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-404"></a>
<a name="ln-405"></a>  <span class="k">where</span> <span class="p">(</span><span class="n">IIt</span><span class="o">==</span><span class="mi">0</span><span class="p">)</span>
<a name="ln-406"></a>    <span class="n">aver</span> <span class="o">=</span> <span class="o">-</span><span class="mi">99</span><span class="mf">9.</span>
<a name="ln-407"></a>  <span class="n">elsewhere</span>
<a name="ln-408"></a>    <span class="n">aver</span> <span class="o">=</span> <span class="n">aver</span><span class="o">/</span><span class="n">IIt</span>
<a name="ln-409"></a>  <span class="n">endwhere</span>
<a name="ln-410"></a> 
<a name="ln-411"></a>  <span class="k">end subroutine </span><span class="n">avey_ibm</span>
<a name="ln-412"></a>
<a name="ln-413"></a>  <span class="k">subroutine </span><span class="n">sumy_ibm</span><span class="p">(</span><span class="n">sumy</span><span class="p">,</span><span class="n">var</span><span class="p">,</span><span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span><span class="p">,</span><span class="n">II</span><span class="p">)</span>
<a name="ln-414"></a>    <span class="c">! This routine sums up a variable over the y direction,</span>
<a name="ln-415"></a>    <span class="c">! only including the fluid cells.</span>
<a name="ln-416"></a>    <span class="k">implicit none</span>
<a name="ln-417"></a><span class="k">    </span><span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">ib</span><span class="p">,</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">,</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">,</span><span class="n">ke</span>
<a name="ln-418"></a>    <span class="kt">real</span>                    <span class="kd">::</span> <span class="n">sumy</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-419"></a>    <span class="kt">real</span>                    <span class="kd">::</span> <span class="n">sumproc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-420"></a>    <span class="kt">real</span>                    <span class="kd">::</span> <span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-421"></a>    <span class="kt">integer</span>                 <span class="kd">::</span> <span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span>
<a name="ln-422"></a>
<a name="ln-423"></a>    <span class="n">sumproc</span> <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-424"></a>    <span class="n">sumy</span>  <span class="o">=</span> <span class="mf">0.</span>
<a name="ln-425"></a>
<a name="ln-426"></a>    <span class="n">sumproc</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="n">var</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">)</span><span class="o">*</span><span class="n">II</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">jb</span><span class="p">:</span><span class="n">je</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span> <span class="nb">DIM</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<a name="ln-427"></a>
<a name="ln-428"></a>    <span class="k">call </span><span class="n">MPI_ALLREDUCE</span><span class="p">(</span><span class="n">sumproc</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span> <span class="n">sumy</span><span class="p">(</span><span class="n">ib</span><span class="p">:</span><span class="n">ie</span><span class="p">,</span><span class="n">kb</span><span class="p">:</span><span class="n">ke</span><span class="p">),</span> <span class="p">(</span><span class="n">ke</span><span class="o">-</span><span class="n">kb</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">ie</span><span class="o">-</span><span class="n">ib</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="n">MY_REAL</span><span class="p">,</span><span class="n">MPI_SUM</span><span class="p">,</span> <span class="n">comm3d</span><span class="p">,</span><span class="n">mpierr</span><span class="p">)</span>
<a name="ln-429"></a>
<a name="ln-430"></a>    <span class="k">end subroutine </span><span class="n">sumy_ibm</span>
<a name="ln-431"></a>
<a name="ln-432"></a><span class="k">end module</span>
</pre></div>

    </section>
    </div>
  </div>

  
    <hr>    
    </div> <!-- /container -->
    <footer>
      <div class="container">
      <div class="row">
        <div class="col-xs-6 col-md-4"><p>&copy; 2021 
                                          </p></div>
        <div class="col-xs-6 col-md-4 col-md-push-4">
          <p class="text-right">
            Documentation generated by 
            <a href="https://github.com/cmacmackin/ford">FORD</a>
            
          </p>
        </div>
        <div class="col-xs-12 col-md-4 col-md-pull-4"><p class="text-center"> uDALES was developed by The uDALES Team</p></div>
      </div>
      <br>
      </div> <!-- /container -->    
    </footer>

    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
<!--
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
-->
    <script src="../js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="../js/ie10-viewport-bug-workaround.js"></script>

    <!-- MathJax JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } },
        jax: ['input/TeX','input/MathML','output/HTML-CSS'],
        extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']
      });
    </script>
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    
    <script src="../tipuesearch/tipuesearch_content.js"></script>
    <script src="../tipuesearch/tipuesearch_set.js"></script>
    <script src="../tipuesearch/tipuesearch.js"></script>
    
    
  </body>
</html>